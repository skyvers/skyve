<?xml version="1.0" encoding="UTF-8"?>
<document xmlns="http://www.skyve.org/xml/document"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	name="SecurityLog"
	xsi:schemaLocation="http://www.skyve.org/xml/document ../../../schemas/document.xsd">
	<persistent name="ADM_SecurityLog" />
	<singularAlias>Security Log</singularAlias>
	<pluralAlias>Security Logs</pluralAlias>
	<iconStyleClass>fa-solid fa-book</iconStyleClass>
	<description>
		<![CDATA[
			The Security Log consists of a list of records of {@link SecurityException}, {@link AccessExceptions}, so that intrusions can be detected in near real time.
			<br/>
			If email is configured, emails are sent to the support email address specified in the project JSON for each event raised.
		]]>
	</description>
	<bizKey expression="Security Log - {timestamp}" />
	<implements>
		<interface>org.skyve.domain.app.admin.SecurityLog</interface>
	</implements>
	<attributes>
		<timestamp name="timestamp" required="true">
			<displayName>Timestamp</displayName>
			<description>When the exception was raised</description>
			<defaultValue>{TIMESTAMP}</defaultValue>
		</timestamp>
		<longInteger name="threadID" required="true">
			<displayName>Thread ID</displayName>
			<description>Thread ID when the exception was raised</description>
		</longInteger>
		<text name="sourceIP">
			<displayName>Source IP</displayName>
			<description>Source IP when exception was raised</description>
			<length>45</length>
		</text>
		<id name="username">
			<displayName>Username</displayName>
			<description>The username the security exception was raised for</description>
		</id>
		<id name="loggedInUserId" required="true">
			<displayName>Logged In User ID</displayName>
			<description>Logged in user ID when exception was raised</description>
		</id>
		<enum name="exceptionType" implementingEnumClassName="org.skyve.domain.app.admin.SecurityLog$ExceptionType" required="true">
			<displayName>Exception Type</displayName>
			<description>Type of exception raised</description>
		</enum>
		<memo name="exceptionMessage" required="true">
			<displayName>Exception Message</displayName>
			<description>Exception message from exception raised</description>
		</memo>
		<memo name="provenance">
			<displayName>Provenance</displayName>
			<description>First line of the stack trace of exception raised</description>
		</memo>
	</attributes>
</document>