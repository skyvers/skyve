/*

  SmartClient Ajax RIA system
  Version v12.0p_2019-08-11/LGPL Development Only (2019-08-11)

  Copyright 2000 and beyond Isomorphic Software, Inc. All rights reserved.
  "SmartClient" is a trademark of Isomorphic Software, Inc.

  LICENSE NOTICE
     INSTALLATION OR USE OF THIS SOFTWARE INDICATES YOUR ACCEPTANCE OF
     ISOMORPHIC SOFTWARE LICENSE TERMS. If you have received this file
     without an accompanying Isomorphic Software license file, please
     contact licensing@isomorphic.com for details. Unauthorized copying and
     use of this software is a violation of international copyright law.

  DEVELOPMENT ONLY - DO NOT DEPLOY
     This software is provided for evaluation, training, and development
     purposes only. It may include supplementary components that are not
     licensed for deployment. The separate DEPLOY package for this release
     contains SmartClient components that are licensed for deployment.

  PROPRIETARY & PROTECTED MATERIAL
     This software contains proprietary materials that are protected by
     contract and intellectual property law. You are expressly prohibited
     from attempting to reverse engineer this software or modify this
     software for human readability.

  CONTACT ISOMORPHIC
     For more information regarding license rights and restrictions, or to
     report possible license violations, please contact Isomorphic Software
     by email (licensing@isomorphic.com) or web (www.isomorphic.com).

*/

if(window.isc&&window.isc.module_Core&&!window.isc.module_Tools){isc.module_Tools=1;isc._moduleStart=isc._Tools_start=(isc.timestamp?isc.timestamp():new Date().getTime());if(isc._moduleEnd&&(!isc.Log||(isc.Log&&isc.Log.logIsDebugEnabled('loadTime')))){isc._pTM={message:'Tools load/parse time: '+(isc._moduleStart-isc._moduleEnd)+'ms',category:'loadTime'};if(isc.Log&&isc.Log.logDebug)isc.Log.logDebug(isc._pTM.message,'loadTime');else if(isc._preLog)isc._preLog[isc._preLog.length]=isc._pTM;else isc._preLog=[isc._pTM]}isc.definingFramework=true;isc.defineClass("ComponentEditor","PropertySheet");isc.A=isc.ComponentEditor;isc.A.$176r={integer:"formula",float:"formula",sequence:"formula",date:"formula",time:"formula",text:"textFormula"};isc.A.$176s={integer:"editorFormula",float:"editorFormula",sequence:"editorFormula",date:"editorFormula",time:"editorFormula",text:"editorTextFormula"};isc.A.$192f=["string","String","HTMLString","number","Number","int","integer","Integer","positiveInteger"];isc.A=isc.ComponentEditor.getPrototype();isc.A.immediateSave=false;isc.A.itemHoverWidth=500;isc.A.showSuperClassEvents=true;isc.A.initialGroups=3;isc.A.showAttributes=true;isc.A.showMethods=false;isc.A.basicMode=false;isc.A.lessTitle="Less...";isc.A.moreTitle="More...";isc.A.readOnlyRequiresDSHover="Add a DataSource to enable";isc.A.readOnlyIfDataBoundHover="Data type for this field is determined by the component's DataSource and cannot be changed for only this component/field. Change the data type in the DataSource Editor instead";isc.A.canSwitchClass=false;isc.A.componentTypeTitle="Component Type";isc.A=isc.ComponentEditor.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.handlerFieldBase={validateOnChange:true,validators:[{type:"isFunction"}],itemHoverHTML:function(){var _1=this.$1416(this.getValue());if(_1==null)return _1;_1=String(_1);if(_1=="&nbsp;"||_1.match(/^\W+$/))_1="";return _1.asHTML()}};isc.A.itemHoverStyle="docHover";isc.B.push(isc.A.shouldUseField=function isc_ComponentEditor_shouldUseField(_1){if(!this.Super("shouldUseField",arguments)){return false}
if(_1.hidden||_1.inapplicable||_1.advanced)return false;var _2=this.$694==null?this.basicMode:this.$694;if(_2&&!_1.basic)return false;if(_1.type&&isc.DS.isLoaded(_1.type)&&_1.type!="ValueMap"&&_1.type!="Action"&&_1.type!="AdvancedCriteria"&&_1.type!="UserFormula"&&_1.type!="UserSummary")
{return false}
var _3=isc.DS.get(this.dataSource);if(!_3)return true;var _4=_3.ID,_5=_1[this.fieldIdProperty];if(isc.jsdoc.hasData()){var _6=isc.jsdoc.getDocItem(_4,_5,true);if(_1.visibility!=null&&_6==null)return false;if(_6&&isc.jsdoc.getAttribute(_6,"deprecated"))return false;if(_6&&isc.jsdoc.isAdvancedAttribute(_6))return false}
return true},isc.A.$143m=function isc_ComponentEditor__setItems(_1,_2){var _3=this.$193f;if(_3){isc.Timer.clear(_3);delete this.$193f}
if(!_2)this.$193e(_1);if(this.$193g==false||!this.dataSource||_1&&_1.length>0||isc.jsdoc.hasData())
{this.clearJsDocLoadingPrompt();this.delayCall("expandInitialGroups");this.invokeSuper(isc.ComponentEditor,"$143m",_1)}else{this.showJsDocLoadingPrompt();this.$193f=this.delayCall("$143m",[_1,true],200)}},isc.A.showJsDocLoadingPrompt=function isc_ComponentEditor_showJsDocLoadingPrompt(){if(this.$193h)return;var _1=this.imgHTML(isc.Canvas.loadingImageSrc,isc.Canvas.loadingImageSize,isc.Canvas.loadingImageSize);this.$193h=isc.Label.create({align:"center",autoDraw:false,width:"100%",height:"100%",contents:_1+"&nbsp;Loading JSDoc..."});this.addChild(this.$193h)},isc.A.clearJsDocLoadingPrompt=function isc_ComponentEditor_clearJsDocLoadingPrompt(){if(this.$193h){this.removeChild(this.$193h);delete this.$193h}},isc.A.bindToDataSource=function isc_ComponentEditor_bindToDataSource(_1,_2){var _3=this.$46d=this.Super("bindToDataSource",arguments);var _4=this.dataSource?isc.DS.get(this.dataSource):null;if(_1&&_1.length>0)return _3;if(_4==null||this.$46d==null)return _3;for(var i=0;i<_3.length;i++){var _6=_3[i],_7=_6.defaultValue;if(_7==null)continue;if(_7=="false")_7=false;else if(_7=="true")_7=true;else if(parseInt(_7).toString()==_7){_7=parseInt(_7)}
_6.defaultValue=_7}
if(!isc.jsdoc.hasData())return _3;var _8={},_9=false;if(this.showAttributes){for(var i=0;i<_3.length;i++){var _6=_3[i],_10=_6[this.fieldIdProperty];var _11=_6.group||isc.jsdoc.getGroupForAttribute(_4.ID,_10)||"other";if(_11==null)_11="other";if(_11!="other")_9=true;if(!_8[_11])_8[_11]=[];_8[_11].add(_6)}}
if(this.showMethods){if(!this.createMethodGroups(_8,_4)&&!this.showAttributes){return[]}else{_9=true}}
if(!_9){if(this.sortFields)_3.sortByProperty("name",Array.ASCENDING);return _3}
var _12=isc.getKeys(_8),_13=_4.getGroups(),_14=[];if(_13!=null){for(var i=0;i<_13.length;i++){var _15=_12.indexOf(_13[i]);if(_15==-1)continue;_12.removeAt(_15);_14.add(_13[i])}
_14.addList(_12)}else{_14=_12}
var _15=_14.indexOf("other");if(_15!=-1){_14.removeAt(_15);_14.add("other")}
_1=[];if(this.canSwitchClass){var _16=this.getClassSwitcher();if(_16)_1[0]=_16}
if(this.creator.shouldShowDataPathFields&&this.creator.shouldShowDataPathFields()){_1[_1.length]=this.getDataPathField(true)}
for(var i=0;i<_14.length;i++){var _11=_14[i],_17=_8[_11],_18=isc.jsdoc.getGroupItem(_11),_19=_18&&_18.title?_18.title:isc.DataSource.getAutoTitle(_11);if(this.sortFields)_17.sortByProperty("name",Array.ASCENDING);_1[_1.length]={editorType:"TSectionItem",defaultValue:_19,sectionExpanded:false,items:_17,canvasProperties:{hoverWidth:this.itemHoverWidth,hoverStyle:this.itemHoverStyle,canHover:true,groupName:_11,getHoverHTML:function(){if(this.groupName){var _20=isc.jsdoc.hoverHTML(this.groupName);if(_20)return _20}
return"<nobr><code><b>"+this.groupName+"</b></code> (no doc available)</nobr>"}}}}
return _1},isc.A.addField=function isc_ComponentEditor_addField(_1,_2){if(this.fields)this.fields.addAt(_1,_2)},isc.A.getDataPathField=function isc_ComponentEditor_getDataPathField(_1){var _2=this.creator,_3=_2.operationsPalette,_4=_3?_3.data:null,_5=_2.trimOperationsTreeData(_4,_1);return{name:_1?"inputDataPath":"dataPath",title:_1?"Input DataPath":"DataPath",isInput:_1,type:"DataPathItem",operationsPalette:_3,operationsTreeData:_5}},isc.A.getClassSwitcher=function isc_ComponentEditor_getClassSwitcher(){var _1=isc.DS.get(this.dataSource),_2=isc.ClassFactory.getClass(_1.ID);if(!_2)return null;return{name:"classSwitcher",title:this.componentTypeTitle,defaultValue:_2.getClassName(),type:"select",valueMap:this.getClassSwitcherValueMap(_1,_2)}},isc.A.getClassSwitcherValueMap=function isc_ComponentEditor_getClassSwitcherValueMap(_1,_2){var _3,_4=[];if(_2)_3=this.getInheritanceChain(_2,_1);if(!_3)return null;for(var i=0;i<_3.length;i++){var _6=isc.DS.getNearestSchema(_3[i].getClassName()),_7=_6.substituteClasses;if(_6.createStandalone!=false){if(!_4.contains(_3[i].getClassName())){_4.add(_3[i].getClassName())}}
if(!_7)continue;var _8=_7.split(",");for(var i=0;i<_8.length;i++){_8[i]=_8[i].trim();if(!_4.contains(_8[i]))_4.add(_8[i])}}
_4.sort();return _4},isc.A.createMethodGroups=function isc_ComponentEditor_createMethodGroups(_1,_2){var _3=isc.ClassFactory.getClass(_2.ID);this.$46e=[];var _4=this.$694==null?this.basicMode:this.$694;if(!_4&&_3&&_3._stringMethodRegistry&&!isc.isAn.emptyObject(_3._stringMethodRegistry))
{var _5=this.getInheritanceChain(_3,_2),_6,_7=[],_8,_9={};for(var i=0;i<_5.length;i++){var _11=_5[i];var _12=_11._stringMethodRegistry.$cq;_6=(_12?_12.duplicate():[]);_8=_6.duplicate();_8.removeList(_7);_7=_6;if(_8.length==0)continue;var _13=(_11==isc.Canvas?"Basic":_11.getClassName())+" Methods";_9[_13]=[];for(var j=0;j<_8.length;j++){var _15=_8[j];var _16="method:"+_11.getClassName()+"."+_15,_17=isc.jsdoc.getDocItem(_16);if(!_17){if(!_2.methods||!_2.methods.find("name",_15)){_7.remove(_15);continue}}
if(_17&&isc.jsdoc.getAttribute(_17,"deprecated"))continue;var _18=this.getMethodField(_8[j]);_9[_13].add(_18)}
if(_9[_13].length==0){delete _9[_13];delete _1[_13]}}
var _19=isc.getKeys(_9).reverse();for(var i=0;i<_19.length;i++){_1[_19[i]]=_9[_19[i]]}
return true}
if(_2.methods&&_2.methods.length>0){var _20=_1[_2.ID+_4?" Basic":" Methods"]=[];for(var i=0;i<_2.methods.length;i++){var _21=_2.methods[i];if(_4&&!_21.basic)continue;var _18=this.getMethodField(_21.name);_20.add(_18)}
return true}
return false},isc.A.getInheritanceChain=function isc_ComponentEditor_getInheritanceChain(_1,_2){var _3=[],_4=this.$du(_2.showSuperClassEvents,this.showSuperClassEvents);if(_4&&(_1.isA("Canvas")||_1.isA("FormItem"))){for(var _5=_1;_5!=isc.Class;_5=_5.getSuperClass())
{_3.add(_5)}}
_3.reverse();return _3},isc.A.getMethodField=function isc_ComponentEditor_getMethodField(_1){var _2=isc.clone(this.handlerFieldBase);_2[this.fieldIdProperty]=_1;_2.type=this.canEditExpressions?"expression":"action";this.$46e.add(_2);return _2},isc.A.clearComponent=function isc_ComponentEditor_clearComponent(){var _1=this.currentComponent;if(_1==null)return;delete this.currentComponent;delete this.dataSource;this.setFields([])},isc.A.editComponent=function isc_ComponentEditor_editComponent(_1,_2){var _3=isc.DS.getNearestSchema(_1.type),_2=_2||_1.liveObject;if(_2.useCustomSchema)_3=_2.useCustomSchema;this.currentComponent=_1;if(this.logIsInfoEnabled("editing")){this.logInfo("Editing component of type: "+_3+", defaults: "+this.echo(_1.defaults)+", liveObject: "+this.echoLeaf(_2),"editing")}
if(_1.advancedMode)this.$694=false;this.setDataSource(_3);var _4={},_5=this.$46d;if(this.$46e){_5=_5.concat(this.$46e)}
var _6=(!_2||!_2.getEditableProperties)?_1.defaults:_2.getEditableProperties(_5);var _7;if(_2.editingOn&&_2.$180e!=_7){_6.disabled=_2.$180e}
var _8=["formula","textFormula","editorFormula","editorTextFormula"];if(isc.isA.FormItem(_2)||isc.SimpleType.inheritsFrom(_3,"ListGridField")){var _9=isc.SimpleType.inheritsFrom(_3,"ListGridField"),_10=_2.type||_2.defaultType||"text";if(_10=="text"&&isc.isA.TimeItem(_2))_10="date";var _11=(_9?isc.ComponentEditor.$176s[_10]:isc.ComponentEditor.$176r[_10]);if(_11){_8.remove(_11)}}
var _12=null;for(var i=0;i<_5.length;i++){var _14=_5[i];if(_14.advanced){_14.showIf=this.$46f}
if(!_14.name)continue;if(_8.contains(_14.name)){_14.showIf=this.$46f}
if(this.builder&&_14.type=="AdvancedCriteria"){_14.targetRuleScope=this.builder.getTargetRuleScope();_14.createRuleCriteria=_14.isRuleCriteria;if(_14.isRuleCriteria){var _15=_14.title.replace(" When","");_14.windowProperties={title:"Define when '"+_1.name+"' is "+_15}}}else if(this.builder&&_14.useRuleScope){_14.targetRuleScope=this.builder.getTargetRuleScope()}
if((_14.type=="UserFormula"||_14.type=="UserSummary")&&this.currentComponent.parentId){_14.component=window[this.currentComponent.parentId]}
if(isc.ComponentEditor.$192f.contains(_14.type)){_14.targetRuleScope=this.builder.getTargetRuleScope();if(this.currentComponent.parentId){_14.component=window[this.currentComponent.parentId]}}
if(_14.requiresDSField){_14.readOnlyWhen={_constructor:"AdvancedCriteria",operator:"and",criteria:[{fieldName:this.getLocalId()+".values."+_14.requiresDSField,operator:"isNull"}]};_14.readOnlyHover=this.readOnlyRequiresDSHover}else if(_14.readOnlyIfDataBound=="true"){if(_2.form){_14.readOnlyWhen={_constructor:"AdvancedCriteria",operator:"and",criteria:[{fieldName:this.getLocalId()+".values.$179p",operator:"notNull"}]};_14.readOnlyHover=this.readOnlyIfDataBoundHover;_12=_2.form.dataSource}}
var _16=_14.name,_17=_6[_16];var _7;if(_17===_7)continue;if(isc.isA.Function(_17)){if(!_2.getClass)continue;var _18=_2.getClass().getInstanceProperty(_16);if(_18==_17)continue}
_4[_16]=_17}
this.delayCall("expandInitialGroups");if(_2.dataSource)_4.dataSource=_2.dataSource.ID;if(_2.optionDataSource)_4.optionDataSource=_2.optionDataSource.ID;if(this.logIsDebugEnabled("editing")){this.logDebug("Live values: "+this.echo(_4),"editing")}
this.setValues(_4);for(var _16 in _4){if(isc.isA.Function(_4[_16])){this.setValue(_16,_4[_16])}}
if(_12){if(isc.isA.DataSource(_12))_12=_12.ID;this.setValue("$179p",_12)}
if(_1.defaults.dataPath&&this.getItem("dataPath")){this.getItem("dataPath").setDataPathProperties(_1)}
if(_1.defaults.inputDataPath&&this.getItem("inputDataPath")){this.getItem("inputDataPath").setDataPathProperties(_1)}},isc.A.$46f=function isc_ComponentEditor__falseFunc(){return false},isc.A.expandInitialGroups=function isc_ComponentEditor_expandInitialGroups(){var _1=0;for(var i=0;i<this.items.length;i++){var _3=this.items[i];if(_3.sectionExpanded!=null&&_1++<this.initialGroups){_3.expandSection()}}},isc.A.wrapEditorColumns=function isc_ComponentEditor_wrapEditorColumns(){if(!this.items)return;var _1=0;for(var i=0;i<this.items.length;i++){var _3=this.items[i];if(_3.visible&&!_3.advanced)_1++}
if(_1>10)this.numCols=4;if(_1>20)this.numCols=6},isc.A.titleHoverHTML=function isc_ComponentEditor_titleHoverHTML(_1){if(isc.jsdoc.hasData()){var _2=isc.jsdoc.hoverHTML(isc.DataSource.get(this.dataSource).ID,_1.name);if(!_2){if(this.showMethods){var _3=isc.jsdoc.docItemForDSMethod(this.dataSource,_1.name);if(_3)_2=isc.MethodFormatter.hoverHTML(_3)}else{var _4=isc.jsdoc.docItemForDSField(this.dataSource,_1.name);if(_4)_2=isc.AttrFormatter.hoverHTML(_4)}}
if(_2)return _2}
return"<nobr><code><b>"+_1.name+"</b></code> (no doc available)</nobr>"},isc.A.getEditorType=function isc_ComponentEditor_getEditorType(_1){if(_1&&_1.type=="ValueMap")return"ValueMapItem";if(_1&&_1.type=="AdvancedCriteria")return"CriteriaItem";if(_1&&_1.type=="UserFormula"){var _2=isc.DS.getNearestSchema(this.currentComponent.type);if(!isc.SimpleType.inheritsFrom(_2,"TextItem")&&!isc.SimpleType.inheritsFrom(_2,"IntegerItem")&&!isc.SimpleType.inheritsFrom(_2,"FloatItem"))
{return"ExpressionEditorItem"}
return(isc.isA.DateItem(this.currentComponent.liveObject)?"ExpressionEditorItem":"FormulaEditorItem")}
if(_1&&_1.type=="UserSummary")return"SummaryEditorItem";if(this.allowDynamicProperties&&_1.type&&isc.ComponentEditor.$192f.contains(_1.type)&&_1.allowDynamicProperties!=false&&_1.allowDynamicProperties!="false")
{var _3=isc.DS.get(this.dataSource);if(_3){var _4=_3.ID,_5=_1[this.fieldIdProperty];if(isc.jsdoc.hasData()){var _6=isc.jsdoc.getDocItem(_4,_5,true);if(_6&&_6.flags&&_6.flags.contains("W")){if(isc.ComponentEditor.$192f.contains(_6.valueType)){return"DynamicPropertyEditorItem"}}}}}
var _7=this.Super("getEditorType",arguments);_7=isc.FormItemFactory.getItemClass(_7).getClassName();var _8="T"+_7;if(isc[_8]!=null&&isc.isA.FormItem(isc[_8]))return _8;return _7});isc.B._maxIndex=isc.C+19;isc.defineClass("Wizard","VLayout");isc.A=isc.Wizard.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.stepInstructionsDefaults={_constructor:"Label",contents:"Instructions",padding:10,height:20};isc.A.stepPaneDefaults={_constructor:"VLayout",padding:10};isc.A.showStepIndicator=false;isc.A.stepIndicatorDefaults={_constructor:"HLayout",height:22,layoutMargin:0,layoutLeftMargin:10,membersMargin:2};isc.A.stepIndicatorItems=[];isc.A.stepButtonDefaults={_constructor:"Img",layoutAlign:"center",showRollOver:false,height:18,width:18};isc.A.stepSeparatorDefaults={_constructor:"Img",layoutAlign:"center",height:16,width:16,src:"[SKIN]/TreeGrid/opener_closed.gif"};isc.A.navButtonsDefaults={_constructor:"ToolStrip",height:22,layoutMargin:5,membersMargin:10};isc.A.navButtonsItems=["previousButton","nextButton","finishButton","cancelButton"];isc.A.previousButtonDefaults={_constructor:"Button",layoutAlign:"center",title:"Previous",click:"this.creator.previousStep()",visibility:"hidden"};isc.A.nextButtonDefaults={_constructor:"Button",layoutAlign:"center",title:"Next",click:"this.creator.nextStep()"};isc.A.finishButtonDefaults={_constructor:"Button",layoutAlign:"center",title:"Finish",click:"this.creator.finished()",visibility:"hidden"};isc.A.cancelButtonDefaults={_constructor:"Button",layoutAlign:"center",title:"Cancel",click:"this.creator.cancel()"};isc.A.autoChildParentMap={nextButton:"navButtons",previousButton:"navButtons",finishButton:"navButtons"};isc.A.$46g="_stepButton_";isc.B.push(isc.A.initWidget=function isc_Wizard_initWidget(){this.Super(this.$oc,arguments);this.createSteps();this.addAutoChild("stepInstructions");this.addAutoChild("stepPane");this.addAutoChild("navButtons");this.addAutoChildren(this.navButtonsItems,this.navButtons);if(this.showStepIndicator){this.addAutoChild("stepIndicator");for(var i=0;i<this.steps.length;i++){var _2=this.steps[i].stepName,_3={src:_2};var _4=this.createAutoChild("stepButton",_3);this.stepIndicator.addMember(_4);this.steps[i].$46h=_4;if(i+1<this.steps.length){this.stepIndicator.addMember(this.createAutoChild("stepSeparator"))}}
this.navButtons.addMember(this.stepIndicator,0)}
this.goToStep(0,true)},isc.A.draw=function isc_Wizard_draw(_1){var _2=this.Super("draw",arguments);this.updateButtons();return _2},isc.A.createSteps=function isc_Wizard_createSteps(_1){if(!_1)_1=this.steps;if(!_1)return;if(!isc.isAn.Array(_1))_1=[_1];for(var i=0;i<_1.length;i++){_1[i]=isc.WizardStep.create(_1[i],{wizard:this})}},isc.A.getStep=function isc_Wizard_getStep(_1){return isc.Class.getArrayItem(_1,this.steps)},isc.A.getCurrentStep=function isc_Wizard_getCurrentStep(){return this.getStep(this.currentStepNum)},isc.A.getCurrentStepIndex=function isc_Wizard_getCurrentStepIndex(){return this.currentStepNum},isc.A.getStepIndex=function isc_Wizard_getStepIndex(_1){return isc.Class.getArrayItemIndex(_1,this.steps)},isc.A.getStepPane=function isc_Wizard_getStepPane(_1){return this.getStep(_1).pane},isc.A.goToStep=function isc_Wizard_goToStep(_1,_2){if(!_2){if(!this.getCurrentStep().exitStep(_1))return;this.getStepPane(this.currentStepNum).hide()}
var _3=this.getStep(_1);_3.enterStep(this.currentStepNum);this.currentStepNum=this.getStepIndex(_3);var _4=this.getStepPane(_1);if(_3.instructions)this.stepInstructions.setContents(_3.instructions);else this.stepInstructions.hide();this.stepPane.addMember(_4,0);_4.show();this.updateButtons()},isc.A.go=function isc_Wizard_go(_1){var _2=this.getStepIndex(this.currentStepNum);_2+=_1;this.goToStep(this.getStep(_2))},isc.A.nextStep=function isc_Wizard_nextStep(){var _1=this.getStep(this.currentStepNum);if(_1.hasNextStep())this.goToStep(_1.getNextStep());else this.go(1)},isc.A.previousStep=function isc_Wizard_previousStep(){var _1=this.getStep(this.currentStepNum);if(_1.hasPreviousStep())this.goToStep(_1.getPreviousStep());else this.go(-1)},isc.A.finished=function isc_Wizard_finished(){this.resetWizard()},isc.A.cancel=function isc_Wizard_cancel(){this.resetWizard()},isc.A.updateButtons=function isc_Wizard_updateButtons(){var _1=this.getStepIndex(this.currentStepNum),_2=this.getCurrentStep();if(this.stepIndicator){for(var i=0;i<this.steps.length;i++){var _4=this.steps[i].$46h;if(_1>i){_4.setState("")}else if(_1==i){_4.setState("Down")}else{_4.setState("Disabled")}}}
if(_1==0||this.forwardOnly||!_2.hasPreviousStep())this.previousButton.hide();else this.previousButton.show();if(!_2.hasNextStep()||_1==this.steps.length-1){this.nextButton.hide();this.finishButton.show()}else{this.nextButton.show();this.finishButton.hide()}},isc.A.resetWizard=function isc_Wizard_resetWizard(){this.goToStep(0)});isc.B._maxIndex=isc.C+16;isc.defineClass("WizardStep").addMethods({enterStep:function(_1){},exitStep:function(_1){return true},hasNextStep:function(){for(var i=this.wizard.getStepIndex(this.ID)+1;i<this.wizard.steps.length;i++)
if(!this.wizard.getStep(i).hidden)return true;return false},getNextStep:function(){for(var i=this.wizard.getStepIndex(this.ID)+1;i<this.wizard.steps.length;i++)
if(!this.wizard.getStep(i).hidden)return i;return-1},hasPreviousStep:function(){for(var i=this.wizard.getStepIndex(this.ID)-1;i>=0;i--)
if(!this.wizard.getStep(i).hidden)return true;return false},getPreviousStep:function(){for(var i=this.wizard.getStepIndex(this.ID)-1;i>=0;i--)
if(!this.wizard.getStep(i).hidden)return i;return-1},show:function(){this.hidden=false;this.wizard.updateButtons()},hide:function(){this.hidden=true;this.wizard.updateButtons();if(this.wizard.getCurrentStep()==this){var _1=this.getPreviousStep();if(_1==-1)_1=this.getNextStep();this.wizard.goToStep(_1)}}});isc.DataSource.create({ID:"isc_XMethodsServices",dataURL:"shortServiceListing.xml",recordName:"service",recordXPath:"/default:inspection/default:service",fields:[{name:"abstract",title:"Description"},{name:"xMethodsPage",title:"Site",type:"link",width:50,valueXPath:".//wsilxmethods:serviceDetailPage/@location"},{name:"wsdlURL",title:"WSDL",type:"link",width:50,valueXPath:"default:description[@referencedNamespace='http://schemas.xmlsoap.org/wsdl/']/@location"}]});isc.defineClass("DSWizardBase","VLayout");isc.A=isc.DSWizardBase.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.autoChildParentMap={nextButton:"navToolbar",previousButton:"navToolbar",finishButton:"navToolbar"};isc.B.push(isc.A.initWidget=function isc_DSWizardBase_initWidget(){this.Super(this.$oc,arguments);if(this.dsDataSource)this.dsDataSource=isc.DataSource.get(this.dsDataSource);this.addAutoChild("stepInstructions",{contents:"Instructions",padding:4,height:20,wrap:false,overflow:"visible"},isc.Label);this.addAutoChild("navToolbar",{height:22,layoutMargin:10,membersMargin:10},isc.HLayout);this.addAutoChild("previousButton",{title:"< Previous",click:"this.creator.previousPage()",visibility:"hidden"},isc.Button);this.navToolbar.addMember(isc.LayoutSpacer.create());this.addAutoChild("nextButton",{title:"Next >",click:"this.creator.nextPage()",disabled:true,setDisabled:function(_2){var _1=this.Super('setDisabled',arguments);this.creator.$46i(_2)}},isc.Button);this.addAutoChild("finishButton",{title:"Finish",click:"this.creator.finish()",visibility:"hidden"},isc.Button);this.goToPage(0,true)},isc.A.getPage=function isc_DSWizardBase_getPage(_1){return isc.Class.getArrayItem(_1,this.pages)},isc.A.getCurrentPage=function isc_DSWizardBase_getCurrentPage(){return this.getPage(this.currentPageNum)},isc.A.getPageIndex=function isc_DSWizardBase_getPageIndex(_1){return isc.Class.getArrayItemIndex(_1,this.pages)},isc.A.getPageView=function isc_DSWizardBase_getPageView(_1,_2){var _3=this.getPage(_1),_4=_3.ID;if(!_4)return _3.view;if(_2){var _5="enter"+_4;if(this[_5])this[_5](_3,_4);else this.enterPage(_3,_4)}
this.logWarn("for page: "+this.echoLeaf(_1)+" got pageId: "+_4+(_2&&this[_5]?" called enter function: "+_5:"")+", view is: "+_3.view);return _3.view},isc.A.enterPage=function isc_DSWizardBase_enterPage(_1,_2){},isc.A.goToPage=function isc_DSWizardBase_goToPage(_1,_2){if(_2){for(var i=0;i<this.pages.length;i++){if(this.pages[i].view)this.pages[i].view.hide()}}else{this.getPageView(this.currentPageNum).hide()}
var _4=this.getPage(_1);this.currentPageNum=this.getPageIndex(_4);var _5=this.getPageView(_1,true);if(_4.instructions)this.stepInstructions.setContents(_4.instructions);else this.stepInstructions.hide();this.addMember(_5,1);_5.show();this.updateButtons()},isc.A.go=function isc_DSWizardBase_go(_1){var _2=this.getPageIndex(this.currentPageNum);_2+=_1;this.goToPage(this.getPage(_2))},isc.A.nextPage=function isc_DSWizardBase_nextPage(){var _1=this.getPage(this.currentPageNum);if(_1.nextPage)this.goToPage(_1.nextPage);else this.go(1)},isc.A.previousPage=function isc_DSWizardBase_previousPage(){var _1=this.getPage(this.currentPageNum);if(_1.previousPage)this.goToPage(_1.previousPage);else this.go(-1)},isc.A.finish=function isc_DSWizardBase_finish(){this.hide();this.resetWizard()},isc.A.updateButtons=function isc_DSWizardBase_updateButtons(){var _1=this.getPageIndex(this.currentPageNum);if(_1==0)this.previousButton.hide();else this.previousButton.show();if(this.getPage(_1).endPage||_1==this.pages.length-1){this.nextButton.hide();this.finishButton.show()}else{this.nextButton.setDisabled(this.nextButtonIsDisabled(_1));this.nextButton.show();this.finishButton.hide()}},isc.A.$46i=function isc_DSWizardBase__nextButtonDisabled(_1){if(!this.$46j)this.$46j=[];this.$46j[this.currentPageNum]=!_1},isc.A.nextButtonIsDisabled=function isc_DSWizardBase_nextButtonIsDisabled(_1){return this.$46j?!this.$46j[_1]:true},isc.A.resetWizard=function isc_DSWizardBase_resetWizard(){delete this.$46j;this.goToPage(0,true)});isc.B._maxIndex=isc.C+15;isc.defineClass("DSWizard","DSWizardBase");isc.A=isc.DSWizard.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.pages=[{ID:"StartPage",instructions:"Select the source of data to bind to:"},{ID:"PickOperationPage",instructions:"Select a public Web Service, or enter a WSDL file URL.  Then select the operation to invoke"},{ID:"CallServicePage",instructions:"Use the provided form to invoke the web service and obtain a sample result, then select an approriate element set for list binding"},{ID:"ImportDataPage",previousPage:"StartPage",instructions:"Edit detected fields and observe results for imported data",endPage:true},{ID:"BindingPage",instructions:"Below is a default binding to a ListGrid.  Use the field editor to customize the binding",endPage:true},{ID:"SFPickEntityPage",instructions:"Choose an object type you would like to use in SmartClient applications"},{ID:"SFDonePage",instructions:"Below is an example of a grid bound to the chosen SForce Object",endPage:true},{ID:"KapowPickRobotPage",instructions:"Choose the Kapow Robot(s) you would like to use in SmartClient applications"}];isc.A.servicePickerDefaults={recordClick:function(_1,_2,_3){var _4=this.getRawCellValue(_2,_3,this.getFieldNum("wsdlURL"));this.logWarn("wsdlURL is: "+_4);this.creator.fetchWSDL(_4)}};isc.A.operationPickerDefaults={recordClick:function(_1,_2,_3){var _4=this.getRawCellValue(_2,_3,this.getFieldNum("name"));this.creator.wsdlDoc=this.data.document;this.creator.operationName=_4;this.creator.nextButton.enable()},alternateRecordStyles:true};isc.B.push(isc.A.enterStartPage=function isc_DSWizard_enterStartPage(_1){if(!this.dsTypePicker){this.createDSTypePicker();_1.view=this.dsTypePicker}
this.nextButton.setDisabled(this.dsTypePicker.getValue("dsType")==null)},isc.A.createDSTypePicker=function isc_DSWizard_createDSTypePicker(){this.dsTypePicker=this.createAutoChild("dsTypePicker",{layoutAlign:"center",width:350,showHeader:false,selectionType:"single",leaveScrollbarGap:false,width:300,showAllRecords:true,bodyOverflow:"visible",overflow:"visible",selectionChanged:function(){this.creator.nextButton.setDisabled(!this.anySelected())},getValue:function(){var _1=this.getSelectedRecord();if(!_1)return null;return _1.name},clearValues:function(){this.deselectAllRecords()},defaultEditContext:isc.EditPane.create({height:0}),recordDoubleClick:function(){this.creator.nextPage()}},isc.TreePalette);var _2=isc.DataSource.create({recordXPath:"/PaletteNodes/PaletteNode",fields:{name:{name:"name",type:"text",length:8,required:true},title:{name:"title",type:"text",title:"Title",length:128,required:true},className:{name:"className",type:"text",title:"Class Name",length:128,required:true},icon:{name:"icon",type:"image",title:"Icon Filename",length:128},iconWidth:{name:"iconWidth",type:"number",title:"Icon Width"},iconHeight:{name:"iconHeight",type:"number",title:"Icon Height"},iconSize:{name:"iconSize",type:"number",title:"Icon Size"},showDropIcon:{name:"showDropIcon",type:"boolean",title:"Show Drop Icon"},defaults:{name:"defaults",type:"Canvas",propertiesOnly:true},children:{name:"children",type:"paletteNode",multiple:true}}});if(this.callingBuilder){_2.dataURL=this.callingBuilder.workspacePath+"/../dataSourceWizards.xml";var _3=this;_2.fetchData({},function(_4,_5){_3.fetchWizardsReply(_5);_3.openWizardTree()})}},isc.A.fetchWizardsReply=function isc_DSWizard_fetchWizardsReply(_1){this.dsTypePicker.data.addList(_1,this.dsTypePicker.data.getRoot())},isc.A.openWizardTree=function isc_DSWizard_openWizardTree(_1){var _2=this.dsTypePicker.data;_2.openAll()},isc.A.nextPage=function isc_DSWizard_nextPage(){var _1=this.dsTypePicker.getValue(),_2=this.dsTypePicker.getSelectedRecord();_4=this;this.dsTypeRecord=_2;if(this.currentPageNum==0){if(_2.wizardConstructor){if(!_2.wizardDefaults){_2.wizardDefaults={}}
_2.wizardDefaults.width="80%";_2.wizardDefaults.height="80%";_2.wizardDefaults.autoCenter=true;_2.wizardDefaults.showDataView=true;var _3;if(isc.isAn.EditContext(this.dsTypePicker.defaultEditContext)){_3=this.dsTypePicker.defaultEditContext}else if(this.dsTypePicker.defaultEditContext.getEditContext&&isc.isAn.EditContext(this.dsTypePicker.defaultEditContext.getEditContext()))
{_3=this.dsTypePicker.defaultEditContext.getEditContext()}else{this.logWarn("ERROR: dsTypePicker's defaultEditContext neither 'is an' nor 'has an' EditContext.  Expect a null pointer exception!")}
_3.requestLiveObject(_2,function(_17){_4.showDSEditor(_17,true,_16)},this.dsTypePicker);if(this.callingBuilder)this.callingBuilder.wizardWindow.hide();return}
if(_2&&_2.className=="JavaBean"){var _4=this,_5=_2?_2.wizardDefaults:{};if(!_5||!_5.serverConstructor){isc.say("NOTE: This wizard <b>does not generate a fully functioning DataSource</b>; it creates a DataSource descriptor (.ds.xml file) which is ready to be loaded and bound to UI components, but does not provide CRUD functionality (search and editing of objects).<P>If you are using SQL or Hibernate, use the SQL or Hibernate wizards instead to generate a fully functional DataSource.  Otherwise, read the <a target='_blank' href='http://localhost:8080/isomorphic/system/reference/SmartClient_Reference.html#group..clientServerIntegration'>Client-Server Integration</a> topic in the <i>SmartClient Reference</i> to learn how to create a custom DataSource connector.",function(){_4.startJavaBeanWizard(_4,_2)});return}
this.startJavaBeanWizard(this,_2);return}
if(_1=="sforce"){var _6=this,_7=isc.WebService.get("urn:partner.soap.sforce.com");_7.ensureLoggedIn(function(){_6.goToPage("SFPickEntityPage")},true);return}else if(_1=="kapow"){var _6=this;if(!this.robotServerPicker)this.robotServerPicker=isc.RobotServerPicker.create({robotServerSelected:function(){_6.goToPage("KapowPickRobotPage")}});this.robotServerPicker.show();return}else if(_1=="webService"){var _6=this;var _8=isc.IButton.create({autoShow:false,title:"Next",autoFit:true,click:function(){_6.servicePicker.hide();_6.pickOperation()}});if(!this.servicePicker)this.servicePicker=isc.Dialog.create({title:"Enter WSDL Webservice URL",isModal:true,autoShow:false,autoSize:true,autoCenter:true,bodyDefaults:{padding:10},items:[isc.DynamicForm.create({autoShow:false,values:{serviceURL:"http://"},itemKeyPress:function(_17,_18){if(_18=='Enter'){_8.click()}},items:[{name:"serviceURL",title:"WSDL URL",type:"text",width:400}]}),isc.LayoutSpacer.create({height:10}),isc.HLayout.create({height:1,membersMargin:5,members:[_8,isc.IButton.create({autoShow:false,title:"Cancel",autoFit:true,click:function(){_6.servicePicker.hide()}})]})]});this.servicePicker.show();return}else if(["xmlFile","csvFile","jsonFile"].contains(_1)){var _9={"xmlFile":"text/xml","csvFile":"text/csv","jsonFile":"application/json"};var _6=this;_6.importFileType=_1;var _8=isc.IButton.create({autoDraw:false,title:"Next",autoFit:true,click:function(){var _10=_6.filePicker.items[0],_11=_6.filePicker.items[2];_10.clearErrors(true);_11.clearErrors(true);if(_10.getValue("file")==null&&_11.getValue("pasteData")==null){_11.setError("pasteData","File or paste data is required");_11.markForRedraw("show errors")}else if(_11.validate()){_6.filePicker.saveData(function(_17,_18){_6.filePicker.hide();_6.importFileData=_17;_6.importOrigData=_18;_6.importTargetType=_11.getValue("targetType");_6.dataSourceName=_11.getValue("dataSourceName");_6.goToPage("ImportDataPage")})}}});if(!this.filePicker)this.filePicker=isc.Dialog.create({title:"Select import file or paste contents",isModal:true,autoDraw:false,autoSize:true,autoCenter:true,bodyDefaults:{padding:10},items:[isc.DynamicForm.create({dataSource:"SCUploadSaveFile",autoDraw:false,width:"100%",colWidths:[100,"*"],fixedColWidths:true,itemKeyPress:function(_17,_18){if(_18=='Enter'){_8.click()}}}),isc.Label.create({contents:"OR",height:20,align:"right"}),isc.DynamicForm.create({autoDraw:false,width:"100%",fields:[{name:"pasteData",type:"TextAreaItem",title:"Paste Data",width:"*"},{name:"targetType",type:"radioGroup",title:"Target DS Type",defaultValue:"MockDataSource",valueMap:["MockDataSource","SQLDataSource","Hibernate"],redrawOnChange:true},{name:"dataSourceName",type:"text",title:"Mock DS Name",showIf:"values.targetType == 'MockDataSource'",required:true}]}),isc.LayoutSpacer.create({height:10}),isc.HLayout.create({height:1,width:"100%",membersMargin:5,align:"right",members:[isc.IButton.create({autoDraw:false,title:"Cancel",autoFit:true,click:function(){_6.filePicker.hide()}}),_8]})],initWidget:function(){this.Super("initWidget",arguments);this.clearData()},clearData:function(_1){var _10=this.items[0],_11=this.items[2];if(_1){var _12=_1.charAt(0).toUpperCase()+_1.replace("File","").substring(1)+" import file";_10.setFields([{name:"file",editorType:isc.TFileItem||isc.FileItem,title:_12,width:"*",endRow:true,multiple:false,accept:_9[_1]},{name:"file_dir",type:"HiddenItem",defaultValue:"[READ_ONLY]"}])}
_10.clearErrors(true);_11.clearErrors(true);_10.editNewRecord();_11.editNewRecord()},saveData:function(_17){var _10=this.items[0],_11=this.items[2],_13=function(_18){if(_6.importFileType=="xmlFile"){isc.DMI.callBuiltin({methodName:"xmlToJS","arguments":_18,callback:function(_19,_20,_21){_17(_19.data,_18)}})}else{_17(_18,_18)}};if(_10.getValue("file")!=null){_10.saveData(function(_18,_19,_20){_13(_19.file)})}else if(_11.getValue("pasteData")!=null){_13(_11.getValue("pasteData"))}}});this.filePicker.clearData(_1);var _14=isc.DataSource.get("SCUploadSaveFile");_14.performCustomOperation("checkUploadFeature",null,function(_17,_18){if(_17.status!=isc.RPCResponse.STATUS_SUCCESS){_6.filePicker.items[0].hide();_6.filePicker.items[1].hide();_6.filePicker.setTitle("Paste file contents")}
_6.filePicker.show()},{willHandleError:true});return}else if(_1!="webService"){var _15,_16;if(_1.contains("Hibernate")){_16="Each field you enter below corresponds to a database column of the same name.  The table name will be the same as the DataSource ID by default, or you may enter a Table Name below.  Hibernate database settings are in [webroot]/WEB-INF/classes/hibernate.cfg.xml"
_15={dataFormat:"iscServer",serverType:"hibernate"}}else if(_1.contains("SQL")){_16="Each field you enter below corresponds to a database column of the same name.  The table name will be the same as the DataSource ID by default, or you may enter a Table Name below.  By default, the default DataBase shown in the Admin Console will be used, or you may enter \"Database Name\" below.";_15={dataFormat:"iscServer",serverType:"sql"}}else if(_1=="simpleXML"){_16="For \"dataURL\", enter a URL which will return XML data.<P>For \"recordXPath\", enter an XPath that will select the XML tags you wish to use as rows. For example, if the tag you want is named \"Person\", a recordXPath of \"//Person\" will work for most simple XML formats.<P>Enter fields named after the subelements and attributes of the tag used for rows.  Click the \"More\" button to see more field properties and documentation, particularly \"valueXPath\"";_15={dataFormat:"xml"}}else if(_1=="json"){_16="For \"dataURL\", enter a URL which will return JSON data.<P>For \"recordXPath\", enter an XPath to an Array of Objects in the JSON data, then enter fields for each property of those Objects which you want to display, and its type.<P>Click the \"More\" button to see more field properties and documentation, particularly \"valueXPath\"";_15={dataFormat:"json"}}else if(_1=="rss"){_16="Enter the URL of the RSS feed as \"dataURL\" below, then add or remove fields.";_15={dataFormat:"xml",recordXPath:"//default:item|//item",fields:[{name:"title",title:"Title"},{name:"link",title:"Story",type:"link"},{name:"description",title:"Description"},{name:"pubDate",title:"Published"}]}}
this.showDSEditor(_15,true,_16);return}}
this.Super("nextPage")},isc.A.pickOperation=function isc_DSWizard_pickOperation(){isc.showPrompt("Loading WSDL...");isc.XML.loadWSDL(this.servicePicker.items[0].getValue("serviceURL"),this.getID()+".webServiceLoaded(service)",null,true)},isc.A.webServiceLoaded=function isc_DSWizard_webServiceLoaded(_1){isc.clearPrompt();if(_1){this.servicePicker.items[0].setValue("serviceURL","http://");var _2=this.callingBuilder;if(!_2.operationsPalette){if(_2.showRightStack!=false){_2.showOperationsPalette=true;_2.addAutoChild("operationsPalette");_2.rightStack.addSection({title:"Operations",autoShow:true,items:[_2.operationsPalette]},1)}
for(var i=0;i<_1.portTypes.length;i++){var _4=_1.portTypes[i];for(var j=0;j<_4.operation.length;j++){var _6=_4.operation[j];var _7={operationName:_6.name,serviceNamespace:_1.serviceNamespace,serviceName:_1.serviceName||_1.name,serviceDescription:_1.serviceName||_1.serviceNamespace,portTypeName:_4.portTypeName,location:_1.location}
_2.addWebService(_1,_7)}}}
_2.wizardWindow.hide()}},isc.A.fetchWSDL=function isc_DSWizard_fetchWSDL(_1){this.wsdlURL=_1;if(_1!=null){if(isc.isA.ResultSet(this.operationPicker.data)){this.operationPicker.data.invalidateCache()}
this.operationPicker.fetchData(null,null,{dataURL:_1})}},isc.A.enterCallServicePage=function isc_DSWizard_enterCallServicePage(_1){var _2=this.wsdlURL;isc.xml.loadWSDL(_2,this.getID()+".$46k(service)");if(this.serviceInput!=null)return;var _3=this.createAutoChild("callServicePage",{visibilityMode:"multiple"},isc.SectionStack);_1.view=_3;this.serviceInput=this.createAutoChild("serviceInput",{},isc.DynamicForm);var _4=this.createAutoChild("callServiceButton",{title:"Call Service",click:"this.creator.callService()",resizeable:false},isc.Button);_3.addSection({title:"Service Inputs",autoShow:true,items:[this.serviceInput,_4]});this.requestEditor=this.createAutoChild("requestEditor",{height:250,fields:[{name:"useEditedMessage",title:"Use Edited Message",type:"checkbox",defaultValue:false},{name:"requestBody",showTitle:false,type:"textArea",width:"*",height:"*",colSpan:"*"}]},isc.DynamicForm);_3.addSection({title:"Request Editor",items:[this.requestEditor]});this.serviceOutput=this.createAutoChild("serviceOutput",{showHeader:false,wrapCells:true,fixedRecordHeights:false},isc.DOMGrid);_3.addSection({title:"Service Output",autoShow:true,items:[this.serviceOutput]});this.expressionForm=this.createAutoChild("expressionForm",{numCols:4,colWidths:[120,150,"*",50],items:[{name:"selectBy",title:"Select Records By",width:"*",valueMap:{tagName:"Tag Name",xpath:"XPath Expression"},defaultValue:"xpath"},{name:"expression",showTitle:false,width:"*"},{type:"button",title:"Select",width:"*",startRow:false,click:"form.creator.selectNodes()"}]},isc.DynamicForm);this.selectedNodesView=this.createAutoChild("selectedNodesView",{showHeader:false,showRoot:false,wrapCells:true,fixedRecordHeights:false},isc.DOMGrid);_3.addSection({title:"Select Elements",autoShow:true,items:[this.expressionForm,this.selectedNodesView]})},isc.A.$46k=function isc_DSWizard__wsdlLoaded(_1){this.service=_1;this.serviceInput.setDataSource(this.service.getInputDS(this.operationName))},isc.A.callService=function isc_DSWizard_callService(){if(!this.serviceInput.validate())return;var _1=this.serviceInput.dataSource,_2=this.serviceInput.getValuesAsCriteria(),_3=this.serviceInputs=_1.getServiceInputs({data:_2});if(this.requestEditor){if(this.requestEditor.getValue("useEditedMessage")){var _4=this.requestEditor.getValue("requestBody");_3.requestBody=_4}else{this.requestEditor.setValue("requestBody",_3.requestBody)}}
_3.callback=this.getID()+".serviceOutput.setRootElement(xmlDoc.documentElement)";isc.xml.getXMLResponse(_3)},isc.A.selectNodes=function isc_DSWizard_selectNodes(){var _1=this.expressionForm,_2=this.serviceOutput.rootElement,_3;this.selectBy=_1.getValue("selectBy");if(this.selectBy=="xpath"){this.recordName=null;this.recordXPath=_1.getValue("expression");_3=isc.xml.selectNodes(_2,this.recordXPath)}else{this.recordXPath=null;this.recordName=_1.getValue("expression");var _4=_2.getElementsByTagName(this.recordName);_3=[];for(var i=0;i<_4.length;i++)_3.add(_4[i])}
this.selectedNodesView.setRootElement({childNodes:_3});this.selectedNodes=_3;this.nextButton.enable()},isc.A.enterBindingPage=function isc_DSWizard_enterBindingPage(_1){var _2=this.selectedNodesView.data,_3=_2.get(0).$9b,_4=_3.getAttribute("xsi:type")||_3.tagName;if(_4.contains(":"))_4=_4.substring(_4.indexOf(":")+1);var _5=this.outputDS=isc.DS.get(_4);this.logWarn("nodeType is: "+_4+", ds is: "+_5);this.boundGrid=this.createAutoChild("boundGrid",{dataSource:_5,data:this.selectedNodes,alternateRecordStyles:true},isc.ListGrid)
_1.view=this.boundGrid},isc.A.enterKapowPickRobotPage=function isc_DSWizard_enterKapowPickRobotPage(_1){if(!this.kapowRobotList){this.kapowRobotList=this.createAutoChild("kapowRobotList",{selectionChanged:function(){var _2=this.getSelectedRecord()!=null;this.creator.nextButton.setDisabled(!_2)}},isc.ListGrid);_1.view=this.kapowRobotList}
var _3=isc.XJSONDataSource.create({ID:"kapowRobotListDS",callbackParam:"json.callback",dataURL:window.robotServerURL+"/ISCVBListAllRobots?format=JSON",fields:[{name:"name",title:"Robot"},{name:"type",title:"Type"}],transformResponse:function(_7){var _4=[];for(var i=0;i<_7.data.length;i++){var _6=_7.data[i];if(_6.name.startsWith("ISCVB"))continue;_4.add(_6)}
_7.data=_4;_7.totalRows=_7.data.length;_7.endRow=_7.data.length-1;return _7}});this.kapowRobotList.setDataSource(_3);this.kapowRobotList.fetchData()},isc.A.kapowFinish=function isc_DSWizard_kapowFinish(){var _1=this.kapowRobotList.getSelection(),_2=_1.length;for(var i=0;i<_2;++i){var _4=_1[i];isc.XMLTools.loadXML(window.robotServerURL+"/admin/"+_4.name+".robot",this.getID()+".kapowRobotLoaded(xmlDoc,'"+_4.name+"','"+_4.type+"')")}},isc.A.saveDataSource=function isc_DSWizard_saveDataSource(_1){var _2=_1.getClassName();var _3;if(isc.DS.isRegistered(_2)){_3=isc.DS.get(_2)}else{_3=isc.DS.get("DataSource");_1._constructor=_2}
var _4=_3.xmlSerialize(_1);this.logWarn("saving DS with XML: "+_4);this.dsDataSource.saveFile({fileName:_1.ID,fileType:"ds",fileFormat:"xml"},_4)},isc.A.kapowRobotLoaded=function isc_DSWizard_kapowRobotLoaded(_1,_2,_3){this.logInfo("loaded robot: "+_2);var _4=isc.xml.selectNodes(_1,"//property[@name='startModelObjects']/element[@class='kapow.robot.common.domain.Entity']/property");_4=isc.xml.toJS(_4);var _5=[];for(var i=0;i<_4.length;i++){var _7=_4[i];if(!_7.xmlTextContent)continue;_5.add({name:_7.xmlTextContent,type:this.fieldTypeForJavaClass(_7["class"])})}
this.logWarn("Robot: "+_2+" - derived outputFields: "+isc.echoAll(_5));var _8;if(_5.length){_8=isc.DataSource.create({ID:_2+"DS",callbackParam:"json.callback",dataURL:window.robotServerURL+"/"+_2+"?format=JSON",noAutoFetch:true,fields:_5,dataFormat:"json",dataTransport:"scriptInclude"})}else if(_3=="rss"){var _8=isc.DataSource.create({ID:_2+"DS",dataURL:window.robotServerURL+"/"+_2,recordXPath:"//default:item",noAutoFetch:true,fields:[{name:"title"},{name:"link",type:"link"},{name:"description"},{name:"created"},{name:"category"},{name:"email"},{name:"name"},{name:"rights"}]})}
if(_8){this.callingBuilder.addDataSource(_8);this.saveDataSource(_8)}
var _9=isc.xml.selectNodes(_1,"//property[@name='queryParameters']/element[@class='kapow.robot.common.domain.Entity']/property");_9=isc.xml.toJS(_9);var _10=[];for(var i=0;i<_9.length;i++){var _7=_9[i];if(!_7.xmlTextContent)continue;if(_7.name&&_7.name.startsWith("value"))continue;_10.add({name:_7.xmlTextContent,type:this.fieldTypeForJavaClass(_7["class"])})}
this.logWarn("Robot: "+_2+" - derived inputFields: "+isc.echoAll(_10));if(_10.length){var _11=isc.DataSource.create({ID:_2+"InputDS",type:"generic",fields:_10});this.callingBuilder.addDataSource(_11);this.saveDataSource(_11)}
if(this.callingBuilder)this.callingBuilder.wizardWindow.hide();this.resetWizard()},isc.A.fieldTypeForJavaClass=function isc_DSWizard_fieldTypeForJavaClass(_1){switch(_1){case"java.lang.Boolean":return"boolean";case"java.util.Date":return"date";case"java.lang.Byte":case"java.lang.Short":case"java.lang.Integer":case"java.lang.Long":case"java.lang.BigInteger":return"integer";case"java.lang.Float":case"java.lang.Double":case"java.lang.BigDecimal":return"float";default:return"text"}},isc.A.enterSFPickEntityPage=function isc_DSWizard_enterSFPickEntityPage(_1){this.sfService=isc.WebService.get("urn:partner.soap.sforce.com");if(!this.sfEntityList){this.sfEntityList=this.createAutoChild("sfEntityList",{fields:[{name:"objectType",title:"Object Type"}],selectionChanged:function(){var _2=this.getSelectedRecord()!=null;this.creator.nextButton.setDisabled(!_2)}},isc.ListGrid);_1.view=this.sfEntityList}
this.sfService.getEntityList({target:this,methodName:"getEntityListReply"})},isc.A.getEntityListReply=function isc_DSWizard_getEntityListReply(_1){var _2=[];for(var i=0;i<_1.length;i++){_2.add({objectType:_1[i]})}
this.sfEntityList.setData(_2)},isc.A.enterSFDonePage=function isc_DSWizard_enterSFDonePage(_1){var _2=this.sfEntityList.getSelectedRecord().objectType;if(!this.sfGrid){this.sfGrid=this.createAutoChild("sfGrid",{},isc.ListGrid)}
this.sfService.getEntity(_2,{target:this,methodName:"showSFBoundGrid"});_1.view=this.sfGrid},isc.A.showSFBoundGrid=function isc_DSWizard_showSFBoundGrid(_1){this.sfGrid.setDataSource(_1);this.sfGrid.fetchData()},isc.A.sfFinish=function isc_DSWizard_sfFinish(){this.showDSEditor(this.sfGrid.dataSource,true,"You can remove fields below to prevent them from being shown, and alter user-visible titles.")},isc.A.enterImportDataPage=function isc_DSWizard_enterImportDataPage(_1){var _2=this.importFileData,_3=this.importFileType,_4,_5;var _6=isc.FileParser.create({hasHeaderLine:true});if(_3=="jsonFile"||_3=="xmlFile"){_4=_6.parseJsonData(_2)}else if(_3=="csvFile"){_4=_6.parseCsvData(_2)}
_5=_6.getFields();var _7={};if(this.importTargetType=="MockDataSource"){var _8=isc.MockDataSource.create({ID:this.dataSourceName,mockData:_4});var _9=isc.DataSourceEditor.create({dataSource:_8,dsDataSource:this.dsDataSource,autoDraw:false,canAddChildSchema:false,canEditChildSchema:false,builder:_23});var _10={target:this,methodName:"dsCreated"};_9.editNew(_8,_10);_9.save();return}else{var _11=isc.SchemaGuesser.create({fields:_5}),_12=_11.extractFieldsFrom(_4),_13=_11.convertData(_4);if(this.importTargetType=="SQLDataSource"||this.importTargetType=="Hibernate"){isc.addProperties(_7,{serverType:this.importTargetType=="SQLDataSource"?"sql":"hibernate",fields:_12})}}
this.importParsedData=_13;var _8=isc.DataSource.create(_7);var _14=isc.DataSource.create(_7,{clientOnly:true,testData:_13});var _15=isc.TabSet.create({width:"100%",height:"100%",autoDraw:false,tabs:[{title:"Edit Fields"},{title:"View Data"}]});var _16,_17=isc.ListGrid.create({width:"100%",height:"100%",fields:[{name:"fieldName",title:"Field",width:200},{name:"message",title:"Message",width:"*"}]}),_18=isc.SectionStack.create({visibilityMode:"multiple",width:"100%",height:"100%",sections:[{title:"Errors",expanded:true,hidden:true,items:[_17]}]});_15.setTabPane(1,_18);var _19=function(_29){if(_16!=null){_16.destroy()}
_16=isc.ListGrid.create({width:"100%",height:"100%",dataSource:_29,autoFetchData:true});return _16},_20=function(_29,_30){var _16=_19(_29);if(_18.getSections().getLength()>1){_18.removeSection(0)}
var _21={title:"Records",showHeader:false,expanded:true,items:[_16]};_18.addSection(_21,0);if(_30&&_30.length>0){_17.setData(_30);_18.showSection(1)}else{_18.hideSection(1)}};_20(_14);var _22=this,_23=this.callingBuilder;var _9=isc.DataSourceEditor.create({dataSource:_8,dsDataSource:this.dsDataSource,width:"100%",height:"100%",autoDraw:false,canAddChildSchema:false,canEditChildSchema:false,builder:_23,buttonLayoutProperties:{visibility:"hidden"},mainStackProperties:{_constructor:"TSectionStack"},mainEditorProperties:{_constructor:"TComponentEditor",formConstructor:isc.TComponentEditor},fieldLayoutProperties:{_constructor:"TLayout"},fieldEditorProperties:{fieldNameChanged:function(_29,_30){var _24=_6.getFieldNames(),_25=_24.indexOf(_29);if(_25<0)return;_24[_25]=_30;if(_3=="csvFile"){_4=_6.parseCsvData(_2)}else{_4.forEach(function(_31){if(_31[_29]!=null){_31[_30]=_31[_29];delete _31[_29]}})}
_5=_6.getFields();_11.fields=_5;_12=_11.extractFieldsFrom(_4);_13=_11.convertData(_4);_22.importParsedData=_13;_14.destroy();_14=isc.DataSource.create(_7,{clientOnly:true,fields:_12,testData:_13});_20(_14,_11.parseDetails)},fieldTypeChanged:function(_29){var _26=_5.find("name",_29.name);if(_26){_26.type=_29.type;_12=_11.extractFieldsFrom(_4);_13=_11.convertData(_4);_22.importParsedData=_13;_14.destroy();_14=isc.DataSource.create(_7,{clientOnly:true,fields:_12,testData:_13});_20(_14,_11.parseDetails)}}},getUniqueDataSourceID:function(){var _27,i=0;while(_27==null){_27="dataSource"+i;if(_23.dataSourceList.data.find("ID",_27)){_27=null;i++}}
return _27}});this.dsEditor=_9;_15.setTabPane(0,_9);var _10={target:this,methodName:"dsCreated"};_9.editNew(_8,_10);_1.view=_15},isc.A.dsCreated=function isc_DSWizard_dsCreated(_1){this.$1884=true;this.callingBuilder.addDataSource(_1,true);var _2=this.importFileType,_3=(_2=="xmlFile"?"xml":(_2=="jsonFile"?"js":"csv")),_4=this.importOrigData;if(_2=="jsonFile"){_4="var "+_1.ID+"TestData = "+isc.JSON.encode(this.importParsedData)+";"}
this.dsDataSource.saveFile({fileName:"test_data/"+_1.ID,fileType:"data",fileFormat:_3},_4);this.finish()},isc.A.importDataFinish=function isc_DSWizard_importDataFinish(_1){if(!this.$1884&&this.dsEditor&&!this.dsEditor.save())return;this.callingBuilder.wizardWindow.hide();this.resetWizard()},isc.A.finish=function isc_DSWizard_finish(){if(this.getCurrentPage().ID=="SFDonePage")return this.sfFinish();if(this.getCurrentPage().ID=="KapowPickRobotPage")return this.kapowFinish();if(this.getCurrentPage().ID=="ImportDataPage")return this.importDataFinish();this.logWarn("passing output DS: "+this.echo(this.outputDS));var _1=this.service.getFetchDS(this.operationName,this.outputDS);_1.recordXPath=this.recordXPath;_1.recordName=this.recordName;_1.fetchSchema.defaultCriteria=isc.addProperties({},this.serviceInput.getValues());this.logWarn("created DataSource with props: "+this.echo(_1));this.showDSEditor(_1)},isc.A.showDSEditor=function isc_DSWizard_showDSEditor(_1,_2,_3){this.callingBuilder.showDSEditor(_1,_2,_3);this.callingBuilder.wizardWindow.hide();this.resetWizard()});isc.evalBoundary;isc.B.push(isc.A.closeClick=function isc_DSWizard_closeClick(){this.Super("closeClick",arguments);this.resetWizard()},isc.A.resetWizard=function isc_DSWizard_resetWizard(){if(this.dsTypePicker)this.dsTypePicker.clearValues();if(this.servicePicker&&this.servicePicker.selectionManager){this.servicePicker.selectionManager.deselectAll();this.servicePicker.fireSelectionUpdated()}
if(this.operationPicker)this.operationPicker.setData([]);if(this.callServicePage){this.serviceInput.clearValues();this.serviceOutput.setData([]);this.expressionForm.clearValues();this.selectedNodesView.setData([])}
this.Super("resetWizard",arguments)},isc.A.startJavaBeanWizard=function isc_DSWizard_startJavaBeanWizard(_1,_2){isc.askForValue("Enter the name of the JavaBean for which you want to generate a DataSource.",function(_3){_1.continueJavaBeanWizard(_1,_2,_3)},{width:400})},isc.A.continueJavaBeanWizard=function isc_DSWizard_continueJavaBeanWizard(_1,_2,_3){if(_3){_1.getJavaBeanDSConfig(_1,_2,_3)}},isc.A.getJavaBeanDSConfig=function isc_DSWizard_getJavaBeanDSConfig(_1,_2,_3){if(_3!=null){isc.DMI.call("isc_builtin","com.isomorphic.tools.BuiltinRPC","getDataSourceConfigFromJavaClass",_3,function(_4){_1.finishJavaBeanWizard(_1,_2,_3,_4)})}},isc.A.finishJavaBeanWizard=function isc_DSWizard_finishJavaBeanWizard(_1,_2,_3,_4){var _5=_4.data.dsConfig?_4.data.dsConfig:null;if(isc.isAn.Object(_5)){if(_2.wizardDefaults)isc.addProperties(_5,_2.wizardDefaults);_1.showDSEditor(_5,true)}else{isc.say(_5)}});isc.B._maxIndex=isc.C+34;isc.defineClass("DataImportDialog","Dialog");isc.A=isc.DataImportDialog.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.isModal=true;isc.A.title="Import Data";isc.A.width=700;isc.A.height=490;isc.A.padding=0;isc.A.uploaderDefaults={showFilePickerForm:true,width:"100%",gridProperties:{defaultHeight:340},uploadReply:function(_1){this.Super("uploadReply",arguments);var _2={type:"checkbox",name:"save_cb",title:"Save as test data (so you can re-import any time)."};if(!this.checkForData){_2.value=true}else{_2.title+="<font color='red'>WARNING: will overwrite existing test data file and should not be checked.</font>"}
var _3={type:"checkbox",name:"wipe_cb",title:"Wipe existing data before import"};this.checkForDataForm=isc.DynamicForm.create({titleWidth:0,fields:[_2,_3]});var _4=this.creator.body;var _5=_4.reflowNow;_4.reflowNow=function(){this.Super("reflowNow",arguments);_4.scrollToBottom();_4.reflowNow=_5}
this.addMember(this.checkForDataForm,this.getMembers().indexOf(this.grid)+1)},commit:function(){if(this.checkForDataForm.getValue("save_cb")){this.storeTestData()}
if(this.checkForDataForm.getValue("wipe_cb")){var _1=this;isc.confirm("Really remove all existing records from this DataSource? This operation cannot be undone.",function(_4){if(_4){var _2=isc.DataSource.getDataSource(_1.grid.dataSource);var _3=isc.DataSource.getDataSource(_1.batchUploadDSName);_3.performCustomOperation("wipeData",{dsName:_2.ID},function(){_2.updateCaches({invalidateCache:true});_1.Super("commit",arguments)},{})}else{_1.Super("commit",arguments)}})}else{this.Super("commit",arguments)}},setCheckForData:function(_1){this.checkForData=_1;if(this.checkForDataForm&&_1){var _2=this.checkForDataForm.getField("save_cb");_2.title+="<font color='red'>WARNING: will overwrite existing test data file and should not be checked.</font>";_2.setValue(false)}},cleanup:function(){this.Super("cleanup",arguments);this.checkForDataForm.destroy();this.checkForDataForm=null;this.creator.close()}};isc.A.uploaderConstructor="BatchUploader";isc.A.helpMessageDefaults={contents:"Supported data formats are: <ul><li> CSV or TSV (comma- or tab-separated values)<li> JSON - an Array of Objects<li> XML</ul>All data formats are described in more detail in the documentation under \"Test Data\" <a href=\"http://www.smartclient.com/docs/release/a/b/c/go.html#group..testData\" target=\"_blank\">(click for docs at SmartClient.com)</a><p>Either DataSource field names or field titles may be used."};isc.A.helpMessageConstructor="HTMLFlow";isc.B.push(isc.A.initWidget=function isc_DataImportDialog_initWidget(){this.Super("initWidget",arguments);var _1=this;this.helpMessage=this.createAutoChild("helpMessage");this.uploader=this.createAutoChild("uploader",{uploadDataSource:this.targetDataSource,dataFormat:"auto"});this.addItem(this.helpMessage);this.addItem(this.uploader);var _2=this.targetDataSource.ID||this.targetDataSource;this.title="Import Data to "+_2;var _3=this;isc.DMI.callBuiltin({appID:"isc_builtin",className:"com.isomorphic.tools.BuiltinRPC",methodName:"checkForTestData",arguments:[{dsName:_2}],callback:function(_4,_5,_6){_3.uploader.setCheckForData(_5)}})});isc.B._maxIndex=isc.C+1;isc.defineClass("SchemaViewer","VLayout");isc.A=isc.SchemaViewer;isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.getTreeFromService=function isc_c_SchemaViewer_getTreeFromService(_1){return isc.Tree.create({service:_1,nameProperty:"$46l",titleProperty:"name",loadChildren:function(_12){if(this.isLoaded(_12))return;if(_12==this.root&&isc.isA.WebService(this.service)){var _2=this.service.getOperations();_2.setProperty("type","Operation");this.addList(_2,_12)}else if(_12==this.root&&isc.isA.SchemaSet(this.service)){var _3=this.service;for(var i=0;i<_3.schema.length;i++){this.add(this.getSchemaNode(_3.schema[i]),this.root)}}else if(_12.inputMessage){var _5=this.getMessageNode(_12,true);if(_5!=null)this.add(_5,_12);_5=this.getMessageNode(_12,false);if(_5!=null)this.add(_5,_12)}else if(_12.isComplexType){var _6=_12.liveSchema;for(var _7 in _6.getFields()){var _8=_6.getField(_7);if(!_6.fieldIsComplexType(_7)){this.add(isc.addProperties({},_8),_12)}else{var _9=_6.getSchema(_8.type);var _10=this.getSchemaNode(_9,_8.name,_8.xmlMaxOccurs);this.add(_10,_12)}}}
this.setLoadState(_12,isc.Tree.LOADED)},isFolder:function(_10){return(_10==this.root||_10.inputMessage||_10.isComplexType)},getSchemaNode:function(_9,_7,_12){var _3=isc.SchemaSet.get(_9.schemaNamespace),_8=_9.getField(_7),_10={name:_7||_9.tagName||_9.ID,type:_9.ID,isComplexType:true,xmlMaxOccurs:_12,liveSchema:_9,namespace:_9.schemaNamespace,location:_3?_3.location:null};return _10},getMessageNode:function(_12,_13){var _11=_13?this.service.getRequestMessage(_12):this.service.getResponseMessage(_12);if(!_11)return;return{name:_11.ID,type:_11.ID,isComplexType:true,liveSchema:_11}}})});isc.B._maxIndex=isc.C+1;isc.A=isc.SchemaViewer.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.showTestUI=true;isc.A.operationIcon="[SKINIMG]/SchemaViewer/operation.png";isc.A.complexTypeIcon="[SKINIMG]/SchemaViewer/complexType.gif";isc.A.simpleTypeIcon="[SKINIMG]/SchemaViewer/simpleType.png";isc.B.push(isc.A.setWsdlURL=function isc_SchemaViewer_setWsdlURL(_1){this.wsdlURL=_1;this.urlForm.setValue("url",_1)},isc.A.getWsdlURLs=function isc_SchemaViewer_getWsdlURLs(){var _1=isc.WebService.services.getProperty("serviceNamespace"),_2=this.wsdlURLs;if(_2==null&&_1.length==0)return;if(_2==null)_2=[];_2.addList(_1);return _2},isc.A.initWidget=function isc_SchemaViewer_initWidget(){this.Super("initWidget",arguments);this.createChildren()},isc.A.createChildren=function isc_SchemaViewer_createChildren(){var _1=this.getWsdlURLs();this.addAutoChild("urlForm",{numCols:4,colWidths:[100,"*",100,100],itemHoverWidth:300,saveOnEnter:true,saveData:function(){this.creator.fetchSchema()},items:[{name:"url",title:"WSDL",width:"*",defaultValue:this.wsdlURL,editorType:(_1!=null?"ComboBoxItem":"TextItem"),autoComplete:(_1!=null?"smart":null),showAllOptions:true,textMatchStyle:"substring",valueMap:_1},{type:"submit",title:"Show Messages",startRow:false,colSpan:1,endRow:false,width:"*"},{showTitle:false,startRow:false,width:"*",formItemType:"pickTree",shouldSaveValue:false,buttonProperties:{unselectedTitle:"Download",itemSelected:function(_2){this.canvasItem.form.creator.download(_2.name);return false}},valueTree:isc.Tree.create({root:{name:"download",title:"Download",children:[{name:"js",title:"as JS"},{name:"xml",title:"as XML"}]}}),icons:[{src:"[SKIN]/actions/help.png",width:16,height:16,prompt:"You can use the <b>Download</b> feature to download a SmartClient WebService definition for the specified WSDL file in either XML or JS format.  <p>You can achieve the same result by calling <i>XMLTools.loadWSDL()</i> or by using the <code>&lt;isomorphic:loadWSDL&gt;</code> JSP tag, however, for non-Java backends or for production use, a .js file should be obtained from this interface and loaded via &lt;SCRIPT SRC=&gt; either individually or combined with other files.  <p>See the reference documentation for details.",click:"isc.say(this.prompt)"}]}]},isc.DynamicForm);this.addMember(isc.VLayout.create({autoDraw:false,members:[isc.HLayout.create({autoDraw:false,members:[this.addAutoChild("treeGrid",{fields:[{treeField:true},{name:"type",title:"Type",width:140},{name:"xmlMaxOccurs",title:"#",width:35},{name:"namespace",title:"NS",width:35,showHover:true,hoverHTML:function(_2,_3){return"<NOBR>"+_3+"<NOBR>"}},{name:"location",title:"URL",width:35,showHover:true,hoverHTML:function(_2,_3){return"<NOBR>"+_3+"<NOBR>"},recordClick:function(_2,_3){_2.creator.setWsdlURL(_3.location);_2.creator.fetchSchema()}}],nodeClick:function(_2,_3,_4){if(this.creator.showTestUI){this.creator.updateInputStack(_3)}},getIcon:function(_2){if(_2.type=="Operation")return this.creator.operationIcon;else if(_2.isComplexType)return this.creator.complexTypeIcon;else return this.creator.simpleTypeIcon},showResizeBar:true},isc.TreeGrid),isc.VLayout.create({visibility:(this.showTestUI?"inherit":"hidden"),members:[this.addAutoChild("inputStack",{overflow:"auto",visibilityMode:"multiple",autoDraw:false,sections:[{showHeader:true,title:"Input Message (Body)",items:[this.addAutoChild("inputBodyForm",{useFlatFields:true},isc.DynamicForm)]}]},isc.SectionStack),isc.IButton.create({creator:this,autoDraw:false,title:"Invoke",click:function(){this.creator.updateResponseTree()}})]})]}),this.addAutoChild("responseStack",{visibility:(this.showTestUI?"inherit":"hidden"),autoDraw:false,visibilityMode:"multiple",sections:[this.getResponseSectionConfig()]},isc.SectionStack)]}))},isc.A.download=function isc_SchemaViewer_download(_1){var _2=this.urlForm.getValue("url");if(!_2){isc.warn("Please type in a WSDL URL");return}
var _3=_2.replace(/(.*\/)?(.*)/,"$2").replace(/(.*?)\?.*/,"$1").replace(/(.*)\..*/,"$1")+"."+_1;isc.DMI.callBuiltin({methodName:"downloadWSDL",arguments:[_2,_1,_3],requestParams:{showPrompt:false,useXmlHttpRequest:false,timeout:0}})},isc.A.fetchSchema=function isc_SchemaViewer_fetchSchema(){var _1=this.urlForm.getValue("url");if(_1==null||_1=="")return;if(isc.WebService.get(_1))return this.fetchSchemaReply(isc.WebService.get(_1));isc.RPCManager.addClassProperties({defaultPrompt:"Loading WSDL Schema",showPrompt:true})
isc.xml.loadWSDL(_1,{target:this,methodName:"fetchSchemaReply"},null,true,{captureXML:true})},isc.A.fetchSchemaReply=function isc_SchemaViewer_fetchSchemaReply(_1){isc.RPCManager.addClassProperties({defaultPrompt:"Contacting Server..."});this.service=_1;delete this.operationName;var _2=isc.SchemaViewer.getTreeFromService(_1);this.treeGrid.setData(_2);this.clearInputStack();this.clearResponseTree()},isc.A.clearInputStack=function isc_SchemaViewer_clearInputStack(){var _1=this.inputStack,_2=_1.sections.duplicate(),_3=[];for(var i=0;i<_2.length;i++){if(_2[i].isHeaderSection)_1.removeSection(_2[i])}
this.inputBodyForm.hide();this.inputBodyForm.clearValues()},isc.A.updateInputStack=function isc_SchemaViewer_updateInputStack(_1){this.clearInputStack();var _2=_1;while(_2.type!="Operation"){_2=this.treeGrid.data.getParent(_2)}
if(!_2)return;var _3=_2.name;this.operationName=_3;var _4=this.service.getInputHeaderSchema(_3);if(_4!=null){var _5=0;for(var _6 in _4){var _7=_4[_6],_8;if(isc.isA.DataSource(_7)){_8=isc.DynamicForm.create({useFlatFields:true,dataSource:_7})}else{_8=isc.DynamicForm.create({$46m:true,fields:[_7]})}
this.inputStack.addSection({showHeader:true,isHeaderSection:true,schemaName:_6,title:"Header: "+_6,items:[_8]},_5);_5+=1}}
var _9=this.service.getInputDS(_3);this.inputBodyForm.setDataSource(_9);if(!this.inputBodyForm.isVisible())this.inputBodyForm.show()},isc.A.updateResponseTree=function isc_SchemaViewer_updateResponseTree(){if(this.operationName==null)return;var _1=this.inputBodyForm.getValues(),_2,_3=this.service;for(var i=0;i<this.inputStack.sections.length;i++){var _5=this.inputStack.sections[i];if(!_5.isHeaderSection)continue;if(_2==null)_2={};var _6=_5.items[0];if(_6.$46m){_2[_5.schemaName]=_6.getValue(_6.getItem(0))}else{_2[_5.schemaName]=_6.getValues()}}
if(this.logIsDebugEnabled())
this.logDebug("operation:"+this.operationName+", body params:"+this.echoAll(_1)+", headerParams:"+this.echoAll(_2));_3.callOperation(this.operationName,_1,null,this.getID()+".setResponseTreeDoc(xmlDoc, rpcResponse, wsRequest)",{willHandleError:true,headerData:_2,useFlatFields:true,useFlatHeaderFields:true})},isc.A.getResponseSectionConfig=function isc_SchemaViewer_getResponseSectionConfig(){return{expanded:true,title:"Service Response",headerControls:[isc.LayoutSpacer.create(),isc.IButton.create({width:200,title:"Generate Sample Response",creator:this,click:function(){if(!this.creator.operationName)return;var _1=this.creator.service.getSampleResponse(this.creator.operationName);_1=isc.XMLTools.parseXML(_1);this.creator.setResponseTreeDoc(_1);this.creator.responseStack.setSectionTitle(0,"Service Response [Generated Sample]");return false},height:16,layoutAlign:"center",extraSpace:4,autoDraw:false}),isc.IButton.create({width:200,title:"Generate Sample Request",creator:this,click:function(){if(!this.creator.operationName)return;var _1=this.creator.service.getSampleRequest(this.creator.operationName);_1=isc.XMLTools.parseXML(_1);this.creator.showSampleRequest(_1);return false},height:16,layoutAlign:"center",extraSpace:4,autoDraw:false})],items:[]}},isc.A.setResponseTreeDoc=function isc_SchemaViewer_setResponseTreeDoc(_1,_2,_3){if(_2&&_2.status<0){var _4;if(_2.httpResponseCode==500){_4=_1.selectNodes("//faultstring");if(_4!=null)_4=isc.XML.toJS(_4);if(_4.length==0)_4=null}
if(_4){isc.warn("<b>Server Returned HTTP Code 500 (Internal Error)</b>"+(_4&&_4.length>0?("<br><br>"+_4.join("<br>")):""))}else{isc.RPCManager.handleError(_2,_3)}
return}
this.logInfo("showing a tree response");if(this.logIsDebugEnabled())this.logDebug("response data:"+this.echoAll(_1));this.clearSampleRequest();this.xmlDoc=_1;var _5=isc.DOMTree.create({rootElement:_1.documentElement});if(this.responseTree){this.responseTree.setData(_5)}else{this.addAutoChild("responseTree",{data:_5},isc.DOMGrid)}
if(!this.showingResponseTree){this.responseStack.removeSection(0);this.responseStack.addSection(isc.addProperties(this.getResponseSectionConfig(),{items:[this.responseTree]}),0)}
this.showingResponseTree=true},isc.A.clearResponseTree=function isc_SchemaViewer_clearResponseTree(){this.clearSampleRequest();if(!this.showingResponseTree)return;this.responseStack.removeSection(0);this.responseStack.addSection(this.getResponseSectionConfig())
delete this.showingResponseTree},isc.A.showSampleRequest=function isc_SchemaViewer_showSampleRequest(_1){this.logInfo("showing a sample request");if(this.logIsDebugEnabled())this.logDebug("sample request data:"+this.echoAll(_1));var _2=isc.DOMTree.create({rootElement:_1.documentElement});if(!this.showingSampleRequest){this.responseStack.addSection({isSampleRequest:true,expanded:true,resizable:true,title:"Generated Sample Service Request",items:[this.addAutoChild("requestTree",{data:_2},isc.DOMGrid)]})}else{this.requestTree.setData(_2)}
this.showingSampleRequest=true},isc.A.clearSampleRequest=function isc_SchemaViewer_clearSampleRequest(){if(this.showingSampleRequest){for(var i=0;i<this.responseStack.sections.length;i++){if(this.responseStack.sections[i].isSampleRequest){this.responseStack.removeSection(i);break}}}delete this.showingSampleRequest});isc.B._maxIndex=isc.C+15;isc.defineClass("SchemaGuesser");isc.A=isc.SchemaGuesser;isc.A.TOO_FEW_EXAMPLES="tooFewExamples";isc.A.TOO_MANY_SPECIAL_VALUES="tooManySpecialValues";isc.A=isc.SchemaGuesser.getPrototype();isc.A.minExampleCount=10;isc.A.minDateYear=1970;isc.A.centuryThreshold=25;isc.A.treatEmptyValueAsBooleanFalse=true;isc.A.valueEquivalences=[{value:"NA",equivalent:"N/A"}];isc.A.booleanTrueValues=["t","true","yes","[x]","1"];isc.A.booleanFalseValues=["f","false","no","[]","[ ]","0"];isc.A=isc.SchemaGuesser.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.init=function isc_SchemaGuesser_init(){this.Super("init",arguments);this.$1782={"boolean":{fieldType:"boolean",canConvert:this.isBoolean,convert:this.toBoolean},"time":{fieldType:"time",canConvert:this.isTime,convert:this.toTime},"dateTimeYMD":{fieldType:"datetime",canConvert:this.isDateTimeYMD,convert:this.toDateTimeYMD},"dateTimeMDY":{fieldType:"datetime",canConvert:this.isDateTimeMDY,convert:this.toDateTimeMDY},"dateTimeDMY":{fieldType:"datetime",canConvert:this.isDateTimeDMY,convert:this.toDateTimeDMY},"dateTimeSchema":{fieldType:"datetime",canConvert:this.isDateTimeSchema,convert:this.toDateTimeSchema},"dateYM":{fieldType:"date",canConvert:this.isDateYM,convert:this.toDateYM},"dateMY":{fieldType:"date",canConvert:this.isDateMY,convert:this.toDateMY},"dateYMD":{fieldType:"date",canConvert:this.isDateYMD,convert:this.toDateYMD},"dateMDY":{fieldType:"date",canConvert:this.isDateMDY,convert:this.toDateMDY},"dateDMY":{fieldType:"date",canConvert:this.isDateDMY,convert:this.toDateDMY},"integer":{fieldType:"integer",canConvert:this.isInteger,convert:this.toInteger},"float":{fieldType:"float",canConvert:this.isFloat,convert:this.toFloat}}},isc.A.extractFieldsFrom=function isc_SchemaGuesser_extractFieldsFrom(_1){if(_1&&!isc.isAn.Array(_1))_1=[_1];if(!_1||_1.length==0){this.logWarn("Missing or empty data - Cannot extract field types");return null}
this.resetState();this.recordCount=_1.length;this.classifyValues(_1);this.extractEmptyDisplayValues(_1);this.deriveTypes();this.derivedFields=this.createFields();return this.derivedFields},isc.A.convertData=function isc_SchemaGuesser_convertData(_1){if(!this.$1783){this.logWarn("extractFieldsFrom must be called before parsed data can be fetched");return null}
if(!_1||(_1&&isc.isAn.Array(_1)&&_1.length==0))return _1;return this.convertValues(_1)},isc.A.resetState=function isc_SchemaGuesser_resetState(){this.derivedFields=[];this.parsedFields=[];this.parsedData=[];this.parseDetails=[];this.$1783={}},isc.A.classifyValues=function isc_SchemaGuesser_classifyValues(_1){for(var i=0;i<_1.length;i++){var _3=_1[i];for(var _4 in _3){var _5=this.$1783[_4];if(!_5){_5=this.$1783[_4]=this.createFieldState(_4)}
if(_5.detectedAs){continue}
var _6=_3[_4];if(isc.isAn.Object(_6)){continue}
if(_6==null||(isc.isA.String(_6)&&!isc.isA.nonemptyString(_6))){_5.emptyValueCount++;continue}
if(!isc.isA.String(_6)){_6=""+_6}
for(var _7 in this.$1782){var _8=this.$1782[_7];if(this.fireCallback(_8.canConvert,"value",[_6])){_5[_7].valueCount++}else{if(!_5[_7].badValues.contains(_6)){_5[_7].badValues.add(_6)}}}}}},isc.A.extractEmptyDisplayValues=function isc_SchemaGuesser_extractEmptyDisplayValues(_1){for(var _2 in this.$1783){var _3=this.$1783[_2];if(!_3.detectedAs){for(var _4 in this.$1782){var _5=this.$1782[_4],_6=_3[_4].badValues,_7=null,_8=[];if(_4!="boolean"&&_3.emptyValueCount>0){continue}
if(_6.length>0){var _9={lowerValue:null,variants:[]};for(var i=0;i<_6.length;i++){var _11=_6[i],_12=_11.toLowerCase(),_13=this.getValueEquivalences(_11);if(_9.lowerValue){var _14=false;for(var j=0;j<_13.length;j++){var _16=_13[j],_17=_16.toLowerCase();if(_9.lowerValue&&_9.lowerValue==_17){_14=true;break}}
if(!_14&&_9.lowerValue!=_12){_9=null;break}}
if(!_9.lowerValue)_9.lowerValue=_12;if(!_9.variants.contains(_11))_9.variants.add(_11)}
if(_9){var _18=-1;for(var j=0;j<_9.variants.length;j++){var _19=_9.variants[j],_20=_1.findAll(_2,_19),_21=(_20?_20.length:0);if(_21>_18){_18=_21;_7=_19}
_6.remove(_19);_8.add(_19)}}}
if(_7&&_4=="boolean"){var _22=[];_1.map(function(_24){var _19=_24[_2];if(_19==null||_22.length>2)return;var _23=_19.toLowerCase();if(!_22.contains(_23)&&!_8.contains(_19))_22.add(_23)});if(_22.length==1){_7=null;_3[_4].badValues.addList(_8)}}
if(_7){_3[_4].emptyDisplayValue=_7;_3[_4].nullValues=_8}}}}},isc.A.deriveTypes=function isc_SchemaGuesser_deriveTypes(){for(var _1 in this.$1783){var _2=this.$1783[_1];if(!_2.detectedAs){var _3=this.chooseType(_2),_4=null;if(_3.type){var _5=[_3.typeProcessName],_6=_3.type;while(!_4){var _7=this.chooseType(_2,_5);if(!_7.typeProcessName||_2[_7.typeProcessName].badValues==0){_4=_7}
_5.add(_7.typeProcessName);_6=_7.type}}
var _8=_3,_9=null,_10=null;if(_8.typeProcessName=="boolean"){if(_2[_8.typeProcessName].emptyDisplayValue==null&&_2[_8.typeProcessName].badValues.length>0)
{_8=_4}}
if(_4&&this.recordCount<this.minExampleCount){_9=_8;_8=_4;_2.reason=isc.SchemaGuesser.TOO_FEW_EXAMPLES;_10={message:"Field '"+_1+"' was detected as "+_8.type+" despite having only "+_9.type+" values because only "+this.recordCount+" records were provided."};if(_9.type=="boolean"){_10.message+=" To force detection as boolean use 'F' and 'T' values."}}else if(_4&&_8.typeProcessName&&_2[_8.typeProcessName].badValues.length>0){_9=_8;_8=_4;_2.reason=isc.SchemaGuesser.TOO_MANY_SPECIAL_VALUES;_10={message:"Field '"+_1+"' was detected as "+_8.type+" despite having many "+_9.type+" values because it had more than one special value. If data is modified so that only one special value is used, field will be detected as type "+_9.type,specialValues:_2[_9.typeProcessName].badValues}}
if(_9||_10){if(!_10)_10={};_10.fieldName=_1;_10.detectedAs=_8.type;_10.couldBe=_9.type;_10.reason=_2.reason;if(_10.detectedAs!=_10.couldBe){this.parseDetails.add(_10)}}
if(_8.addEmptyDisplayValue&&_8.typeProcessName&&_2[_8.typeProcessName]){var _11=_2[_8.typeProcessName];if(_11.emptyDisplayValue)_2.emptyDisplayValue=_11.emptyDisplayValue;if(_11.nullValues)_2.nullValues=_11.nullValues}
_2.detectedAs=_8.type;if(_9)_2.couldBe=_9.type;_2.typeProcessName=_8.typeProcessName}}},isc.A.chooseType=function isc_SchemaGuesser_chooseType(_1,_2){if(!_2)_2=[];var _3=_1.emptyValueCount;var _4={addEmptyDisplayValue:null};if(!_2.contains("boolean")&&_1.boolean.valueCount>0&&_1.boolean.valueCount>_3&&((this.treatEmptyValueAsBooleanFalse?0:_3)+_1.boolean.badValues.length<=1))
{_4.typeProcessName="boolean";_4.addEmptyDisplayValue=(_3==0||this.treatEmptyValueAsBooleanFalse)}else if(!_2.contains("time")&&_1.time.valueCount>0&&_1.time.valueCount+_3>_1.time.badValues.length)
{_4.typeProcessName="time"}else if(!_2.contains("dateTimeYMD")&&_1.dateTimeYMD.valueCount>0&&_1.dateTimeYMD.valueCount+_3>_1.dateTimeYMD.badValues.length)
{_4.typeProcessName="dateTimeYMD"}else if(!_2.contains("dateTimeMDY")&&_1.dateTimeMDY.valueCount>0&&_1.dateTimeMDY.valueCount+_3>_1.dateTimeMDY.badValues.length)
{_4.typeProcessName="dateTimeMDY"}else if(!_2.contains("dateTimeDMY")&&_1.dateTimeDMY.valueCount>0&&_1.dateTimeDMY.valueCount+_3>_1.dateTimeDMY.badValues.length)
{_4.typeProcessName="dateTimeDMY"}else if(!_2.contains("dateTimeSchema")&&_1.dateTimeSchema.valueCount>0&&_1.dateTimeSchema.valueCount+_3>_1.dateTimeSchema.badValues.length)
{_4.typeProcessName="dateTimeSchema"}else if(!_2.contains("dateYM")&&_1.dateYM.valueCount>0&&_1.dateYM.valueCount+_3>_1.dateYM.badValues.length)
{_4.typeProcessName="dateYM"}else if(!_2.contains("dateMY")&&_1.dateMY.valueCount>0&&_1.dateMY.valueCount+_3>_1.dateMY.badValues.length)
{_4.typeProcessName="dateMY"}else if(!_2.contains("dateYMD")&&_1.dateYMD.valueCount>0&&_1.dateYMD.valueCount+_3>_1.dateYMD.badValues.length)
{_4.typeProcessName="dateYMD"}else if(!_2.contains("dateMDY")&&_1.dateMDY.valueCount>0&&_1.dateMDY.valueCount+_3>_1.dateMDY.badValues.length)
{_4.typeProcessName="dateMDY"}else if(!_2.contains("dateDMY")&&_1.dateDMY.valueCount>0&&_1.dateDMY.valueCount+_3>_1.dateDMY.badValues.length)
{_4.typeProcessName="dateDMY"}else if(!_2.contains("integer")&&_1.integer.valueCount>0&&_1.integer.valueCount+_3>_1.integer.badValues.length&&_1.integer.valueCount>=_1.float.valueCount)
{_4.typeProcessName="integer"}else if(!_2.contains("float")&&_1.float.valueCount>0&&_1.float.valueCount+_3>_1.float.badValues.length)
{_4.typeProcessName="float"}else{_4.type="text";_4.addEmptyDisplayValue=false}
if(_4.typeProcessName){_4.type=_1[_4.typeProcessName].fieldType;if(_4.addEmptyDisplayValue==null){_4.addEmptyDisplayValue=(_3==0)}}
return _4},isc.A.createFields=function isc_SchemaGuesser_createFields(){var _1=[];for(var _2 in this.$1783){var _3=this.$1783[_2];var _4=_3.detectedAs||"text",_5=isc.addProperties({},_3.fieldTemplate,{name:_2,type:_4});if(_3.emptyDisplayValue)_5.emptyDisplayValue=_3.emptyDisplayValue;_1.add(_5)}
if(this.fields){for(var i=0;i<this.fields.length;i++){var _5=this.fields[i];if(_5.name){if(!_1.containsProperty("name",_5.name)){_1.add(isc.addProperties({},_5))}}}}
return _1},isc.A.convertValues=function isc_SchemaGuesser_convertValues(_1){var _2=this.derivedFields,_3=[],_4={};for(var i=0;i<_1.length;i++){var _6=_1[i],_7={};for(var _8 in this.$1783){var _9=this.$1783[_8],_10=_9.detectedAs||"text",_11=(_9.detectedAs&&_9.fieldTemplate&&_9.fieldTemplate.type==_9.detectedAs),_12=_6[_8],_13=_12,_14=(_9.typeProcessName&&this.$1782[_9.typeProcessName].convert?this.$1782[_9.typeProcessName].convert:this.toText);if(isc.isAn.Object(_13)){continue}
if(_9.nullValues){for(var j=0;j<_9.nullValues.length;j++){if(_13==_9.nullValues[j]){_13=null;break}}}
_7[_8]=(_13!=null||_12==null?this.fireCallback(_14,"value",[_12==null?_12:""+_12]):null);if(_11&&(_13!=null||_12==null)&&_7[_8]==null){_4[_8]=(_4[_8]||0)+1}}
_3.push(_7)}
for(var _16 in _4){var _17=_4[_16];if(_17>10||_17==_1.length){var _18={fieldName:_16,message:"Conversion of values to '"+this.$1783[_16].fieldTemplate.type+"' failed for "+_17+" of "+_1.length+" records."};this.parseDetails.add(_18)}}
return _3},isc.A.createFieldState=function isc_SchemaGuesser_createFieldState(_1){var _2={};if(this.fields){var _3=this.fields.find("name",_1);if(_3){_2.fieldTemplate=_3;if(_3.type){_2.detectedAs=_3.type}}}
_2.emptyValueCount=0;for(var _4 in this.$1782){var _5=this.$1782[_4];_2[_4]={fieldType:_5.fieldType,valueCount:0,badValues:[]};if(_2.detectedAs&&!_2.typeProcessName&&_2.detectedAs==_5.fieldType){_2.typeProcessName=_4}}
return _2},isc.A.getValueEquivalences=function isc_SchemaGuesser_getValueEquivalences(_1){var _2=[_1];for(var i=0;i<this.valueEquivalences.length;i++){var _4=this.valueEquivalences[i];if(_1.toLowerCase()==_4.value.toLowerCase()){_2.add(_4.equivalent)}else if(_1.toLowerCase()==_4.equivalent.toLowerCase()){_2.add(_4.value)}}
return _2},isc.A.isBoolean=function isc_SchemaGuesser_isBoolean(_1){return this.booleanTrueValues.contains(_1.toLowerCase())||this.booleanFalseValues.contains(_1.toLowerCase())},isc.A.isFloat=function isc_SchemaGuesser_isFloat(_1){var _2=this.decimalSymbol||isc.NumberUtil.decimalSymbol;var _3=this.groupingSymbol||isc.NumberUtil.groupingSymbol;if(!this.$1784||this.$1785!=this.decimalSymbol||this.$1786!=this.groupingSymbol)
{this.$1784=new RegExp("^\\s*([+-]?(((\\d+(\\"+_2+")?)|(\\d*\\"+_2+"\\d+)|(\\d+(?:[\\"+_3+"]\\d{3})*\\"+_2+"\\d+))([eE][+-]?\\d+)?))\\s*$");this.$1785=this.decimalSymbol;this.$1786=this.groupingSymbol}
return this.$1784.test(_1)},isc.A.isInteger=function isc_SchemaGuesser_isInteger(_1){var _2=this.groupingSymbol||isc.NumberUtil.groupingSymbol;if(!this.$1787||this.$1788!=this.groupingSymbol)
{this.$1787=new RegExp("^\\s*([+-]?((\\d+(?:[\\"+_2+"]\\d{3})*)))\\s*$");this.$1788=this.groupingSymbol}
return this.$1787.test(_1)},isc.A.isDateYM=function isc_SchemaGuesser_isDateYM(_1){var _2=new RegExp("^\\s*(\\d{1,4})([\\.-/])(\\d{1,2})\\s*$");var _3=_2.exec(_1);if(_3){var _4=parseInt(_3[1],10),_5=_3[2],_6=parseInt(_3[3],10);if(_6>=1&&_6<=12&&(_5!="."||_4>=this.minDateYear)){return true}}
return false},isc.A.isDateMY=function isc_SchemaGuesser_isDateMY(_1){var _2=new RegExp("^\\s*(\\d{1,2})([\\.-/])(\\d{1,4})\\s*$");var _3=_2.exec(_1);if(_3){var _4=parseInt(_3[1],10),_5=_3[2],_6=parseInt(_3[3],10);if((_5!="."||_6>=this.minDateYear)&&_4>=1&&_4<=12){return true}}
return false},isc.A.isDateYMD=function isc_SchemaGuesser_isDateYMD(_1){var _2=isc.Date.parseInput(_1,"YMD",this.centuryThreshold,true,false);return(_2!=null)},isc.A.isDateMDY=function isc_SchemaGuesser_isDateMDY(_1){var _2=isc.Date.parseInput(_1,"MDY",this.centuryThreshold,true,false);return(_2!=null)},isc.A.isDateDMY=function isc_SchemaGuesser_isDateDMY(_1){var _2=isc.Date.parseInput(_1,"DMY",this.centuryThreshold,true,false);return(_2!=null)},isc.A.isDateTimeYMD=function isc_SchemaGuesser_isDateTimeYMD(_1){if(!isc.DateUtil.isDatetimeString(_1,"YMD"))return false;var _2=isc.Date.parseInput(_1,"YMD",null,true,false);return(_2!=null)},isc.A.isDateTimeMDY=function isc_SchemaGuesser_isDateTimeMDY(_1){if(!isc.DateUtil.isDatetimeString(_1,"MDY"))return false;var _2=isc.Date.parseInput(_1,"MDY",null,true,false);return(_2!=null)},isc.A.isDateTimeDMY=function isc_SchemaGuesser_isDateTimeDMY(_1){if(!isc.DateUtil.isDatetimeString(_1,"DMY"))return false;var _2=isc.Date.parseInput(_1,"DMY",null,true,false);return(_2!=null)},isc.A.isDateTimeSchema=function isc_SchemaGuesser_isDateTimeSchema(_1){var _2=_1.match(/(\d{4})[\/-](\d{2})[\/-](\d{2})([T ](\d{2}):(\d{2})(:(\d{2}))?)?(\.(\d+))?([+-]\d\d?:\d{2}|Z)?/);if(_2==null||!_2[4])return false;var _3=isc.DateUtil.parseSchemaDate(_1);return(_3!=null)},isc.A.isTime=function isc_SchemaGuesser_isTime(_1){var _2=/^\d+$/;if(_2.test(_1))return false;var _3=false;if(!isc.SchemaGuesser.$he){isc.SchemaGuesser.$he=isc.Time.$he.duplicate();isc.SchemaGuesser.$he.addList([/^\s*(\d?\d)\.(\d?\d)\.(\d?\d)?\s*([AaPp][Mm]?)?\s*([+-]\d{2}:\d{2}|Z)?\s*$/,/^\s*(\d?\d)\.(\d?\d)(\s*)([AaPp][Mm]?)?\s*([+-]\d{2}:\d{2}|Z)?\s*$/])}
for(var i=0;i<isc.SchemaGuesser.$he.length;i++){var _5=isc.SchemaGuesser.$he[i].exec(_1);if(_5)break}
if(_5){_3=true;var _6=_5[1]?parseInt(_5[1],10):null,_7=_5[2]?parseInt(_5[2],10):0,_8=_5[3]?parseInt(_5[3],10):0,_9=_5[4];if(_9){if(!this.$hh)this.$hh={p:true,P:true,pm:true,PM:true,Pm:true,pM:true};if(!this.$1789)this.$1789={a:true,A:true,am:true,AM:true,Am:true,aM:true};if(this.$hh[_9]==true){if(_6==null)_6=12;else if(_6<12)_6+=12}else if(this.$1789[_9]==true){if(_6==null)_6=0;else if(_6>12)_6-=12}else{_3=false}}
if(_3&&_6==null){_3=false}else if(_3){if(_6<0||_6>23||_7<0||_7>59){_3=false}}}
return _3},isc.A.toText=function isc_SchemaGuesser_toText(_1){return _1},isc.A.toBoolean=function isc_SchemaGuesser_toBoolean(_1){if(this.treatEmptyValueAsBooleanFalse&&(_1==null||!isc.isA.nonemptyString(_1))){return false}
var _2=this.booleanTrueValues.contains(_1.toLowerCase());if(!_2){if(!this.booleanFalseValues.contains(_1.toLowerCase())){_2=null}}
return _2},isc.A.toFloat=function isc_SchemaGuesser_toFloat(_1){var _2=isc.NumberUtil.parseLocaleFloat(_1,this.decimalSymbol||isc.NumberUtil.decimalSymbol,this.groupingSymbol||isc.NumberUtil.groupingSymbol);return(isNaN(_2)?null:_2)},isc.A.toInteger=function isc_SchemaGuesser_toInteger(_1){var _2=isc.NumberUtil.parseLocaleInt(_1,this.groupingSymbol||isc.NumberUtil.groupingSymbol);return(isNaN(_2)?null:_2)},isc.A.toDateYM=function isc_SchemaGuesser_toDateYM(_1){var _2=new RegExp("^\\s*(\\d{1,4})([\\.-/])(\\d{1,2})\\s*$");var _3=_2.exec(_1);if(!_3)return null;var _4=parseInt(_3[1],10),_5=_3[2],_6=parseInt(_3[3],10),_7=null;if(_6>=1&&_6<=12&&(_5!="."||_4>=this.minDateYear)){_7=isc.Date.create(_4,_6-1,1)}
return _7},isc.A.toDateMY=function isc_SchemaGuesser_toDateMY(_1){var _2=new RegExp("^\\s*(\\d{1,2})([\\.-/])(\\d{1,4})\\s*$");var _3=_2.exec(_1);if(!_3)return null;var _4=parseInt(_3[1],10),_5=_3[2],_6=parseInt(_3[3],10),_7=null;if(_4>=1&&_4<=12&&(_5!="."||_6>=this.minDateYear)){_7=isc.Date.create(_6,_4-1,1)}
return _7},isc.A.toDateYMD=function isc_SchemaGuesser_toDateYMD(_1){return isc.Date.parseInput(_1,"YMD",this.centuryThreshold,true,false)},isc.A.toDateMDY=function isc_SchemaGuesser_toDateMDY(_1){return isc.Date.parseInput(_1,"MDY",this.centuryThreshold,true,false)},isc.A.toDateDMY=function isc_SchemaGuesser_toDateDMY(_1){return isc.Date.parseInput(_1,"DMY",this.centuryThreshold,true,false)},isc.A.toDateTimeYMD=function isc_SchemaGuesser_toDateTimeYMD(_1){return isc.Date.parseInput(_1,"YMD",this.centuryThreshold,true)},isc.A.toDateTimeMDY=function isc_SchemaGuesser_toDateTimeMDY(_1){return isc.Date.parseInput(_1,"MDY",this.centuryThreshold,true)},isc.A.toDateTimeDMY=function isc_SchemaGuesser_toDateTimeDMY(_1){return isc.Date.parseInput(_1,"DMY",this.centuryThreshold,true)},isc.A.toDateTimeSchema=function isc_SchemaGuesser_toDateTimeSchema(_1){var _2=_1.match(/(\d{4})[\/-](\d{2})[\/-](\d{2})([T ](\d{2}):(\d{2})(:(\d{2}))?)?(\.(\d+))?([+-]\d\d?:\d{2}|Z)?/);if(!_2)return false;return isc.DateUtil.parseSchemaDate(_1)},isc.A.toTime=function isc_SchemaGuesser_toTime(_1){_1=_1.replace(/\./g,":");return isc.Time.parseInput(_1,true)});isc.B._maxIndex=isc.C+39;isc.defineClass("FileParser");isc.A=isc.FileParser.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.hasHeaderLine=false;isc.A.separatorChar=",";isc.A.separatorChar=",";isc.A.allowQuotedValues=true;isc.B.push(isc.A.parseCsvLine=function isc_FileParser_parseCsvLine(_1){if(!this.allowQuotedValues){return _1.split(this.separatorChar)}
var _2=false,_3=[],_4=[];_1.split('').forEach(function(_5){if(_5===this.quoteChar){_2=!_2}else{if(_5==this.separatorChar&&!_2){_3.push(_4.join(''));_4=[]}else{_4.push(_5)}}},this);if(_4.length>0)_3.push(_4.join(''));return(_3.length>0?_3:null)},isc.A.parseCsvData=function isc_FileParser_parseCsvData(_1){if(!isc.isAn.Array(_1)){if(_1.contains("\r\n")){_1=_1.split("\r\n")}else if(_1.contains("\r")){_1=_1.split("\r")}else if(_1.contains("\n")){_1=_1.split("\n")}else{_1=[_1]}}
var _2=this.fieldNames;this.derivedFieldNames=null;if(!_2){_2=this.parseCsvLine(_1[0]);if(!this.hasHeaderLine){for(var i=0;i<_2.length;i++)_2[i]="field"+(i+1)}
this.derivedFieldNames=_2}
if(this.hasHeaderLine){_1=_1.slice(1)}
var _4=[];_1.forEach(function(_8){var _5=this.parseCsvLine(_8);if(_5)_4.push(_5)},this);var _6=_4.map(function(_8){var _7={};_2.forEach(function(_9,i){_7[_9]=_8[i]});return _7});return _6},isc.A.parseJsonData=function isc_FileParser_parseJsonData(_1){var _2=isc.JSON.decode(_1);if(isc.isAn.Object(_2)){var _3=isc.getKeys(_2);if(_3.length==1&&isc.isAn.Array(_2[_3[0]])){_2=_2[_3[0]]}}
if(!isc.isAn.Array(_2)){this.logWarn("Invalid data - unable to extract an array of records");return[]}
var _4=[];_2.forEach(function(_7){var _3=isc.getKeys(_7);for(var i=0;i<_3.length;i++){var _6=_3[i];if(!_4.contains(_6))_4.add(_6)}});this.fieldNames=_4;return _2},isc.A.getFieldNames=function isc_FileParser_getFieldNames(){return this.fieldNames||this.derivedFieldNames},isc.A.getFields=function isc_FileParser_getFields(){var _1=this.getFieldNames(),_2=[];_1.forEach(function(_3){_2.add({name:_3})});return _2});isc.B._maxIndex=isc.C+5;isc.ClassFactory.defineClass("DatabaseBrowser","Window");isc.A=isc.DatabaseBrowser.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.orientation="vertical";isc.A.title="Database Browser";isc.A.width="90%";isc.A.height="90%";isc.A.isModal=true;isc.A.showModalMask=true;isc.A.canDragResize=true;isc.A.autoFetchData=true;isc.A.serverType="sql";isc.A.schemaTreeConstructor="ListGrid";isc.A.schemaTreeDefaults={autoParent:"schemaView",dbBrowser:this.creator,dataSource:isc.DataSource.create({addGlobalId:false,ID:"isc_dbBrowserSchemaTreeDS",clientOnly:true,fields:[{name:"name",title:"Name"},{name:"type",title:"Type",width:60,valueMap:["table","view"]}]}),showFilterEditor:true,filterOnKeypress:true,canExpandRecords:true,detailDefaults:{_constructor:"ListGrid",autoFitData:"vertical",autoFitMaxRecords:8,showResizeBar:true},getExpansionComponent:function(_1){var _2=this.createAutoChild("detail",{sortField:"primaryKey",sortDirection:"descending",defaultFields:[{name:"name",title:"Column",formatCellValue:function(_3,_1){if(_1.primaryKey)return"<b>"+_3+"</b>";return _3}},{name:"type",title:"Type",width:50},{name:"length",title:"Length",width:45},{name:"primaryKey",title:"PK",type:"boolean",showIf:"false",width:22}]});isc.DMI.call("isc_builtin","com.isomorphic.tools.BuiltinRPC","getFieldsFromTable",_1.name,this.schema,this.serverType,this.creator.dbName,function(_3,_4){_2.setData(_4)});return _2},selectionChanged:function(_1,_2){if(_2){var _3=_1.name;if(_3&&_3!=this.creator.$64p){this.creator.getDataSourceFromTable(_3);this.creator.populateDataViewHeader()}}}};isc.A.schemaRefreshButtonDefaults={_constructor:"Img",size:16,src:"[SKIN]/actions/refresh.png",click:"this.creator.getDatabaseTables()"};isc.A.databaseListConstructor="ListGrid";isc.A.databaseListDefaults={height:150,autoParent:"schemaView",dataSource:isc.DataSource.create({addGlobalId:false,ID:"isc_dbBrowserDBListDS",clientOnly:true,fields:[{name:"dbName",title:"Name"},{name:"dbStatus",title:"Status"},{name:"dbProductName",title:"Product Name"},{name:"dbProductVersion",title:"Product Version"}]}),defaultFields:[{name:"dbName"},{name:"dbStatus"}],sortField:"dbName",showFilterEditor:true,filterOnKeypress:true,canDragSelectText:true,selectionChanged:function(_1,_2){if(_2){this.creator.clearSchemaTree();this.creator.dbName=_1.dbName;this.creator.getDatabaseTables()}},canHover:true,cellHoverHTML:function(_1){if(!this.hoverDV)this.hoverDV=isc.DetailViewer.create({dataSource:this.dataSource,width:200,autoDraw:false});this.hoverDV.setData(_1);return this.hoverDV.getInnerHTML()}};isc.A.dbListConfigButtonDefaults={_constructor:"Img",size:16,src:"database_gear.png",click:"this.creator.configureDatabases()"};isc.A.dbListRefreshButtonDefaults={_constructor:"Img",size:16,src:"[SKIN]/actions/refresh.png",click:"this.creator.getDefinedDatabases()"};isc.A.dataGridConstructor="ListGrid";isc.A.dataGridDefaults={canDragSelectText:true,showFilterEditor:true,autoFitFieldWidths:true,autoFitWidthApproach:"title",autoParent:"dataView"};isc.A.showSelectButton=true;isc.A.selectButtonConstructor="Button";isc.A.selectButtonDefaults={title:"Next >",enabled:false,autoParent:"outerLayout"};isc.A.outerLayoutDefaults={_constructor:isc.VLayout,width:"100%",height:"100%",autoSize:true,autoDraw:true,autoParent:"body"};isc.A.innerLayoutDefaults={_constructor:isc.HLayout,width:"100%",height:"100%",autoDraw:true,autoParent:"outerLayout"};isc.A.showSchemaView=true;isc.A.schemaViewDefaults={_constructor:isc.SectionStack,visibilityMode:"multiple",autoParent:"innerLayout"};isc.A.showDataView=true;isc.A.dataViewDefaults={_constructor:isc.SectionStack,width:"65%",height:"100%",autoParent:"innerLayout"};isc.B.push(isc.A.configureDatabases=function isc_DatabaseBrowser_configureDatabases(){var _1=this;var _2=isc.DBConfigurator.showWindow({width:this.getVisibleWidth()-50,height:this.getVisibleHeight()-50,autoCenter:true,isModal:true,closeClick:function(){this.destroy();_1.getDefinedDatabases()}})});isc.B._maxIndex=isc.C+1;isc.A=isc.DatabaseBrowser.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.initWidget=function isc_DatabaseBrowser_initWidget(){this.Super("initWidget",arguments);this.title="Database Browser - "+this.serverType.toUpperCase();this.createChildren()},isc.A.createChildren=function isc_DatabaseBrowser_createChildren(){this.Super("createChildren");this.body.hPolicy="fill";this.body.vPolicy="fill";this.addAutoChild("outerLayout");this.addAutoChild("innerLayout",null,null,this.outerLayout);this.addAutoChild("schemaView",{showResizeBar:this.showDataView},null,this.innerLayout);this.databaseList=this.createAutoChild("databaseList");this.dbListConfigButton=this.createAutoChild("dbListConfigButton");this.dbListRefreshButton=this.createAutoChild("dbListRefreshButton");if(this.serverType=="sql"){this.schemaView.addSection({title:"Databases",showHeader:true,expanded:true,hidden:false,items:[this.databaseList],controls:[this.dbListConfigButton,this.dbListRefreshButton]})}
this.addAutoChild("dataView",null,null,this.innerLayout);this.dataView.addSection({autoDraw:true,showHeader:true,expanded:true,hidden:false});this.dataStack=this.dataView.sections[0];this.schemaTree=this.createAutoChild("schemaTree");this.schemaRefreshButton=this.createAutoChild("schemaRefreshButton");this.schemaView.addSection({title:"Tables & Views",showHeader:true,expanded:true,hidden:false,items:[this.schemaTree],controls:[this.schemaRefreshButton]});var _1=this;this.dataGrid=this.createAutoChild("dataGrid");this.dataStack.addItem(this.dataGrid);this.outerLayout.addMember(isc.LayoutSpacer.create({height:"10"}));this.addAutoChild("selectButton",{click:function(){_1.hide();_1.$64q.defaults=_1.getGeneratedDataSourceObject();_1.fireCallback(_1.$64r,"node",[_1.$64q])}},null,this.outerLayout);if(this.autoFetchData){this.delayCall("getDefinedDatabases")}},isc.A.getDefinedDatabases=function isc_DatabaseBrowser_getDefinedDatabases(){if(this.serverType=="hibernate"){this.databaseList.hide();this.dbName=null;this.getDatabaseTables()}else{isc.DMI.call({appID:"isc_builtin",className:"com.isomorphic.tools.AdminConsole",methodName:"getDefinedDatabases",arguments:[true],callback:this.getID()+".populateDatabaseList(data)",requestParams:{showPrompt:true,promptStyle:"dialog",prompt:"Loading available databases..."}})}},isc.A.getDatabaseTables=function isc_DatabaseBrowser_getDatabaseTables(){var _1=this;var _2=this.includeSubstring;if(_2&&!isc.isAn.Array(_2))_2=[_2];var _3=this.excludeSubstring;if(_3&&!isc.isAn.Array(_3))_3=[_3];isc.DMI.call({appID:"isc_builtin",className:"com.isomorphic.tools.BuiltinRPC",methodName:"getTables",arguments:[this.serverType,this.dbName,true,true,this.catalog,this.schema,_2,_3],callback:function(_4){_1.populateSchemaTree(_4.data)},requestParams:{showPrompt:true,promptStyle:"dialog",prompt:"Loading schema..."}})},isc.A.populateDatabaseList=function isc_DatabaseBrowser_populateDatabaseList(_1){this.databaseList.dataSource.setCacheData(_1);var _2={dbStatus:"OK"};this.databaseList.invalidateCache();this.databaseList.setFilterEditorCriteria(_2);this.databaseList.filterData(_2)},isc.A.clearSchemaTree=function isc_DatabaseBrowser_clearSchemaTree(_1){this.schemaTree.setData([]);this.$64p=null;this.populateDataViewHeader()},isc.A.populateSchemaTree=function isc_DatabaseBrowser_populateSchemaTree(_1){for(var i=0;i<_1.length;i++){_1[i].name=_1[i].TABLE_NAME;_1[i].type=_1[i].TABLE_TYPE.toLowerCase();_1[i].isFolder=true;_1[i].customIcon="[SKIN]../DatabaseBrowser/data.png"}
this.schemaTree.dataSource.setCacheData(_1);this.schemaTree.invalidateCache();this.schemaTree.filterData();if(this.schemaTreeTitle){this.populateSchemaTreeHeader()}
this.tablesRetrieved=true},isc.A.populateSchemaTreeHeader=function isc_DatabaseBrowser_populateSchemaTreeHeader(){},isc.A.populateDataViewHeader=function isc_DatabaseBrowser_populateDataViewHeader(){if(this.$64p){this.dataGridTitle="Data from table "+this.$64p;this.dataGrid.setShowHeader(true)}else{this.dataGridTitle="No table selected";this.dataGrid.setDataSource(null);this.dataGrid.setFields([{name:"placeholder",title:" "}])}
this.dataStack.setTitle(this.dataGridTitle)},isc.A.getDataSourceFromTable=function(tableName){var dbBrowser=this;var shouldQuoteTableName=!/^[A-Za-z][0-9A-Za-z_]*$/.test(tableName);dbBrowser.$64p=tableName;if(dbBrowser.selectButton)dbBrowser.selectButton.setDisabled(false);isc.DMI.call("isc_builtin","com.isomorphic.tools.BuiltinRPC","getDataSourceJSONFromTable",tableName,this.serverType,this.dbName,tableName+"_dbBrowser",{quoteTableName:shouldQuoteTableName},function(rpcResponse,data){var temp="dbBrowser.generatedDataSourceObject = "+data;eval(temp);var gdsoFields=dbBrowser.generatedDataSourceObject.fields,originalFieldsCopy=[];for(var i=0;i<gdsoFields.length;i++){originalFieldsCopy[i]=isc.addProperties({},gdsoFields[i])}
isc.addProperties(dbBrowser.generatedDataSourceObject,{tableName:tableName,quoteTableName:shouldQuoteTableName,dbName:dbBrowser.dbName});dbBrowser.generatedDataSource=isc.DataSource.create(dbBrowser.generatedDataSourceObject);dbBrowser.generatedDataSourceObject.fields=originalFieldsCopy;if(dbBrowser.showDataView){dbBrowser.dataGrid.setDataSource(dbBrowser.generatedDataSource);dbBrowser.dataGrid.fetchData()}})},isc.A.getGeneratedDataSource=function isc_DatabaseBrowser_getGeneratedDataSource(){return this.generatedDataSource},isc.A.getGeneratedDataSourceObject=function isc_DatabaseBrowser_getGeneratedDataSourceObject(){return this.generatedDataSourceObject},isc.A.getResults=function isc_DatabaseBrowser_getResults(_1,_2,_3){this.$64r=_2;this.$64q=_1});isc.B._maxIndex=isc.C+13;isc.ClassFactory.defineClass("HibernateBrowser","Window");isc.A=isc.HibernateBrowser.getPrototype();isc.A.orientation="vertical";isc.A.width="90%";isc.A.height="90%";isc.A.isModal=true;isc.A.showModalMask=true;isc.A.canDragResize=true;isc.A.showMappingTree=true;isc.A.mappingTreeConstructor="TreeGrid";isc.A.mappingTreeDefaults={autoParent:"mappingView",showConnectors:true,showOpenIcons:false,showDropIcons:false,customIconProperty:"customIcon",fields:[{name:"name",title:"Name",width:"60%",showHover:true},{name:"type",title:"Type"},{name:"primaryKey",title:"PK",type:"boolean",width:"10%"},{name:"length",title:"Length",type:"number"}],selectionChanged:function(_1,_2){if(_2){var _3=this.data.getLevel(_1)==1?_1.name:this.data.getParent(_1).name;if(_3&&_3!=this.creator.$64t){this.creator.getDataSourceFromMapping(_3);this.creator.populateDataViewHeader()}}},openFolder:function(_1){if(this.data.getLevel(_1)>1){return this.Super("openFolder",arguments)}
this.Super("openFolder",arguments);var _2=this;var _3=_1.name;isc.DMI.call("isc_builtin","com.isomorphic.tools.BuiltinRPC","getBeanFields",_3,function(_4){_2.populateFields(_1,_4.data)})},getValueIcon:function(_1,_2,_3){if(_3.type=="entity"){return null}else{return this.Super("getValueIcon",arguments)}},populateFields:function(_1,_2){var _3=isc.clone(_2)
_1.children=[];for(var i=0;i<_3.length;i++){_3[i].children=[];_3[i].customIcon="[SKIN]../DatabaseBrowser/column.png"}
this.data.addList(_3,_1)}};isc.A.dataGridConstructor="ListGrid";isc.A.dataGridDefaults={};isc.A.title="Hibernate Browser";isc.A.showSelectButton=true;isc.A.selectButtonConstructor="Button";isc.A.selectButtonDefaults={title:"Next >",enabled:false,autoParent:"outerLayout"};isc.A.outerLayoutDefaults={_constructor:isc.VLayout,width:"100%",height:"100%",autoSize:true,autoDraw:true,autoParent:"body"};isc.A.innerLayoutDefaults={_constructor:isc.HLayout,width:"100%",height:"100%",autoDraw:true,autoParent:"outerLayout"};isc.A.showMappingView=true;isc.A.mappingViewDefaults={_constructor:isc.SectionStack,autoParent:"innerLayout"};isc.A.showDataView=true;isc.A.dataViewDefaults={_constructor:isc.SectionStack,width:"65%",height:"100%",autoParent:"innerLayout"};isc.A=isc.HibernateBrowser.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.initWidget=function isc_HibernateBrowser_initWidget(){this.Super("initWidget",arguments);this.createChildren()},isc.A.createChildren=function isc_HibernateBrowser_createChildren(){this.Super("createChildren");this.body.hPolicy="fill";this.body.vPolicy="fill";var _1=this;this.addAutoChild("outerLayout");this.addAutoChild("innerLayout",null,null,this.outerLayout);this.addAutoChild("mappingView",{showResizeBar:this.showDataView,title:"Hibernate Mappings"},null,this.innerLayout);this.mappingView.addSection({autoDraw:true,showHeader:true,expanded:true,hidden:false,title:"Hibernate Mappings"});this.mappingStack=this.mappingView.sections[0];this.addAutoChild("dataView",null,null,this.innerLayout);this.dataView.addSection({autoDraw:true,showHeader:true,expanded:true,hidden:false});this.dataStack=this.dataView.sections[0];this.mappingTree=this.createAutoChild("mappingTree");this.mappingStack.addItem(this.mappingTree);var _2=this.includeSubstring;if(_2&&!isc.isAn.Array(_2))_2=[_2];var _3=this.excludeSubstring;if(_3&&!isc.isAn.Array(_3))_3=[_3];isc.DMI.call("isc_builtin","com.isomorphic.tools.BuiltinRPC","getHibernateBeans",_2,_3,true,function(_4){_1.populateMappingTree(_4.data)});this.dataGrid=this.createAutoChild("dataGrid");this.dataStack.addItem(this.dataGrid);this.outerLayout.addMember(isc.LayoutSpacer.create({height:"10"}));this.addAutoChild("selectButton",{click:function(){_1.hide();_1.$64q.defaults=_1.getGeneratedDataSourceObject();_1.fireCallback(_1.$64r,"node",[_1.$64q])}},null,this.outerLayout)},isc.A.populateMappingTree=function isc_HibernateBrowser_populateMappingTree(_1){for(var i=0;i<_1.length;i++){_1[i].name=_1[i].entityName;_1[i].type="entity";_1[i].isFolder=true;_1[i].customIcon="[SKIN]../DatabaseBrowser/data.png"}
this.mappingTree.setData(isc.Tree.create({modelType:"children",root:{children:_1}}));if(_1.length==0){this.populateMappingTreeHeader("No Hibernate entities configured")}
this.tablesRetrieved=true},isc.A.populateMappingTreeHeader=function isc_HibernateBrowser_populateMappingTreeHeader(_1){this.mappingStack.setTitle(_1)},isc.A.populateDataViewHeader=function isc_HibernateBrowser_populateDataViewHeader(){this.dataGridTitle="Data from entity "+this.$64t;this.dataStack.setTitle(this.dataGridTitle)},isc.A.getDataSourceFromMapping=function(entityName){var hbBrowser=this;hbBrowser.$64t=entityName;hbBrowser.selectButton.setEnabled(true);isc.DMI.call("isc_builtin","com.isomorphic.tools.BuiltinRPC","getDataSourceJSONFromHibernateMapping",entityName,entityName+"-hibernateBrowser",function(rpcResponse,data){var temp="hbBrowser.generatedDataSourceObject = "+data;eval(temp);hbBrowser.generatedDataSource=isc.DataSource.create(hbBrowser.generatedDataSourceObject);if(hbBrowser.showDataView){hbBrowser.dataGrid.setDataSource(hbBrowser.generatedDataSource);hbBrowser.dataGrid.fetchData()}})},isc.A.getGeneratedDataSource=function isc_HibernateBrowser_getGeneratedDataSource(){return this.generatedDataSource},isc.A.getGeneratedDataSourceObject=function isc_HibernateBrowser_getGeneratedDataSourceObject(){return this.generatedDataSourceObject},isc.A.getResults=function isc_HibernateBrowser_getResults(_1,_2,_3){this.$64r=_2;this.$64q=_1});isc.B._maxIndex=isc.C+9;isc.defineClass("SelectionOutline","Class");isc.A=isc.SelectionOutline;isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.flashBorder="1px dashed white";isc.A.flashCount=7;isc.A.flashInterval=300;isc.A.showLabel=true;isc.A.labelSnapTo="TL";isc.A.labelSnapEdge="BL";isc.A.labelSnapOffset=-2;isc.A.labelOpacity=100;isc.A.$72t=18;isc.A.$72u=18;isc.A.$70s=-18;isc.A.$70t=0;isc.A.border="1px dashed #44ff44";isc.A.labelBackgroundColor="#44ff44";isc.B.push(isc.A.setBorder=function isc_c_SelectionOutline_setBorder(_1){this.border=_1},isc.A.getBorder=function isc_c_SelectionOutline_getBorder(){return this.border},isc.A.setLabelBackgroundColor=function isc_c_SelectionOutline_setLabelBackgroundColor(_1){this.labelBackgroundColor=_1},isc.A.getLabelBackgroundColor=function isc_c_SelectionOutline_getLabelBackgroundColor(){return this.labelBackgroundColor},isc.A.getSelectedState=function isc_c_SelectionOutline_getSelectedState(){var _1={border:this.getBorder(),labelBackgroundColor:this.getLabelBackgroundColor(),selectedObject:this.getSelectedObject(),showingDragHandle:this.$175x,showingLabel:this.$71w,label:this.$159y,resizeFrom:this.$124l};return _1},isc.A.setSelectedState=function isc_c_SelectionOutline_setSelectedState(_1){if(_1==null)return;this.setBorder(_1.border);this.setLabelBackgroundColor(_1.labelBackgroundColor);if(_1.selectedObject){this.select(this.selectedObject,false,_1.showingLabel,_1.label,_1.resizeFrom);if(_1.showingDragHandle)this.showDragHandle()}else{this.deselect()}},isc.A.select=function isc_c_SelectionOutline_select(_1,_2,_3,_4,_5){var _6=_1;if(isc.isA.String(_1))_6=window[_1];if(!isc.isA.Canvas(_6)&&!isc.isA.FormItem(_6)){this.logInfo("Cannot hilite "+_1+" - it is neither a Canvas nor a FormItem");return}
if(_3==null)_3=true;if(!_4&&(_3||(_3==null&&this.showLabel))){_4="<b>"+_6.toString()+"</b>"}
if(_6==this.$70d&&_4==this.$159y&&((_3&&this.$71w)||(!_3&&!this.$71w)))
{if(!this.$70z)this.showOutline();return}
this.logInfo("Selection changing from "+this.$70d+" to "+_6,"selectionOutline");this.deselect();if(!this.$70b){this.$70c(_6,_4,_3)}else{this.$70b.top.setBorder(this.border);this.$70b.left.setBorder(this.border);this.$70b.bottom.setBorder(this.border);this.$70b.right.setBorder(this.border)}
var _7=_6;if(isc.isA.FormItem(_6)){if(!this.$175y){this.$175y=isc.FormItemProxyCanvas.create()}
this.$175z=this.$175y;this.$175z.delayCall("setFormItem",[_6]);_7=this.$175z}
this.$70b.top.canDragResize=false;this.$70b.left.canDragResize=false;this.$70b.bottom.canDragResize=false;this.$70b.right.canDragResize=false;if(_5){if(!isc.isAn.Array(_5))_5=[_5];for(var i=0;i<_5.length;i++){var _9=_5[i],_10=null;if(_9=="T"){_10=this.$70b.top}else if(_9=="L"){_10=this.$70b.left}else if(_9=="B"){_10=this.$70b.bottom}else if(_9=="R"){_10=this.$70b.right}else{continue}
_10.dragTarget=_7;_10.canDragResize=true}
this.$124l=_5}
if(_3||(_3==null&&this.showLabel)){if(this.$70b.label==null){this.$70e()}else{this.$70b.label.setBackgroundColor(this.labelBackgroundColor)}
this.$70b.label.setContents(_4);this.$71w=true;this.$159y=_4}else{this.$70b.label=null;this.$71w=false;this.$159y=null}
this.$70d=_6;this.$175z=_7;this.$70f();this.delayCall("$70h",[],0);this.delayCall("showOutline",[],0);if(_6.moved){this.$f0.observe(_6,"moved","isc.Timer.setTimeout('isc.SelectionOutline.$70h()',0)")}
if(_7.parentMoved){this.$f0.observe(_7,"parentMoved","isc.Timer.setTimeout('isc.SelectionOutline.$70h()',0)")}
if(_7.resized){this.$f0.observe(_7,"resized","isc.Timer.setTimeout('isc.SelectionOutline.$71o()',0)")}
if(_7.dragResizeStart){this.$f0.observe(_7,"dragResizeStart","isc.SelectionOutline.resizeStart()")}
var _11=isc.isA.FormItem(_6)?_6.form:_6;while(_11){if(_11.scrolled){this.$f0.observe(_11,"scrolled","isc.SelectionOutline.$70h()")}
_11=_11.parentElement}
if(_6.hide){this.$f0.observe(_6,"hide","isc.SelectionOutline.hideOutline()")}
if(_6.destroy){this.$f0.observe(_6,"destroy","isc.SelectionOutline.hideOutline()")}
if(_7.$807){this.$f0.observe(_7,"$807","isc.SelectionOutline.visibilityChanged()")}
if(_2!=false)this.$70i()},isc.A.deselect=function isc_c_SelectionOutline_deselect(){this.hideOutline();if(this.$f0&&this.$70d){var _1=this.$175z||this.$70d;this.$f0.ignore(this.$70d,"moved");this.$f0.ignore(_1,"parentMoved");this.$f0.ignore(_1,"resized");this.$f0.ignore(_1,"dragResizeStart");this.$f0.ignore(_1,"dragMove");this.$f0.ignore(_1,"dragStop");this.$f0.ignore(this.$70d,"hide");this.$f0.ignore(this.$70d,"destroy");this.$f0.ignore(_1,"$807");var _2=isc.isA.FormItem(this.$70d)?this.$70d.form:this.$70d;while(_2){this.$f0.ignore(_2,"scrolled");_2=_2.parentElement}
this.$70b.top.canDragResize=false;this.$70b.left.canDragResize=false;this.$70b.bottom.canDragResize=false;this.$70b.right.canDragResize=false;if(this.$1367){isc.Page.clearEvent("keyPress",this.$1367);delete this.$1367}}
this.$70d=null;this.$175z=null},isc.A.getSelectedObject=function isc_c_SelectionOutline_getSelectedObject(){return this.$70d},isc.A.getSelectedObjectCanvas=function isc_c_SelectionOutline_getSelectedObjectCanvas(){return this.$175z},isc.A.$70c=function isc_c_SelectionOutline__createOutline(_1,_2,_3){var _4={autoDraw:false,overflow:"hidden",border:this.border,padding:0}
this.$70b={top:isc.Canvas.create(isc.addProperties(_4,{snapTo:"T",snapEdge:"B",width:"100%",height:2,canDragResize:false,resizeFrom:["T"]})),left:isc.Canvas.create(isc.addProperties(_4,{snapTo:"L",snapEdge:"R",width:2,height:"100%",canDragResize:false,resizeFrom:["L"]})),bottom:isc.Canvas.create(isc.addProperties(_4,{snapTo:"B",snapEdge:"T",width:"100%",height:2,canDragResize:false,resizeFrom:["B"]})),right:isc.Canvas.create(isc.addProperties(_4,{snapTo:"R",snapEdge:"L",width:2,height:"100%",canDragResize:false,resizeFrom:["R"]}))}
this.$f0=isc.Class.create()},isc.A.$70e=function isc_c_SelectionOutline__createLabel(){if(this.$70j){this.$70b.label=this.$70j;return}
this.$70j=this.$70b.label=isc.Label.create({autoDraw:true,top:-100,left:-100,autoFit:true,autoFitDirection:"both",padding:2,wrap:false,isMouseTransparent:true,backgroundColor:this.labelBackgroundColor,opacity:this.labelOpacity,snapTo:this.labelSnapTo,snapEdge:this.labelSnapEdge,snapOffsetTop:this.labelSnapOffset,mouseOver:function(){if(this.$701){isc.Timer.clear(this.$71a);isc.SelectionOutline.$70h();this.$701=false}else{var _1=this;this.$71b=isc.Timer.setTimeout(function(){_1.$71c()},300)}},mouseOut:function(){if(this.$71b){isc.Timer.clear(this.$71b);delete this.$71b}},$71c:function(){isc.Timer.clear(this.$71a);this.$701=true;this.animateMove(null,(this.getPageTop()+this.getVisibleHeight())-
isc.SelectionOutline.labelSnapOffset,null,200);this.$71a=isc.Timer.setTimeout(function(){isc.SelectionOutline.$70h();if(isc.SelectionOutline.$70b.label){isc.SelectionOutline.$70b.label.$701=false}},3000)}})},isc.A.$71o=function isc_c_SelectionOutline__resizeOutline(){this.logInfo("Resizing selected object "+this.$70d,"selectionOutline");this.$71p();this.resizeStop()},isc.A.$70h=function isc_c_SelectionOutline__moveOutline(){this.logInfo("Moving selected object "+this.$70d,"selectionOutline");this.$71p()},isc.A.$71p=function isc_c_SelectionOutline__refreshOutline(){if(!this.$70d||this.$70d.destroyed||this.$70d.destroying)return;this.$70b.top.resizeTo(this.$70d.getVisibleWidth(),this.$70b.top.height);this.$70b.bottom.resizeTo(this.$70d.getVisibleWidth(),this.$70b.bottom.height);this.$70b.left.resizeTo(this.$70b.left.width,this.$70d.getVisibleHeight());this.$70b.right.resizeTo(this.$70b.right.width,this.$70d.getVisibleHeight());var _1=isc.isA.Canvas(this.$70d);for(var _2 in this.$70b){var _3=this.$70b[_2];if(_3==null)continue;if(_1){isc.Canvas.snapToEdge(this.$70d,_3.snapTo,_3,_3.snapEdge,this.$70d)}else{isc.Canvas.snapToEdge(this.$70d.getPageRect(),_3.snapTo,_3,_3.snapEdge)}}
this.positionDragHandle()},isc.A.$70i=function isc_c_SelectionOutline__flashOutline(){var _1=[this.border,this.flashBorder];for(var i=0;i<this.flashCount;i++){isc.Timer.setTimeout({target:this,methodName:"$70k",args:[_1[i%2]]},(this.flashInterval*i))}},isc.A.$70f=function isc_c_SelectionOutline__resetOutline(){this.$70k(this.border)},isc.A.$70k=function isc_c_SelectionOutline__setOutline(_1){for(var _2 in this.$70b){if(_2=="label")continue;var _3=this.$70b[_2];_3.setBorder(_1)}},isc.A.resizeStart=function isc_c_SelectionOutline_resizeStart(){var _1=isc.SelectionOutline.getSelectedObject();if(_1&&_1.editProxy&&_1.editProxy.resizeStart)_1.editProxy.resizeStart()},isc.A.resizeStop=function isc_c_SelectionOutline_resizeStop(){var _1=isc.SelectionOutline.getSelectedObject();if(_1&&_1.editProxy&&_1.editProxy.resizeStart)_1.editProxy.resizeStop()},isc.A.hideOutline=function isc_c_SelectionOutline_hideOutline(){if(!this.$70b)return;for(var _1 in this.$70b){if(this.$70b[_1])this.$70b[_1].hide()}
this.$70z=false;this.hideDragHandle()},isc.A.showOutline=function isc_c_SelectionOutline_showOutline(){if(!this.$70b||!this.getSelectedObject())return;for(var _1 in this.$70b){if(this.$70b[_1])this.$70b[_1].show()}
this.$70z=true},isc.A.showDragHandle=function isc_c_SelectionOutline_showDragHandle(){var _1=this.getSelectedObject();if(!_1)return;if(!this.$70r){var _2=this;this.$70r=isc.Img.create({src:"[SKIN]/../../ToolSkin/images/controls/dragHandle.gif",prompt:"Grab here to drag component",width:this.$72u,height:this.$72t,cursor:"move",backgroundColor:"white",opacity:80,canDrag:true,canDrop:true,isMouseTransparent:true,mouseDown:function(){this.dragIconOffsetX=isc.EH.getX()-
isc.SelectionOutline.$1750.getPageLeft();this.dragIconOffsetY=isc.EH.getY()-
isc.SelectionOutline.$1750.getPageTop();_2.$53r=true;this.Super("mouseDown",arguments)},mouseUp:function(){_2.$53r=false}})}
if(!_1.editProxy){this.$70r.hide();return}
var _3=this.getSelectedObjectCanvas();if(!this.$1750||this.$1750!=_3){this.$70r.setProperties({dragTarget:_3});isc.Timer.setTimeout("isc.SelectionOutline.positionDragHandle()",0);this.$1750=_3;this.$f0.observe(this.$1750,"dragMove","isc.SelectionOutline.positionDragHandle(true)");this.$f0.observe(this.$1750,"dragStop","isc.SelectionOutline.$53r = false")}
if(!this.$1367){this.$1367=isc.Page.setEvent("keyPress",this)}
this.$70r.show();this.$175x=true},isc.A.positionDragHandle=function isc_c_SelectionOutline_positionDragHandle(_1){if(!this.$70r||!this.$175x||!this.$1750)return;var _2=this.$1750;if(_2.destroyed||_2.destroying){this.logWarn("target of dragHandle: "+isc.Log.echo(_2)+" is invalid: "+_2.destroyed?"already destroyed":"currently in destroy()");return}
var _3=_2.getVisibleHeight();if(_3<this.$72t*2){this.$70t=Math.round((_3-this.$70r.height)/2)-1}else{this.$70t=-1}
if(_2.isA("FormItemProxyCanvas")&&!this.$53r){_2.syncWithFormItemPosition()}
if(!_2)return;var _4=_2.getPageLeft()+this.$70s;if(_1){_4+=_2.getOffsetX()-this.$70r.dragIconOffsetX}
this.$70r.setPageLeft(_4);var _5=_2.getPageTop()+this.$70t;if(_1){_5+=_2.getOffsetY()-this.$70r.dragIconOffsetY}
this.$70r.setPageTop(_5);this.$70r.bringToFront()},isc.A.hideDragHandle=function isc_c_SelectionOutline_hideDragHandle(){if(this.$70r&&this.$175x){this.$70r.hide();if(this.$1367){isc.Page.clearEvent("keyPress",this.$1367);delete this.$1367}
this.$175x=false}},isc.A.hideProxyCanvas=function isc_c_SelectionOutline_hideProxyCanvas(){if(this.$70y)this.$70y.hide()},isc.A.visibilityChanged=function isc_c_SelectionOutline_visibilityChanged(){var _1=isc.SelectionOutline.getSelectedObject();if(!_1)return;if(_1.isVisible())isc.SelectionOutline.showOutline();else isc.SelectionOutline.hideOutline()},isc.A.pageKeyPress=function isc_c_SelectionOutline_pageKeyPress(_1,_2){var _3=isc.SelectionOutline.getSelectedObject();if(!_3||!_3.parentElement)return;var _4=_3.ns.EH.getFocusCanvas();if((isc.isA.DynamicForm&&isc.isA.DynamicForm(_4))||(isc.isA.GridRenderer&&isc.isA.GridRenderer(_4)&&_4.grid&&_4.grid.getEditRow()!=null)||(isc.isAn.ImgTab&&isc.isAn.ImgTab(_4))||(isc.isA.SimpleTabButton&&isc.isA.SimpleTabButton(_4)))
{return}
if(_3.ns.EH.clickMaskUp())return;var _5=isc.EH.getKeyEventCharacter();if(!isc.isA.AlphaNumericChar(_5)){var _6=_3.parentElement,_7=isc.EH.shiftKeyDown(),_8=(_7?1:_6.snapVGap),_9=(_7?1:_6.snapHGap),_10=[0,0],_11=isc.EH.getKey();switch(_11){case"Arrow_Up":_10=[0,_8*-1];break;case"Arrow_Down":_10=[0,_8];break;case"Arrow_Left":_10=[_9*-1,0];break;case"Arrow_Right":_10=[_9,0];break}
if(_10[0]!=0||_10[1]!=0){if(_3.snapTo){_3.setSnapOffsetLeft((_3.snapOffsetLeft||0)+_10[0]);_3.setSnapOffsetTop((_3.snapOffsetTop||0)+_10[1])}else{_3.moveBy(_10[0],_10[1])}}}});isc.B._maxIndex=isc.C+28;isc.ClassFactory.defineClass("Repo","Class");isc.A=isc.Repo.getPrototype();isc.A.idField="id";isc.A.viewNameField="viewName";isc.A.objectField="object";isc.A.objectFormat="js";isc.A=isc.Repo.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.init=function isc_Repo_init(){this.initDataSource()},isc.A.initDataSource=function isc_Repo_initDataSource(){if(this.dataSource&&!isc.isA.DataSource(this.dataSource))
this.dataSource=isc.DS.getDataSource(this.dataSource)},isc.A.destroy=function isc_Repo_destroy(){this.Super("destroy",arguments)},isc.A.loadObjects=function isc_Repo_loadObjects(_1,_2){},isc.A.loadObject=function isc_Repo_loadObject(_1,_2){},isc.A.saveObject=function isc_Repo_saveObject(_1,_2,_3){},isc.A.showLoadUI=function isc_Repo_showLoadUI(_1,_2){},isc.A.showSaveUI=function isc_Repo_showSaveUI(_1,_2,_3){},isc.A.isActive=function isc_Repo_isActive(){if(this.$481&&this.$481.isVisible())return true;if(this.$48w&&this.$48w.isVisible())return true;return false},isc.A.customFormatToJS=function isc_Repo_customFormatToJS(_1){return _1});isc.B._maxIndex=isc.C+10;isc.Repo.addClassProperties({})
isc.Repo.registerStringMethods({});isc.ClassFactory.defineClass("ViewRepo","Repo");isc.A=isc.ViewRepo.getPrototype();isc.A.dataSource="Filesystem";isc.A.idField="name";isc.A.viewNameField="name";isc.A.objectField="contents";isc.A.objectFormat="xml";isc.A=isc.ViewRepo.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.loadObjects=function isc_ViewRepo_loadObjects(_1,_2){this.initDataSource();var _3=this.dataSource,_4=this;_3.fetchData(_1?_1.criteria:null,function(_5){_4.loadObjectsReply(_5.data,_1,_2)})},isc.A.loadObjectsReply=function isc_ViewRepo_loadObjectsReply(_1,_2,_3){this.fireCallback(_3,"objects, context",[_1,_3])},isc.A.loadObject=function isc_ViewRepo_loadObject(_1,_2){this.initDataSource();var _3=this.dataSource,_4=this;_3.fetchData(_1?_1.criteria:null,function(_5){_4.loadObjectReply(_5.data,_1,_2)},{operationId:"loadFile"})},isc.A.loadObjectReply=function isc_ViewRepo_loadObjectReply(_1,_2,_3){var _4=isc.isAn.Array(_1)?_1[0]:_1,_5=_4[this.objectField];if(this.objectFormat=="custom"){_5=this.customFormatToJS(_5)}
_2[this.idField]=_2.fileName=_4[this.idField];_2[this.viewNameField]=_2.screenName=_4[this.viewNameField];if(_2.screenName.indexOf(".")>0)
_2.screenName=_2.screenName.substring(0,_2.screenName.indexOf("."));_2[this.objectField]=_5;_2.record=_4;this.fireCallback(_3,"contents,context",[_5,_2])},isc.A.createLoadDialog=function isc_ViewRepo_createLoadDialog(_1){var _2=isc.TLoadFileDialog.create({directoryListingProperties:{canEdit:false},title:"Load View",initialDir:_1.caller.workspacePath,rootDir:_1.caller.workspacePath,fileFilter:".xml$",actionStripControls:["spacer:10","pathLabel","previousFolderButton","spacer:10","upOneLevelButton","spacer:10","refreshButton","spacer:2"]});_2.show();_2.hide();return _2},isc.A.showLoadUI=function isc_ViewRepo_showLoadUI(_1,_2){var _3=this;if(!this.$481){this.$481=isc.TLoadFileDialog.create({directoryListingProperties:{canEdit:false},title:"Load View",initialDir:_1.caller.workspacePath,rootDir:_1.caller.workspacePath,fileFilter:".xml$",actionStripControls:["spacer:10","pathLabel","previousFolderButton","spacer:10","upOneLevelButton","spacer:10","refreshButton","spacer:2"],loadFile:function(_5){var _4=_5;if(_4.endsWith(".jsp")||_4.endsWith(".xml")){_4=_4.substring(0,_4.lastIndexOf("."))}
_3.loadObject(isc.addProperties({},this.$76a,{criteria:{path:this.currentDir+"/"+_5}}),this.$76b);this.hide()}})}else{this.$481.directoryListing.data.invalidateCache()}
this.$481.$76a=_1;this.$481.$76b=_2;this.$481.show()},isc.A.saveObject=function isc_ViewRepo_saveObject(_1,_2,_3){var _4=_2.fileName,_5=_4.lastIndexOf("."),_6=_1,_7=_2.caller;this.initDataSource();_6=_6.replaceAll("dataSource=\"ref:","dataSource=\"");if(_5!=null&&(_4.endsWith(".jsp")||_4.endsWith(".xml"))){_4=_4.substring(0,_5)}
var _8=_4.lastIndexOf("/");var _9=_8>=0?_4.substring(_8+1):_4,_10=_7.workspacePath+"/"+_9,_11=_10+".xml",_12=this.dataSource;_2.screenName=_9;_12.updateData({path:_11,contents:_6},null,{operationId:"saveFile",showPrompt:!_2.suppressPrompt});var _13='<%@ page contentType="text/html; charset=UTF-8"%>\n<%@ taglib uri="/WEB-INF/iscTaglib.xml" prefix="isomorphic" %>\n<HTML><HEAD><TITLE>'+_9+'</TITLE>\n<isomorphic:loadISC skin="'+_7.skin+'"'+(_7.modulesDir?'modulesDir="'+_7.modulesDir+'"':"")+(_2.additionalModules?(' includeModules="'+_2.additionalModules+'"'):"")+'/>\n </HEAD><BODY>\n';for(var i=0;i<_7.globalDependencies.deps.length;i++){var _15=_7.globalDependencies.deps[i];if(_15.type=="js"){_13+='<SCRIPT SRC='+(_15.url.startsWith("/")?_7.webRootRelWorkspace:_7.basePathRelWorkspace+"/")+_15.url+'></SCRIPT>\n'}
else
if(_15.type=="schema"){_13+='<SCRIPT>\n<isomorphic:loadDS name="'+_15.id+'"/></SCRIPT>\n'}
else
if(_15.type=="ui"){_13+='<SCRIPT>\n<isomorphic:loadUI name="'+_15.id+'"/></SCRIPT>\n'}
else
if(_15.type=="css"){_13+='<LINK REL="stylesheet" TYPE="text/css" HREF='+(_15.url.startsWith("/")?_7.webRootRelWorkspace:_7.basePathRelWorkspace+"/")+_15.url+'>\n'}}
_13+='<SCRIPT>\nisc.Page.setAppImgDir("'+_7.basePathRelWorkspace+'/graphics/");\n<isomorphic:XML>\n'+_6+'\n</isomorphic:XML></SCRIPT>\n</BODY></HTML>';_7.projectComponents.$48x=_9;var _16=_10+".jsp";_12.updateData({path:_16,contents:_13},function(){if(_3){isc.Class.fireCallback(_3,"success,context",[true,_2])}
if(_2.suppressPrompt)return;var _17=window.location.href;if(_17.indexOf("?")>0)_17=_17.substring(0,_17.indexOf("?"));_17=_17.substring(0,_17.lastIndexOf("/"));_17+=(_17.endsWith("/")?"":"/")+_7.workspaceURL+_9+".jsp";isc.say("Your screen can be accessed at:<P><a target=_blank href='"+_17+"'>"+_17+"</a>")},{operationId:"saveFile",showPrompt:!_2.suppressPrompt});if(_7.saveURL){isc.RPCManager.send(null,null,{actionURL:_7.saveURL,useSimpleHttp:true,showPrompt:!_2.suppressPrompt,params:{screen:_6}})}},isc.A.showSaveUI=function isc_ViewRepo_showSaveUI(_1,_2,_3){var _4=_2.caller,_5=this,_6=_1,_7=(_2.saveAs?"":_2.screenName),_8=_3;if(!this.$48w){this.$48w=isc.TSaveFileDialog.create({title:"Save View",fileFilter:".xml$",visibility:"hidden",actionStripControls:["spacer:10","pathLabel","previousFolderButton","spacer:10","upOneLevelButton","spacer:10","refreshButton","spacer:2"],directoryListingProperties:{canEdit:false},initialDir:_4.workspacePath,rootDir:_4.workspacePath,saveFile:function(_9){_5.saveObject(this.$76c,isc.addProperties(this.$76d,{fileName:_9}),this.$76e);this.hide()}})}
else{this.$48w.directoryListing.data.invalidateCache()}
this.$48w.$76c=_6;this.$48w.$76d=_2;this.$48w.$76e=_3;if(_7&&_7!=""){return this.$48w.saveFile(_7)}
this.$48w.show()});isc.B._maxIndex=isc.C+8;isc.ClassFactory.defineClass("DSViewRepo","Repo");isc.A=isc.DSViewRepo.getPrototype();isc.A.idField="id";isc.A.viewNameField="viewName";isc.A.objectField="object";isc.A=isc.DSViewRepo.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.loadObjects=function isc_DSViewRepo_loadObjects(_1,_2){if(!this.dataSource){this.logWarn("No dataSource available in "+this.getClassName()+".loadObjects");return}
this.initDataSource();var _3=this.dataSource,_4=this;_3.fetchData(_1.criteria,function(_5){_4.loadObjectsReply(_5.data,_1,_2)})},isc.A.loadObjectsReply=function isc_DSViewRepo_loadObjectsReply(_1,_2,_3){this.fireCallback(_3,"data, context",[_1,_2])},isc.A.loadObject=function isc_DSViewRepo_loadObject(_1,_2){if(!this.dataSource){this.logWarn("No dataSource available in "+this.getClassName()+".loadObject");return}
this.initDataSource();var _3=this,_4=this.dataSource;_4.fetchData(_1.criteria,function(_5){_3.loadObjectReply(_5.data,_1,_2)})},isc.A.loadObjectReply=function isc_DSViewRepo_loadObjectReply(_1,_2,_3){var _4=isc.isAn.Array(_1)?_1[0]:_1,_5=_4[this.objectField];if(this.objectFormat=="custom"){_5=this.customFormatToJS(_5)}
_2[this.idField]=_4[this.idField];_2[this.viewNameField]=_2.screenName=_4[this.viewNameField];_2[this.objectField]=_5;_2.record=_4;this.fireCallback(_3,"contents,context",[_5,_2])},isc.A.saveObject=function isc_DSViewRepo_saveObject(_1,_2,_3){if(!this.dataSource){this.logWarn("No dataSource available in "+this.getClassName()+".saveObject");return}
this.initDataSource();var _4=this,_5=this.dataSource;_1=_1.replaceAll("dataSource=\"ref:","dataSource=\"");var _6={};if(_2[this.idField])_6[this.idField]=_2[this.idField];_6[this.viewNameField]=_2[this.viewNameField];_6[this.objectField]=_1;if(!_6[this.idField]){_5.addData(_6,function(_7){_4.saveObjectReply(_7,_3,_2)})}else{_5.updateData(_6,function(_7){_4.saveObjectReply(_7,_3,_2)})}},isc.A.saveObjectReply=function isc_DSViewRepo_saveObjectReply(_1,_2,_3){if(_2)this.fireCallback(_2,"success",[true])},isc.A.showLoadUI=function isc_DSViewRepo_showLoadUI(_1,_2){var _3=this;if(!this.$481){this.$481=isc.TLoadFileDialog.create({showPreviousFolderButton:false,showUpOneLevelButton:false,showCreateNewFolderButton:false,actionFormProperties:{process:function(){if(this.validate())
this.creator.recordSelected(this.creator.directoryListing.$48r)}},directoryListingProperties:{canEdit:false,dataSource:this.dataSource,fields:[{name:_3.idField,width:0},{name:_3.viewNameField,width:"*"}],recordDoubleClick:function(_4,_5){if(_5.isFolder){this.creator.setDir(_5.path)}else{this.creator.recordSelected(_5)}
return false}},dataSource:this.dataSource,title:"Load View",fileFilter:".xml$",actionStripControls:["spacer:10","pathLabel","previousFolderButton","spacer:10","upOneLevelButton","spacer:10","refreshButton","spacer:2"],recordSelected:function(_4){this.$76a.criteria={record:_4};this.$76a.criteria[_3.idField]=_4[_3.idField];_3.loadObject(this.$76a,this.$76b);this.hide()}})}else{this.$481.directoryListing.data.invalidateCache()}
this.$481.$76a=_1;this.$481.$76b=_2;this.$481.show()},isc.A.showSaveUI=function isc_DSViewRepo_showSaveUI(_1,_2,_3){var _4=this;if(_2.screenName){this.saveObject(_1,_2,_3);return}
if(!this.$48w){this.$48w=isc.TSaveFileDialog.create({title:"Save File",actionButtonTitle:"Save",showPreviousFolderButton:false,showUpOneLevelButton:false,showCreateNewFolderButton:false,actionFormProperties:{process:function(){if(this.validate())
this.creator.recordSelected(this.creator.directoryListing.$48r)}},directoryListingProperties:{canEdit:false,dataSource:this.dataSource,fields:[{name:_4.idField,width:0},{name:_4.viewNameField,width:"*"}],recordDoubleClick:function(_5,_6){if(_6.isFolder){this.creator.setDir(_6.path)}else{this.creator.recordSelected(_6)}
return false}},dataSource:this.dataSource,title:"Load View",fileFilter:".xml$",actionStripControls:["spacer:10","pathLabel","previousFolderButton","spacer:10","upOneLevelButton","spacer:10","refreshButton","spacer:2"],recordSelected:function(_5){var _2=this.$76d;if(_5){_2.criteria[_4.idField]=_5[_4.idField];_2.record=_5;_2[_4.idField]=_5[_4.idField];_2[_4.viewNameField]=_5[_4.viewNameField]}else{_2[_4.viewNameField]=this.actionForm.getValue("fileName");_2[_4.idField]=null}
_4.saveObject(this.$76f,_2,this.$76e);this.hide()}})}else{this.$48w.directoryListing.data.invalidateCache()}
this.$48w.$76f=_1;this.$48w.$76d=_2;this.$48w.$76e=_3;this.$48w.show()});isc.B._maxIndex=isc.C+8;isc.ClassFactory.defineClass("DSRepo","Repo");isc.DSRepo.addProperties({})
isc.A=isc.DSRepo.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.loadObjects=function isc_DSRepo_loadObjects(_1,_2){var _3=this;if(!this.dataSource){isc.DMI.call({appID:"isc_builtin",className:"com.isomorphic.tools.BuiltinRPC",methodName:"getDefinedDataSources",args:[],callback:function(_4){_3.loadObjectsReply(_4.data,_1,_2)}})}else{this.initDataSource();this.dataSource.fetchData(_1?_1.criteria:null,function(_4){_3.loadObjectsReply(_4.data,_1,_2)})}},isc.A.loadObjectsReply=function isc_DSRepo_loadObjectsReply(_1,_2,_3){this.fireCallback(_3,"objects, context",[_1,_2])},isc.A.showLoadUI=function isc_DSRepo_showLoadUI(_1,_2){if(!this.$113e){this.$113e=isc.PickDataSourceDialog.create()}
var _3=this;this.loadObjects(null,function(_4){_3.$113e.callback=function(_5){if(!isc.isAn.Array(_5))_5=[_5];_3.fireCallback(_2,"records, context",[_5,_1])}
_3.$113e.setData(_4);_3.$113e.show()})});isc.B._maxIndex=isc.C+3;isc.ClassFactory.defineClass("PickDataSourceDialog","Window");isc.A=isc.PickDataSourceDialog.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.title="DataSource Picker";isc.A.autoCenter=true;isc.A.modal=true;isc.A.width=460;isc.A.height=300;isc.A.canDragResize=true;isc.A.bodyConstructor="VLayout";isc.A.dsListingDataSourceDefaults={_constructor:"DataSource",clientOnly:true,fields:[{name:"dsName",title:"ID",primaryKey:true},{name:"dsType",title:"Type",valueMap:{"sql":"SQL","hibernate":"Hibernate","jpa":"JPA 2.0","jpa1":"JPA 1.0","generic":"Generic","projectFile":"Project File"}}]};isc.A.dsListingDefaults={_constructor:"ListGrid",defaultFields:[{name:"dsName",width:"*"},{name:"dsType",width:150,filterOperator:"equals"}],emptyMessage:"Retrieving list of DataSources...",height:"*",selectionType:"multiple",canMultiSort:true,initialSort:[{property:"dsName",direction:"ascending"}],showFilterEditor:true,filterOnKeypress:true,fetchDelay:500,recordDoubleClick:function(_1,_2){this.creator.dataSourceSelected(_2);return false},selectionUpdated:function(_1){this.creator.pickButton.setDisabled(!_1)}};isc.A.pickButtonConstructor="Button";isc.A.pickButtonDefaults={title:"Select DataSource",width:150,layoutAlign:"right",height:30,margin:5,action:function(){this.creator.dataSourceSelected(this.creator.dsListing.getSelectedRecords())}};isc.B.push(isc.A.setData=function isc_PickDataSourceDialog_setData(_1){this.dsListing.emptyMessage="No DataSources found.";this.dsListingDataSource.setCacheData(_1);this.dsListing.fetchData(null,function(){this.creator.pickButton.setDisabled(true)})},isc.A.dataSourceSelected=function isc_PickDataSourceDialog_dataSourceSelected(_1){this.hide();this.fireCallback(this.callback,"record",[_1])},isc.A.initWidget=function isc_PickDataSourceDialog_initWidget(){this.Super("initWidget",arguments);this.dsListingDataSource=this.createAutoChild("dsListingDataSource");this.dsListing=this.createAutoChild("dsListing",{dataSource:this.dsListingDataSource});this.pickButton=this.createAutoChild("pickButton");this.addItems([this.dsListing,this.pickButton])});isc.B._maxIndex=isc.C+3;if(!isc.TScrollbar)isc.defineClass("TScrollbar","Scrollbar");if(!isc.TPropertySheet)isc.defineClass("TPropertySheet","PropertySheet");if(!isc.TSectionItem)isc.defineClass("TSectionItem","SectionItem");if(!isc.TSectionStack)isc.defineClass("TSectionStack","SectionStack");if(!isc.TSectionHeader)isc.defineClass("TSectionHeader","SectionHeader");if(!isc.TImgSectionHeader)isc.defineClass("TImgSectionHeader","ImgSectionHeader");if(!isc.TButton)isc.defineClass("TButton","StretchImgButton");if(!isc.TAutoFitButton)isc.defineClass("TAutoFitButton","TButton");if(!isc.TMenuButton)isc.defineClass("TMenuButton","MenuButton");if(!isc.TMenu)isc.defineClass("TMenu","Menu");if(!isc.TTabSet)isc.defineClass("TTabSet","TabSet")
if(!isc.TTreePalette)isc.defineClass("TTreePalette","TreePalette");if(!isc.TEditTree)isc.defineClass("TEditTree","EditTree");if(!isc.THTMLFlow)isc.defineClass("THTMLFlow","HTMLFlow");if(!isc.TComponentEditor)isc.defineClass('TComponentEditor','ComponentEditor');if(!isc.TDynamicForm)isc.defineClass('TDynamicForm','DynamicForm');if(!isc.TLayout)isc.defineClass('TLayout','Layout');if(!isc.TListPalette)isc.defineClass('TListPalette','ListPalette');if(!isc.TSaveFileDialog)isc.defineClass("TSaveFileDialog","SaveFileDialog");isc.defineClass("CriteriaItem","StaticTextItem");isc.A=isc.CriteriaItem.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width="*";isc.A.wrap=false;isc.A.clipValue=true;isc.A.emptyDisplayValue="[None]";isc.A.noDataSourceDisplayValue="[N/A]";isc.A.noDataSourceHoverText="Add a DataSource to enable criteria editing";isc.A.simplifySingleCriterion=true;isc.A.icons=[{src:"[SKINIMG]actions/edit.png",click:"item.editCriteria()"}];isc.A.filterBuilderConstructor=isc.FilterBuilder;isc.A.filterBuilderDefaults={showModeSwitcher:true};isc.A.windowConstructor=isc.Window;isc.A.windowDefaults={width:"80%",maxWidth:800,height:"50%",minHeight:300,maxHeight:800,canDragResize:true,autoCenter:true,isModal:true,showModalMask:true,title:"Define Criteria",bodyProperties:{layoutMargin:5,membersMargin:5}};isc.A.instructionsConstructor=isc.HTMLFlow;isc.A.instructionsDefaults={width:"100%",isGroup:true,groupTitle:"Instructions",padding:5,contents:"Define field by field criteria below"};isc.A.saveButtonText="Save";isc.A.clearButtonText="Clear";isc.B.push(isc.A.init=function isc_CriteriaItem_init(){this.Super("init",arguments);this.updateState();if(!this.dataSource)this.observe(this.form,"itemChanged")
if(!this.dataSource)this.observe(this.form,"valuesChanged")
if(!this.dataSource&&this.targetRuleScope){this.$171s=isc.Canvas.getAllRuleScopeDataSources(this.targetRuleScope)}},isc.A.formatValue=function isc_CriteriaItem_formatValue(_1,_2,_3,_4){var _5=this.getDataSource(),_6;if(!_5&&this.createRuleCriteria)_5=this.$171s;if(_1!=null&&!isc.isA.emptyObject(_1)){var _7=(this.form.currentComponent?this.form.currentComponent.liveObject:null);if(_7&&isc.isA.FormItem(_7))_7=_7.form;var _8=isc.DS.getAdvancedCriteriaDescription(_1,_5,_7);_6=(!_8||_8==""?null:_8)}
if(_6==null){if(!_5&&!this.createRuleCriteria)_6=this.noDataSourceDisplayValue;else _6=this.emptyDisplayValue}
return _6},isc.A.getDataSource=function isc_CriteriaItem_getDataSource(){var _1=this.dataSource;if(this.dataSource)return this.dataSource;if(!_1&&this.form){var _2=this.form.getValues();if(_2["dataSource"])_1=_2["dataSource"];else if(_2["optionDataSource"])_1=_2["optionDataSource"]}
if(_1&&isc.isA.String(_1))_1=isc.DS.get(_1);this.$16aa=_1;return _1},isc.A.destroy=function isc_CriteriaItem_destroy(){if(this.form){if(this.isObserving(this.form,"itemChanged"))this.ignore(this.form,"itemChanged");if(this.isObserving(this.form,"valuesChanged"))this.ignore(this.form,"valuesChanged")}
if(this.$171s){for(var i=0;i<this.$171s.length;i++){var _2=this.$171s[i];if(_2.criteriaBasePath){_2.destroy()}}}
this.Super("destroy",arguments)},isc.A.updateState=function isc_CriteriaItem_updateState(){var _1=this.$16aa,_2=this.getDataSource();if(_2||this.createRuleCriteria){this.enable()}else{this.disable()}
if(_2||this.createRuleCriteria)this.enable();else this.disable();if(_1!=null&&_2!=_1){this.storeValue(null,true)}
this.$16aa=_2},isc.A.itemChanged=function isc_CriteriaItem_itemChanged(){if(!this.destroyed)this.updateState()},isc.A.valuesChanged=function isc_CriteriaItem_valuesChanged(){if(!this.destroyed)this.updateState()},isc.A.itemHoverHTML=function isc_CriteriaItem_itemHoverHTML(_1,_2){return(!this.getDataSource()&&!this.createRuleCriteria?this.noDataSourceHoverText:this.getDisplayValue())},isc.A.editCriteria=function isc_CriteriaItem_editCriteria(){if(!this.window)this.createWindow();var _1=this.filterBuilder,_2=this.getValue();_1.setDataSource(this.getDataSource());_1.setCriteria(_2);_1.setTopOperatorAppearance(!_2||isc.DataSource.canFlattenCriteria(_2)?"radio":"bracket");this.window.show();_1.focus()},isc.A.editCriteriaReply=function isc_CriteriaItem_editCriteriaReply(_1){if(this.simplifySingleCriterion){if(_1&&_1.criteria&&_1.criteria.length==1){_1=_1.criteria[0]}}
if(_1&&_1.criteria&&_1.criteria.isEmpty())_1=null;this.storeValue(_1,true)},isc.A.createWindow=function isc_CriteriaItem_createWindow(){var _1=this.creator.currentComponent,_2=[];if(isc.isA.FormItem(_1.liveObject)){var _3=_1.liveObject.form,_4=_3.dataSource;if(isc.isA.String(_4))_4=isc.DataSource.get(_4);_2.add((_4?_4.getID()+".":_3.ID+".values.")+_1.name);_1=_3}
var _5=this,_6=this.createAutoChild("instructions"),_7={targetRuleScope:this.targetRuleScope,allowRuleScopeValues:this.allowRuleScopeValues,createRuleCriteria:this.createRuleCriteria,targetComponent:_1,$171s:this.$171s,excludedRuleScope:_2},_8=this.createAutoChild("filterBuilder",_7),_9=isc.IButton.create({title:this.saveButtonText,$179t:this,click:function(){var _12=_5.filterBuilder.getCriteria();_5.editCriteriaReply(_12);this.$179t.window.closeClick()}}),_10=isc.IButton.create({title:this.clearButtonText,click:function(){_5.filterBuilder.clearCriteria();var _12=_5.filterBuilder.getCriteria();_5.editCriteriaReply(_12)}}),_11=isc.HLayout.create({membersMargin:15,members:[_9,_10]});this.window=this.createAutoChild("window",{items:[_6,_8,_11]});this.filterBuilder=_8});isc.B._maxIndex=isc.C+11;isc.defineClass("FormulaEditorItem","StaticTextItem");isc.A=isc.FormulaEditorItem.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width="*";isc.A.wrap=false;isc.A.clipValue=true;isc.A.formulaVarsKey="formulaVars";isc.A.emptyDisplayValue="[None]";isc.A.icons=[{src:"[SKINIMG]actions/edit.png",click:"item.editFormula()"}];isc.A.editorWindowConstructor="Window";isc.A.editorWindowDefaults={title:"Formula Editor",height:400,width:"80%",maxWidth:750,showMinimizeButton:false,showMaximizeButton:false,autoDraw:true,isModal:true,showModalMask:true,overflow:"visible",autoCenter:true,canDragResize:true,bodyProperties:{overflow:"visible"},headerIconProperties:{padding:1,src:"[SKINIMG]ListGrid/formula_menuItem.png"},closeClick:function(){this.items.get(0).completeEditing(true)}};isc.A.formulaBuilderConstructor="FormulaBuilder";isc.A.formulaBuilderDefaults={showTitleField:false,showAutoHideCheckBox:false,helpWindowDefaults:{minWidth:475},helpTextIntro:"Building a Formula<P>The fields available when writing a formula are drawn from the widgets in your Component Tree, such as ListGrids and DynamicForms, and from the set of all DataSources linked to databound components in the Component Tree.  By looking under the 'source' column for a given field, you can see beforehand what will be inserted for you in the formula box if you click that row.<P></b>For example, suppose you want population density from the record: <b>{population:&nbsp;222000,&nbsp;area:&nbsp;200}</b>.<P>Your chosen formula might look like:<ul><li><b>ListGrid0.selectedRecord.population / ListGrid0.selectedRecord.area</b> if the record were the selected row of ListGrid0,<li><b>DynamicForm0.values.population / DynamicForm0.values.area</b> if the record were being edited by DynamicForm0, or<li><b>countryDS.population / countryDS.area</b> if the record were edited/selected in a databound component with DataSource CountryDS.</ul>All of the above formulae generate the same result, <b>1110</b>, when applied to the record.<P>Note that if databound components are present, the above rules imply there may be more than one way to refer to the same record.<P><b>For basic arithmetic, type in symbols (+-/%) directly.<P>The following functions are also available:",showSaveAddAnotherButton:false,allowBlankFormula:true,useMappingKeys:false,fireOnClose:function(){this.creator.userEditComplete(!this.cancelled)}};isc.A.formulaBuilderProperties={formulaFormProperties:{titleOrientation:"top",numCols:1}};isc.B.push(isc.A.destroy=function isc_FormulaEditorItem_destroy(){if(this.$171s){for(var i=0;i<this.$171s.length;i++){var _2=this.$171s[i];if(_2.criteriaBasePath){_2.destroy()}}}
this.Super("destroy",arguments)},isc.A.formatValue=function isc_FormulaEditorItem_formatValue(_1,_2,_3,_4){if(_1==null||_1.text==null){return this.emptyDisplayValue}
var _5=_1.text;if(!this.targetRuleScope){var _6=_1[this.formulaVarsKey],_7=isc.getKeys(_6).sort();for(var i=0;i<_7.length;i++){var _9=_7[i];_5=_5.replace(new RegExp(_9,'g'),_6[_9])}}
return _5},isc.A.getBuilderProperties=function isc_FormulaEditorItem_getBuilderProperties(){var _1={dataSource:this.form.creator.dataSource,dataSources:this.form.creator.dataSources,mathFunctions:isc.MathFunction.getDefaultFunctionNames()};if(this.targetRuleScope){_1.targetRuleScope=this.targetRuleScope;_1.localComponent=this.component;_1.sourceFieldColumnTitle="Field";_1.sourceDSColumnTitle="Source"}else{_1.component=this.component}
return _1},isc.A.editFormula=function isc_FormulaEditorItem_editFormula(){if(this.formulaBuilder==null){this.formulaBuilder=this.createAutoChild("formulaBuilder",this.getBuilderProperties());this.editorWindow=this.createAutoChild("editorWindow",{items:[this.formulaBuilder]})}
if(this.targetRuleScope&&this.getValue()!=null)this.formulaBuilder.setValue(this.getValue().text);else this.formulaBuilder.setValue("");this.editorWindow.show()},isc.A.userEditComplete=function isc_FormulaEditorItem_userEditComplete(_1){if(_1){var _2=this.formulaBuilder.getBasicValueObject(),_3,_4;if(_2!=null){_3=_2.text;_4=_2[this.formulaVarsKey]}
if(_3!=null){var _5={text:_3};if(_4!=null)_5[this.formulaVarsKey]=_4;this.storeValue(_5)}else{this.storeValue(null)}
this.redraw()}
this.editorWindow.clear()});isc.B._maxIndex=isc.C+5;isc.defineClass("SummaryEditorItem","FormulaEditorItem");isc.A=isc.SummaryEditorItem.getPrototype();isc.A.formulaVarsKey="summaryVars";isc.A.formulaBuilderConstructor="SummaryBuilder";isc.A.formulaBuilderDefaults={showTitleField:false,showAutoHideCheckBox:false,showSaveAddAnotherButton:false,builderTypeText:"Formula",helpWindowDefaults:{minWidth:475},helpTextIntro:"Building a Summary",getHoverText:function(){var _1=isc.SB.create();_1.append("<b>",this.helpTextIntro,"</b> <P>");_1.append("<b>A summary combines dynamic values taken from available fields with static text specified by the user.  A dynamic value is specified by wrapping an available field source with #&zwj;{ }, while everything else is copied directly into the output.<P>The available fields are drawn from the widgets in your Component Tree, such as ListGrids and DynamicForms, and from the set of all DataSources linked to databound components in the Component Tree.  By looking under the 'source' column for a given field, you can see beforehand what will be inserted for you in the formula box if you click that row.<P></b>");_1.append("For example, suppose you want a summary describing the diet of an animal for the record: <b>{commonName:&nbsp;'Alligator',&nbsp;diet:&nbsp;'Carnivore'}</b>.<P>Your chosen summary might look like:<ul>");_1.append("<li>'<b>The #&zwj;{ListGrid0.selectedRecord.commonName} is a(n) #&zwj;{ListGrid0.selectedRecord.diet}</b>' if the record were the selected row of ListGrid0,<li>'<b>The #&zwj;{DynamicForm0.values.commonName} is a(n) #&zwj;{DynamicForm0.values.diet}</b>' if the record were being edited by DynamicForm0, or<li>'<b>The #&zwj;{animals.commonName} is a(n) #&zwj;{animals.diet}</b>' if the record were edited/selected in a databound component with DataSource animals.</ul>");_1.append("All of the above summaries generate the same result, '<b>The Alligator is a(n) Carnivore</b>', when applied to the record.<P>Note that if databound components are present, the above rules imply there may be more than one way to refer to the same record.");return _1.release(false)},allowBlankFormula:true,insertEscapedKeys:true,useMappingKeys:false,fireOnClose:function(){this.creator.userEditComplete(!this.cancelled)}};isc.A.formulaBuilderProperties={formulaFormProperties:{titleOrientation:"top",numCols:1}};isc.defineClass("ExpressionEditorItem","FormulaEditorItem");isc.A=isc.ExpressionEditorItem.getPrototype();isc.A.formulaVarsKey="summaryVars";isc.A.formulaBuilderDefaults={showTitleField:false,showAutoHideCheckBox:false,showSaveAddAnotherButton:false,builderTypeText:"Formula",allowBlankFormula:true,insertEscapedKeys:true,useMappingKeys:false,fireOnClose:function(){this.creator.userEditComplete(!this.cancelled)}};isc.ExpressionEditorItem.changeDefaults("formulaBuilderDefaults",{supportedFieldTypes:["integer","float","date"]});isc.defineClass("DynamicPropertyEditorItem","TextItem");isc.A=isc.DynamicPropertyEditorItem.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.width="*";isc.A.wrap=false;isc.A.clipValue=true;isc.A.formulaVarsKey="formulaVars";isc.A.summaryVarsKey="summaryVars";isc.A.cancelButtonTitle="Cancel";isc.A.saveButtonTitle="Save";isc.A.icons=[{src:"[SKINIMG]actions/dynamic.png",click:"item.editProperty()"}];isc.A.editorWindowConstructor="Window";isc.A.editorWindowDefaults={ID:"dynPropEditorWindow",title:"Dynamic Property Editor",height:400,width:"80%",maxWidth:750,showMinimizeButton:false,showMaximizeButton:false,autoDraw:true,isModal:true,showModalMask:true,overflow:"visible",autoCenter:true,canDragResize:true,isRuleScope:true,bodyProperties:{overflow:"visible"},headerIconProperties:{padding:1,src:"[SKINIMG]actions/dynamic.png"},closeClick:function(){this.creator.closeWindow()}};isc.A.typeSelectorFormConstructor="DynamicForm";isc.A.typeSelectorFormDefaults={ID:"dynPropTypeSelector",width:"100%",numCols:2,fields:[{name:"type",type:"radioGroup",showTitle:false,vertical:false,endRow:true,colSpan:2,redrawOnChange:true,valueMap:["DataPath","Formula","Text Formula"]},{name:"dataPath",type:"text",title:"DataPath",showIf:"form.getValue('type') == 'DataPath'"}]};isc.A.formulaBuilderConstructor="FormulaBuilder";isc.A.formulaBuilderDefaults={showTitleField:false,showAutoHideCheckBox:false,helpWindowDefaults:{minWidth:475},helpTextIntro:"Building a Formula<P>The fields available when writing a formula are drawn from the widgets in your Component Tree, such as ListGrids and DynamicForms, and from the set of all DataSources linked to databound components in the Component Tree.  By looking under the 'source' column for a given field, you can see beforehand what will be inserted for you in the formula box if you click that row.<P></b>For example, suppose you want population density from the record: <b>{population:&nbsp;222000,&nbsp;area:&nbsp;200}</b>.<P>Your chosen formula might look like:<ul><li><b>ListGrid0.selectedRecord.population / ListGrid0.selectedRecord.area</b> if the record were the selected row of ListGrid0,<li><b>DynamicForm0.values.population / DynamicForm0.values.area</b> if the record were being edited by DynamicForm0, or<li><b>countryDS.population / countryDS.area</b> if the record were edited/selected in a databound component with DataSource CountryDS.</ul>All of the above formulae generate the same result, <b>1110</b>, when applied to the record.<P>Note that if databound components are present, the above rules imply there may be more than one way to refer to the same record.<P><b>For basic arithmetic, type in symbols (+-/%) directly.<P>The following functions are also available:",showButtonLayout:false,allowBlankFormula:true,useMappingKeys:false,visibleWhen:{_constructor:"AdvancedCriteria",operator:"and",criteria:[{fieldName:"dynPropTypeSelector.values.type",operator:"equals",value:"Formula"}]}};isc.A.formulaBuilderProperties={formulaFormProperties:{titleOrientation:"top",numCols:1}};isc.A.summaryVarsKey="summaryVars";isc.A.summaryBuilderConstructor="SummaryBuilder";isc.A.summaryBuilderDefaults={showTitleField:false,showAutoHideCheckBox:false,showSaveAddAnotherButton:false,builderTypeText:"Formula",helpWindowDefaults:{minWidth:475},helpTextIntro:"Building a Summary",getHoverText:function(){var _1=isc.SB.create();_1.append("<b>",this.helpTextIntro,"</b> <P>");_1.append("<b>A summary combines dynamic values taken from available fields with static text specified by the user.  A dynamic value is specified by wrapping an available field source with #&zwj;{ }, while everything else is copied directly into the output.<P>The available fields are drawn from the widgets in your Component Tree, such as ListGrids and DynamicForms, and from the set of all DataSources linked to databound components in the Component Tree.  By looking under the 'source' column for a given field, you can see beforehand what will be inserted for you in the formula box if you click that row.<P></b>");_1.append("For example, suppose you want a summary describing the diet of an animal for the record: <b>{commonName:&nbsp;'Alligator',&nbsp;diet:&nbsp;'Carnivore'}</b>.<P>Your chosen summary might look like:<ul>");_1.append("<li>'<b>The #&zwj;{ListGrid0.selectedRecord.commonName} is a(n) #&zwj;{ListGrid0.selectedRecord.diet}</b>' if the record were the selected row of ListGrid0,<li>'<b>The #&zwj;{DynamicForm0.values.commonName} is a(n) #&zwj;{DynamicForm0.values.diet}</b>' if the record were being edited by DynamicForm0, or<li>'<b>The #&zwj;{animals.commonName} is a(n) #&zwj;{animals.diet}</b>' if the record were edited/selected in a databound component with DataSource animals.</ul>");_1.append("All of the above summaries generate the same result, '<b>The Alligator is a(n) Carnivore</b>', when applied to the record.<P>Note that if databound components are present, the above rules imply there may be more than one way to refer to the same record.");return _1.release(false)},showButtonLayout:false,allowBlankFormula:true,insertEscapedKeys:true,useMappingKeys:false,visibleWhen:{_constructor:"AdvancedCriteria",operator:"and",criteria:[{fieldName:"dynPropTypeSelector.values.type",operator:"equals",value:"Text Formula"}]}};isc.A.summaryBuilderProperties={formulaFormProperties:{titleOrientation:"top",numCols:1}};isc.A.buttonLayoutDefaults={_constructor:"HLayout",width:"100%",height:20,layoutMargin:20,align:"right"};isc.A.cancelButtonDefaults={_constructor:"IButton",autoParent:"buttonLayout",autoFit:true,extraSpace:10,click:function(){this.creator.closeWindow(true)}};isc.A.saveButtonDefaults={_constructor:"IButton",autoParent:"buttonLayout",autoFit:true,click:function(){this.creator.closeWindow()}};isc.B.push(isc.A.destroy=function isc_DynamicPropertyEditorItem_destroy(){if(this.$171s){for(var i=0;i<this.$171s.length;i++){var _2=this.$171s[i];if(_2.criteriaBasePath){_2.destroy()}}}
this.Super("destroy",arguments)},isc.A.formatEditorValue=function isc_DynamicPropertyEditorItem_formatEditorValue(_1,_2,_3,_4){var _5;if(_1&&isc.isA.DynamicProperty(_1)){_5=_1.dataPath||_1}else{_5=(_3&&_3.currentComponent&&_3.currentComponent.liveObject.getDynamicProperty?_3.currentComponent.liveObject.getDynamicProperty(_4.name):null)}
if(_5!=null){if(isc.isA.String(_5)){return"[DataPath: \""+_5+"\"]"}
var _6=_5.formula||_5.textFormula,_7=_6.text;if(!this.targetRuleScope){var _8=(_5.formula?this.formulaVarsKey:this.summaryVarsKey),_9=_6[_8],_10=isc.getKeys(_9).sort();for(var i=0;i<_10.length;i++){var _12=_10[i];_7=_7.replace(new RegExp(_12,'g'),_9[_12])}}
return"["+(_5.textFormula?"Text ":"")+"Formula: \""+_7+"\"]"}
return _1},isc.A.getBuilderProperties=function isc_DynamicPropertyEditorItem_getBuilderProperties(){var _1={dataSource:this.form.creator.dataSource,dataSources:this.form.creator.dataSources,mathFunctions:isc.MathFunction.getDefaultFunctionNames()};if(this.targetRuleScope){_1.targetRuleScope=this.targetRuleScope;_1.localComponent=this.component;_1.sourceFieldColumnTitle="Field";_1.sourceDSColumnTitle="Source"}else{_1.component=this.component}
return _1},isc.A.editProperty=function isc_DynamicPropertyEditorItem_editProperty(){delete this.$192g;if(this.typeSelectorForm==null){this.typeSelectorForm=this.createAutoChild("typeSelectorForm");this.formulaBuilder=this.createAutoChild("formulaBuilder",this.getBuilderProperties());this.summaryBuilder=this.createAutoChild("summaryBuilder",this.getBuilderProperties());this.addAutoChild("buttonLayout");this.addAutoChild("cancelButton",{title:this.cancelButtonTitle});this.addAutoChild("saveButton",{title:this.saveButtonTitle});this.editorWindow=this.createAutoChild("editorWindow",{items:[this.typeSelectorForm,this.formulaBuilder,this.summaryBuilder,this.buttonLayout]})}
this.formulaBuilder.setValue("");this.summaryBuilder.setValue("");var _1=this.form;var _2=(_1&&_1.currentComponent&&_1.currentComponent.liveObject.getDynamicProperty?_1.currentComponent.liveObject.getDynamicProperty(this.name):null);if(!_2){this.typeSelectorForm.setValues({type:"DataPath",dataPath:""})}else{if(isc.isA.String(_2)){this.typeSelectorForm.setValues({type:"DataPath",dataPath:_2})}else if(_2.text&&_2.formulaVars){this.typeSelectorForm.setValues({type:"Formula"});if(this.targetRuleScope)this.formulaBuilder.setValue(_2)}else if(_2.text){this.typeSelectorForm.setValues({type:"Text Formula"});if(this.targetRuleScope)this.summaryBuilder.setValue(_2.text)}else{this.typeSelectorForm.setValues({type:"DataPath",dataPath:""})}}
this.editorWindow.show()},isc.A.closeWindow=function isc_DynamicPropertyEditorItem_closeWindow(_1){if(!_1){var _2=this.typeSelectorForm.getValue("type");if(_2=="DataPath"){var _3=this.typeSelectorForm.getValue("dataPath"),_4=isc.DynamicProperty.create({name:this.name,dataPath:_3});this.storeValue(_4)}else if(_2=="Formula"){var _5=this.getFormula(this.formulaBuilder,this.formulaVarsKey),_4=isc.DynamicProperty.create({name:this.name,formula:_5});this.storeValue(_4)}else if(_2=="Text Formula"){var _5=this.getFormula(this.summaryBuilder,this.summaryVarsKey),_4=isc.DynamicProperty.create({name:this.name,textFormula:_5});this.storeValue(_4)}
this.redraw()}
this.editorWindow.clear()},isc.A.getFormula=function isc_DynamicPropertyEditorItem_getFormula(_1,_2){var _3=_1.getBasicValueObject(),_4,_5;if(_3!=null){_4=_3.text;_5=_3[this.formulaVarsKey]}
if(_4!=null){var _6={text:_4};if(_5!=null)_6[_2]=_5;return _6}
return null});isc.B._maxIndex=isc.C+6;isc.defineClass("DataSourceNavigatorDS","DataSource");isc.A=isc.DataSourceNavigatorDS.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.clientOnly=true;isc.A.dataProtocol="clientCustom";isc.A.fields=[{name:"datasourceId",title:"ID",primaryKey:true},{name:"status",title:"Status",valueMap:["loaded","registered"],hidden:true},{name:"dataFormat",title:"Data Format",hidden:true},{name:"serverType",title:"Server Type",hidden:true},{name:"usesSCServerProtocol",title:"SC Protocol",type:"boolean",hidden:true},{name:"hasRestConstructor",title:"REST",type:"boolean",hidden:true},{name:"type",title:"Type",valueMap:{"sql":"SQLDataSource","hibernate":"HibernateDataSource","jpa":"JPA DataSource (2.0)","jpa1":"JPA DataSource (1.0)","json":"JSON DataSource","rest":"REST DataSource","wsdl":"WSDL DataSource","xml":"XML DataSource","dmi":"DMI DataSource","client":"Client Only","generic":"Custom Server DataSource"}}];isc.A.localDataCacheStatus=null;isc.A.remoteDataCacheStatus=null;isc.B.push(isc.A.inferTypeValue=function isc_DataSourceNavigatorDS_inferTypeValue(_1){if(_1.status==="registered"||!_1.usesSCServerProtocol){if(_1.clientOnly)_1.type="client";if(_1.hasRestConstructor)_1.type="rest";if(_1.serviceNamespace)_1.type="wsdl";if(_1.recordXPath&&!_1.dataFormat)_1.type="xml";if(_1.type&&_1.superClass){var _2=this.getField("type").valueMap;var _3=_2[_1.type]||_1.type;_1.type=_1.superClass+" ("+_3+")"}
var _4=_1.type||_1.serverType||_1.dataFormat||"generic";_1.type=_4}else{_1.type=_1.serverType}},isc.A.initCacheData=function isc_DataSourceNavigatorDS_initCacheData(_1,_2){var _3=this;var _4={execute:function(_21,_20){for(var i=0;i<_21.length;i++){var _6=_21[i];if(!_6){continue}
var _7=_6.dataFormat;var _8=_6.dataURL!=null;var _9=_6.operationBindings||[];for(var j=0;j<_9.length;j++){var _11=_9[j];if(!_7&&_11.dataFormat){_7=_11.dataFormat}
if(_11.dataURL){_8=true}}
var _12=null;if(_6.getSuperClass&&_6.getSuperClass().isA("DataSource")&&_6.getClassName()!="RestDataSource"){_12=_6.getClassName()}
if(_6.ID.startsWith("isc_")||!_6.serverType&&!_6.clientOnly&&!_8){continue}
var _13={datasourceId:_6.ID,status:"registered",serverType:_6.serverType,dataFormat:_7,usesSCServerProtocol:_6.serverType==="iscServer",hasRestConstructor:isc.isA.RestDataSource(_6),clientOnly:_6.clientOnly,superClass:_12}
_3.inferTypeValue(_13);var _14=_3.getCacheData();if(!_14){_14=[];_3.setCacheData(_14)}
var _15=_14.find("datasourceId",_13.datasourceId);if(_15){_14.remove(_15)}
_14.add(_13)};_3.localDataCacheStatus=_20}}
var _16={execute:function(_21,_20){for(var i=0;i<_21.length;i++){var _17=_21[i];var _13={datasourceId:_17.dsName,status:"loaded",serverType:_17.dsType,dataFormat:_17.dataFormat||"iscServer",usesSCServerProtocol:_17.usesSCServerProtocol,hasRestConstructor:_17.serverConstructor==="RestDataSource",clientOnly:false}
_3.inferTypeValue(_13);var _14=_3.getCacheData();if(!_14){_14=[];_3.setCacheData(_14)}
var _15=_14.find("datasourceId",_13.datasourceId);if(!_15){_14.add(_13)}};_3.remoteDataCacheStatus=_20}}
var _18=[{object:_4,method:"execute"}]
if(_2){_18.add({object:_16,method:"execute"})}
isc.Page.waitForMultiple(_18,function(){_1.execute()});if(!window.debugTarget){var _19=isc.DataSource.getRegisteredDataSourceObjects();_4.execute(_19,isc.RPCResponse.STATUS_SUCCESS)}else{window.debugTarget.call("isc.DataSource.getRegisteredDataSourceObjects",[],function(_19){_4.execute(_19,isc.RPCResponse.STATUS_SUCCESS)})}
if(_2){isc.DMI.call({appID:"isc_builtin",className:"com.isomorphic.tools.BuiltinRPC",methodName:"getDefinedDataSources",requestParams:{willHandleError:true,showPrompt:true},callback:function(_21,_22,_23){var _20=_21.status;if(_20===-1){isc.logWarn("Unable to obtain datasource listing from server: "+_22);_16.execute([],_20)}else{_16.execute(_22,_20)}}})}},isc.A.transformRequest=function isc_DataSourceNavigatorDS_transformRequest(_1){var _2=this;var _3={execute:function(){_2.prepareResponse(_1.unconvertedDSRequest||_1)}};var _4=_1.data,_5=_4&&_4.status&&_4.status!='registered';if(this.getCacheData()&&!this.getCacheData().isEmpty()){_3.execute()}else{isc.Page.waitFor(_3,"execute");this.initCacheData(_3,_5)}},isc.A.prepareResponse=function isc_DataSourceNavigatorDS_prepareResponse(_1){var _2=_1.data,_3={};_3.data=this.applyFilter(this.getCacheData(),_2,_1);this.processResponse(_1.requestId,_3)});isc.B._maxIndex=isc.C+4;isc.A=isc.DataSourceNavigatorDS;isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.B.push(isc.A.useDataSourceObject=function isc_c_DataSourceNavigatorDS_useDataSourceObject(_1,_2){var _3=function(){isc.DataSource.loadWithParents(_1,function(){_2(isc.DataSource.getDataSource(_1))})};var _4=isc.DataSource.getDataSource(_1);if(_4){_2(_4)}else if(!window.debugTarget){_3()}else{window.debugTarget.call("isc.DataSource.getDataSource",[_1],function(_6){if(_6){var _5=isc.DataSource.create(_6);_2(_5)}else{_3()}})}});isc.B._maxIndex=isc.C+1;isc.defineClass("DataSourceNavigator","Canvas");isc.A=isc.DataSourceNavigator.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.mode="devConsole";isc.A.enumerationDataSourceName="isc_datasources";isc.A.dashboardDataSourceName="isc_dashboards";isc.A.dsNavigatorWindowDefaults={_constructor:isc.Window,showMinimizeButton:false,visibility:"hidden",title:""};isc.A.dsNavigatorStackDefaults={_constructor:isc.SectionStack,width:"100%",height:"100%",visibilityMode:"multiple",sections:[{title:"DataSource List",expanded:true,items:["autoChild:dsEnumerationFilter","autoChild:dsEnumerationGrid"]},{title:"Dashboards",items:["autoChild:dsDashboard"]}],refreshButtonDefaults:{_constructor:isc.ToolStripButton,title:"Refresh",icon:"[SKINIMG]/actions/refresh.png",click:function(){var _1=this.creator.creator;_1.invalidateCache()}},initWidget:function(){this.Super("initWidget",arguments);var _1=this.createAutoChild("refreshButton");this.sections[0].controls=[_1]},relocateDashboard:function(){var _1=this.creator,_2=_1.dsDashboard,_3=_1.dsNavigatorStack,_4=_1.dsNavigatorWindow;var _5=_3.sections[1];_4.addItem(_2);_4.maximize();_4.show();var _6=function(){_3.addItem(_5,_2,0);_4.items=[];_5.ignore(_4,"close")}
_5.observe(_4,"close",_6)}};isc.A.dsEnumerationFilterDefaults={_constructor:isc.DynamicForm,colWidths:[100,"*"],fields:[{name:"radioGroup",title:"Show",type:"radioGroup",vertical:false,valueMap:{"registered":"DataSources in current application","":"All DataSources"},changed:function(_1,_2,_3){var _4=_1.creator,_5=_4.dsEnumerationGrid,_6=isc.DS.get(_4.enumerationDataSourceName);if(_3!="registered"&&_6.remoteDataCacheStatus!=isc.RPCResponse.STATUS_SUCCESS){_4.invalidateCache()}
var _7={status:_3};_5.fetchData(_7)}}],values:{radioGroup:"registered"}};isc.A.dsEnumerationGridDefaults={_constructor:isc.ListGrid,sortField:"datasourceId",showFilterEditor:true,autoFetchData:true,initialCriteria:{status:"registered"},recordClick:function(_1,_2,_3,_4,_5,_6,_7){var _8=_2.datasourceId;var _9=_1.creator;isc.DataSourceNavigatorDS.useDataSourceObject(_8,function(_10){_9.addSection(_10)})}};isc.A.dsDashboardDefaults={_constructor:"DSDashboard",paletteDataSourceNameField:"datasourceId",dashboardsProperties:{autoFitData:"vertical",autoFitMaxRecords:4},paletteProperties:{sortFieldNum:0,paletteNodeProperties:{deferCreation:true,loadData:function(_1,_2){var _3=this.defaults.dataSource;isc.DataSourceNavigatorDS.useDataSourceObject(_3,function(_4){_1.isLoaded=true;_2()})}}},initWidget:function(){this.Super("initWidget",arguments);var _1;this.palette.setDefaultEditContext(_1);this.editPane.setDefaultPalette(_1);var _2=this.creator.dsNavigatorStack;_2.observe(this.editButton,"click","observer.relocateDashboard()");_2.observe(this.viewButton,"click","observer.relocateDashboard()")}};isc.A.dsContentListGridDefaults={_constructor:isc.ListGrid,autoFetchData:true,showFilterEditor:true,canEdit:true,canMultiSort:true,canRemoveRecords:true,canAddFormulaColumns:true,canAddSummaryColumns:true};isc.A.dsContentToolstripDefaults={_constructor:isc.ToolStrip,exportButtonDefaults:{_constructor:isc.ToolStripButton,autoDraw:false,title:"Export",icon:"[SKINIMG]/actions/save.png",click:function(){var _1=this.creator.exportTypeForm;var _2=this.creator.dsContentListGrid;var _3=_1.getField("exportType").getValue();_2.exportClientData({exportAs:_3})}},refreshDefaults:{_constructor:isc.ToolStripButton,autoDraw:false,title:"Refresh",icon:"[SKINIMG]/actions/refresh.png",click:function(){var _1=this.creator.dsContentListGrid;_1.invalidateCache()}},addRecordDefaults:{_constructor:isc.ToolStripButton,autoDraw:false,title:"Add Record",icon:"[SKINIMG]/actions/add.png",click:function(){var _1=this.creator.dsContentListGrid;_1.startEditingNew()}},exportTypeFormDefaults:{_constructor:isc.DynamicForm,fields:[{name:"exportType",type:"select",width:"*",showTitle:false,defaultToFirstOption:true,valueMap:{"csv":"CSV","xml":"XML","xls":"XLS (Excel97)","ooxml":"OOXML (Excel2007)"}}]},initWidget:function(){this.Super("initWidget",arguments);this.addAutoChild("refresh");this.addMember("separator");this.addAutoChild("addRecord");this.addMember("separator");this.addAutoChild("exportButton");this.addAutoChild("exportTypeForm")}};isc.B.push(isc.A.removeSection=function isc_DataSourceNavigator_removeSection(_1){this.dsNavigatorStack.removeSection(_1)},isc.A.addSection=function isc_DataSourceNavigator_addSection(_1){var _2=this,_3="Section"+_1.ID;if(this.dsNavigatorStack.getSectionNumber(_3)>=0){this.dsNavigatorStack.expandSection([_3]);return}
var _4=isc.ImgButton.create({autoDraw:false,src:"[SKIN]actions/close.png",size:16,showFocused:false,showRollOver:false,showDown:false,click:function(){_2.dsNavigatorStack.removeSection(_3);_2.dsNavigatorStack.expandSection(0)}});var _5=this.createAutoChild("dsContentListGrid",{dataSource:_1});var _6=this.createAutoChild("dsContentToolstrip",{dsContentListGrid:_5});this.dsNavigatorStack.addSection({name:_3,title:_1.getPluralTitle(),expanded:true,controls:[_4],items:[_5,_6]},1)},isc.A.invalidateCache=function isc_DataSourceNavigator_invalidateCache(){var _1=this.dsEnumerationGrid,_2=_1.getDataSource();var _3=this.dsEnumerationFilter,_4=_3.getField('radioGroup');var _5=this.dsDashboard;var _6={execute:function(){if(_4.getValue()!="registered"&&_2.remoteDataCacheStatus!=isc.RPCResponse.STATUS_SUCCESS){_4.setValue("registered");isc.warn("To work with DataSources other than those currently registered by this page, please enable the getDefinedDataSources RPC DMI BuiltIn as described in the 'Tools Deployment' documentation topic.");return}
_1.invalidateCache();if(_5){_5.palette.initCacheData()}}};var _7=this.dsEnumerationFilter.values['radioGroup'];_2.initCacheData(_6,_7!='registered')},isc.A.fetchAllDataSources=function isc_DataSourceNavigator_fetchAllDataSources(){var _1=this.dsEnumerationFilter,_2=_1.getItem("radioGroup"),_3=this.dsEnumerationGrid,_4=_3.getDataSource(),_5=this.dsDashboard;_1.hide();_2.setValue("");_4.initCacheData({execute:function(){_3.fetchData({status:""});if(_5){_5.palette.initCacheData()}}},true)},isc.A.initWidget=function isc_DataSourceNavigator_initWidget(){var _1=isc.DS.get(this.enumerationDataSourceName);if(!_1){isc.DataSourceNavigatorDS.create({ID:this.enumerationDataSourceName})}
var _2=isc.DS.get(this.dashboardDataSourceName);if(!_2){isc.OfflineDataSource.create({ID:this.dashboardDataSourceName,fields:[{name:'id',type:"sequence",primaryKey:"true"},{name:'description',type:"text"},{name:'layout',type:"text"}]})}
this.dsEnumerationGridProperties={dataSource:this.enumerationDataSourceName}
if(this.mode=="adminConsole"){isc.addProperties(this.dsEnumerationGridProperties,{autoFetchData:false});this.showDsEnumerationFilter=false}
this.dsDashboardProperties={dataSource:this.dashboardDataSourceName,paletteDataSource:this.enumerationDataSourceName}
this.Super("initWidget",arguments);var _3=this.addAutoChild("dsNavigatorWindow");var _4=this.addAutoChild("dsNavigatorStack");if(this.mode=="adminConsole")this.fetchAllDataSources()});isc.B._maxIndex=isc.C+5;isc.defineClass("DSDashboard","HLayout");isc.A=isc.DSDashboard.getPrototype();isc.B=isc._allFuncs;isc.C=isc.B._maxIndex;isc.D=isc._funcClasses;isc.D[isc.C]=isc.A.Class;isc.A.membersMargin=20;isc.A.selectorDashboardsTabTitle="Dashboards";isc.A.selectorPaletteTabTitle="Palette";isc.A.newDashboardDescription="New Dashboard";isc.A.cloneDashboardDescriptionSuffix="Copy";isc.A.paletteDataSourceNameField="dsName";isc.A.dataSource="dashboards";isc.A.descriptionField="description";isc.A.layoutField="layout";isc.A.initialPortalPaletteNode={type:"PortalLayout",defaults:{width:"100%",height:"100%",canResizePortlets:true}};isc.A.dashboardsConstructor=isc.ListGrid;isc.A.dashboardsDefaults={autoParent:"dashboardsLayout",autoFetchData:true,selectionType:"single",canEdit:true,canRemoveRecords:true,initWidget:function(){this.sortField=this.dashboardDescriptionField;this.fields=[{name:this.dashboardDescriptionField}];this.Super("initWidget",arguments)},clearCurrentDashboard:function(){this.getEditPane().destroyAll();this.getEditPane().hide();this.getEditToolbar().hide()},editDashboard:function(){var _1=this.getSelectedRecord();if(_1){var _2=_1[this.dashboardLayoutField];this.getEditPane().addPaletteNodesFromXML(_2);this.getEditPane().show();this.getEditToolbar().show();this.showPalette()}
this.$60g=_1},viewDashboard:function(_1){var _2=this.getSelectedRecord();if(_2){var _1=_2[this.dashboardLayoutField];this.getEditPane().addPaletteNodesFromXML(_1);this.getEditPane().show();this.getEditToolbar().hide();this.hidePalette()}
this.$60g=_2},newDashboard:function(){this.clearCurrentDashboard();this.$60g=null;this.getEditPane().addFromPaletteNode(this.initialPortalPaletteNode);this.getEditPane().show();this.getEditToolbar().show();this.showPalette();this.saveDashboard()},cloneDashboard:function(_1){var _2=this.getSelectedRecord();if(_2){this.cloneRecord(_2)}},showPalette:function(){this.getSelector().enableTab(1);this.getSelector().selectTab(1)},hidePalette:function(){this.getSelector().disableTab(1);this.getSelector().selectTab(0)},refreshDashboard:function(){this.clearCurrentDashboard();this.editDashboard()},saveDashboard:function(){var _1=this.getEditPane().serializeAllEditNodes({indent:false});if(this.$60g){this.$60g[this.dashboardLayoutField]=_1;this.updateData(this.$60g)}else{var _2=this,_3={};_3[this.dashboardDescriptionField]=this.newDashboardDescription;_3[this.dashboardLayoutField]=_1;this.addData(_3,function(_4,_5,_6){if(_5&&!isc.isAn.Array(_5)){_5=[_5]}
if(_5&&_5.length>0){_2.selectSingleRecord(_5[0]);_2.$60g=_5[0]}})}},cloneRecord:function(_1,_2){if(!_2)_2=1;if(_2>100){return}
var _3=this,_4=this.getDataSource(),_5=_1[this.dashboardDescriptionField]+" "+this.cloneDashboardDescriptionSuffix+" "+_2,_6={};_6[this.dashboardDescriptionField]=_5;_4.fetchData(_6,function(_8,_9,_10){if(_9&&_9.length>0){this.cloneRecord(_1,_2);return}
var _7={};_7[_3.dashboardDescriptionField]=_5;_7[_3.dashboardLayoutField]=_1[_3.dashboardLayoutField];_3.addData(_7,function(_8,_9,_10){if(_9&&_9.length>0){_3.selectSingleRecord(_9[0])}})})},getEditPane:function(){return this.creator.editPane},getEditToolbar:function(){return this.creator.editToolbar},getSelector:function(){return this.creator.selector}};isc.A.viewButtonConstructor=isc.Button;isc.A.viewButtonDefaults={autoParent:"dashboardsToolbar",title:"View",autoFit:true,click:function(){this.creator.dashboards.clearCurrentDashboard();this.creator.dashboards.viewDashboard()}};isc.A.editButtonConstructor=isc.Button;isc.A.editButtonDefaults={autoParent:"dashboardsToolbar",title:"Edit",autoFit:true,click:function(){this.creator.dashboards.clearCurrentDashboard();this.creator.dashboards.editDashboard()}};isc.A.newButtonConstructor=isc.Button;isc.A.newButtonDefaults={autoParent:"dashboardsToolbar",title:"New",autoFit:true,click:function(){this.creator.dashboards.newDashboard()}};isc.A.cloneButtonConstructor=isc.Button;isc.A.cloneButtonDefaults={autoParent:"dashboardsToolbar",title:"Clone",autoFit:true,click:function(){this.creator.dashboards.cloneDashboard()}};isc.A.dashboardsToolbarConstructor=isc.HLayout;isc.A.dashboardsToolbarDefaults={autoParent:"dashboardsLayout",height:30,membersMargin:10,defaultLayoutAlign:"center",initWidget:function(){this.members=[isc.LayoutSpacer.create()];this.Super("initWidget",arguments)}};isc.A.dashboardsLayoutConstructor=isc.VLayout;isc.A.dashboardsLayoutDefaults={};isc.A.paletteConstructor=isc.ListPalette;isc.A.paletteDefaults={paletteNodeDefaults:{type:"ListGrid",defaults:{autoFetchData:true,showFilterEditor:true}},fields:[{name:"title",title:"Component"}],initWidget:function(){this.Super("initWidget",arguments);this.initCacheData()},initCacheData:function(){if(this.paletteDataSourceList){var _1=this.paletteDataSourceList;if(!isc.isAn.Array(_1))_1=[_1];var _2=[];for(var i=0;i<_1.length;i++){var _4=isc.clone(this.paletteNodeDefaults),_5=(isc.isAn.Instance(_1[i])?_1[i].getID():_1[i]),_6=isc.addProperties({},_4,this.paletteNodeProperties);;_6.title=_5;if(!_6.defaults)_6.defaults={};_6.defaults.dataSource=_5;_2.add(_6)}
this.setData(_2)}else if(this.paletteDataSource){var _7=this,_8=isc.DS.get(this.paletteDataSource);_8.fetchData(null,function(_11){var _9=_11.data;if(_9&&_9.length>0){var _2=[],_10=_7.paletteDataSourceNameField;for(var i=0;i<_9.length;i++){var _4=isc.clone(_7.paletteNodeDefaults),_5=_9[i][_10],_6=isc.addProperties({},_4,_7.paletteNodeProperties);;_6.title=_5;if(!_6.defaults)_6.defaults={};_6.defaults.dataSource=_5;_2.add(_6)}
_7.setData(_2)}else{_7.logWarn("No dataSources found in paletteDataSource "+_7.paletteDataSource)}})}}};isc.A.editPaneConstructor=isc.EditPane;isc.A.editPaneDefaults={autoParent:"editLayout",border:"1px solid black",visibility:"hidden",initWidget:function(){this.extraPalettes=isc.HiddenPalette.create({data:[{title:"ListGridField",type:"ListGridField"}]});this.Super("initWidget",arguments);this.addFromPaletteNode(this.creator.initialPortalPaletteNode)}};isc.A.saveButtonConstructor=isc.Button;isc.A.saveButtonDefaults={autoParent:"editToolbar",title:"Save",autoFit:true,click:function(){this.creator.dashboards.saveDashboard()}};isc.A.discardButtonConstructor=isc.Button;isc.A.discardButtonDefaults={autoParent:"editToolbar",title:"Discard changes",autoFit:true,click:function(){this.creator.dashboards.refreshDashboard()}};isc.A.editToolbarConstructor=isc.HLayout;isc.A.editToolbarDefaults={autoParent:"editLayout",height:30,membersMargin:10,defaultLayoutAlign:"center",visibility:"hidden",initWidget:function(){this.members=[isc.LayoutSpacer.create()];this.Super("initWidget",arguments)}};isc.A.editLayoutConstructor=isc.VLayout;isc.A.editLayoutDefaults={width:"100%",height:"100%"};isc.A.selectorConstructor=isc.TabSet;isc.A.selectorDefaults={width:"25%"};isc.B.push(isc.A.initWidget=function isc_DSDashboard_initWidget(){this.Super("initWidget",arguments);var _1=[{title:this.selectorDashboardsTabTitle,pane:this.addAutoChild("dashboardsLayout")},{title:this.selectorPaletteTabTitle,pane:this.addAutoChild("palette",{paletteDataSource:this.paletteDataSource,paletteDataSourceNameField:this.paletteDataSourceNameField,paletteDataSourceList:this.paletteDataSourceList})}];this.addAutoChild("selector",{tabs:_1});this.addAutoChild("dashboards",{initialPortalPaletteNode:this.initialPortalPaletteNode,newDashboardDescription:this.newDashboardDescription,cloneDashboardDescriptionSuffix:this.cloneDashboardDescriptionSuffix,dataSource:this.dataSource,dashboardDescriptionField:this.descriptionField,dashboardLayoutField:this.layoutField});this.addAutoChild("dashboardsToolbar");this.addAutoChild("viewButton");this.addAutoChild("editButton");this.addAutoChild("newButton");this.addAutoChild("cloneButton");this.addAutoChild("editLayout");this.addAutoChild("editPane");this.addAutoChild("editToolbar");this.addAutoChild("saveButton");this.addAutoChild("discardButton");this.palette.setDefaultEditContext(this.editPane);this.editPane.setDefaultPalette(this.palette)});isc.B._maxIndex=isc.C+1;isc._nonDebugModules=(isc._nonDebugModules!=null?isc._nonDebugModules:[]);isc._nonDebugModules.push('Tools');isc.checkForDebugAndNonDebugModules();isc._moduleEnd=isc._Tools_end=(isc.timestamp?isc.timestamp():new Date().getTime());if(isc.Log&&isc.Log.logIsInfoEnabled('loadTime'))isc.Log.logInfo('Tools module init time: '+(isc._moduleEnd-isc._moduleStart)+'ms','loadTime');delete isc.definingFramework;if(isc.Page)isc.Page.handleEvent(null,"moduleLoaded",{moduleName:'Tools',loadTime:(isc._moduleEnd-isc._moduleStart)});}else{if(window.isc&&isc.Log&&isc.Log.logWarn)isc.Log.logWarn("Duplicate load of module 'Tools'.");}
