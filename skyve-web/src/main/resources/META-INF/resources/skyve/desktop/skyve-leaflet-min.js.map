{
"version":3,
"file":"../skyve-web/src/main/resources/META-INF/resources/skyve/desktop/skyve-leaflet-min.js",
"lineCount":14,
"mappings":"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",
"sources":["src/js/desktop/skyve-leaflet.js"],
"sourcesContent":["/**\n * Implements the BizMap UI component for Leaflet.\n * Extends Canvas from the SmartClient library.\n */\nisc.ClassFactory.defineClass(\"BizMap\", \"Canvas\");\n\nisc.BizMap.addClassMethods({\n\tloadingLeaflet: false,\n\n\t/**\n\t * Loads Leaflet library and its dependencies asynchronously.\n\t * @param {Function} callback - the function to execute once Leaflet is loaded.\n\t */\n\tloadLeaflet: function (callback) {\n\t\tif (isc.BizMap.loadingLeaflet) {\n\t\t\tsetTimeout(() => isc.BizMap.loadLeaflet(callback), 100);\n\t\t} else if (window.L) {\n\t\t\tcallback();\n\t\t} else {\n\t\t\tisc.BizMap.loadingLeaflet = true;\n\t\t\tSKYVE.Util.loadCSS(`leaflet/leaflet.css?v=${SKYVE.Util.v}`, () => {\n\t\t\t\tSKYVE.Util.loadJS(`leaflet/leaflet.js?v=${SKYVE.Util.v}`, () => {\n\t\t\t\t\tSKYVE.Util.loadJS(`leaflet/Path.Drag.js?v=${SKYVE.Util.v}`, () => {\n\t\t\t\t\t\tSKYVE.Util.loadJS(`leaflet/Leaflet.Editable.js?v=${SKYVE.Util.v}`, () => {\n\t\t\t\t\t\t\tSKYVE.Util.loadCSS(\n\t\t\t\t\t\t\t\t`leaflet/leaflet.fullscreen.css?v=${SKYVE.Util.v}`,\n\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\tSKYVE.Util.loadJS(\n\t\t\t\t\t\t\t\t\t\t`leaflet/Leaflet.fullscreen.min.js?v=${SKYVE.Util.v}`,\n\t\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\t\tisc.BizMap.loadingLeaflet = false;\n\t\t\t\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\n\tv: 0,\n\n\t/**\n\t * Initialises the BizMap instance.\n\t */\n\tinitialise: function () {\n\t\teval(`${isc.BizMap.id}.build()`);\n\t},\n});\n\nisc.BizMap.addMethods({\n\t/**\n\t * Initialises the map with the given configuration.\n\t * @param {Object} config - configuration object for the map.\n\t */\n\tinit: function (config) {\n\t\tthis._refreshRequired = true;\n\t\tthis._refreshing = false;\n\t\tthis._zoomed = false;\n\t\tthis.width = \"100%\";\n\t\tthis.height = \"100%\";\n\t\tthis.styleName = \"googleMapDivParent\";\n\t\tthis.ID = `bizMap${isc.BizMap.v++}`;\n\t\tthis.redrawOnResize = false;\n\t\tthis.Super(\"init\", arguments);\n\t\tthis._objects = {};\n\t\tthis._intervalId = null;\n\t},\n\n\t/**\n\t * Returns the inner HTML for the map container.\n\t * @returns {string} - the HTML string for the map container.\n\t */\n\tgetInnerHTML: function () {\n\t\treturn `<div id=\"${this.ID}_map\" style=\"margin:0;padding:0;height:100%\">Loading Map...</div>`;\n\t},\n\n\t/**\n\t * Draws the map if Leaflet is loaded, otherwise loads Leaflet and then draws.\n\t */\n\tdraw: function () {\n\t\tif (window.L) {\n\t\t\tif (!this.isDrawn()) {\n\t\t\t\tthis.build();\n\t\t\t\treturn this.Super(\"draw\", arguments);\n\t\t\t}\n\t\t} else {\n\t\t\tisc.BizMap.id = this.ID;\n\t\t\tisc.BizMap.loadLeaflet(isc.BizMap.initialise);\n\t\t\treturn this.Super(\"draw\", arguments);\n\t\t}\n\t},\n\n\t/**\n\t * Sets the data source for the map.\n\t * @param {string} dataSourceID - the ID of the data source.\n\t */\n\tsetDataSource: function (dataSourceID) {\n\t\tif (window.L && this.webmap) {\n\t\t\tif (this._view) {\n\t\t\t\tthis._modelName = dataSourceID;\n\t\t\t\tthis._moduleName = null;\n\t\t\t\tthis._queryName = null;\n\t\t\t\tthis._geometryBinding = null;\n\n\t\t\t\tconst grids = this._view._grids[dataSourceID] || {};\n\t\t\t\tthis._view._grids[dataSourceID] = grids;\n\t\t\t\tgrids[this.getID()] = this;\n\t\t\t} else {\n\t\t\t\tconst underscoreIndex = dataSourceID.indexOf(\"_\");\n\t\t\t\tthis._moduleName = dataSourceID.substring(0, underscoreIndex);\n\t\t\t\tthis._queryName = dataSourceID.substring(underscoreIndex + 1);\n\t\t\t\tconst secondUnderscoreIndex = this._queryName.indexOf(\"_\");\n\t\t\t\tthis._geometryBinding = this._queryName.substring(\n\t\t\t\t\tsecondUnderscoreIndex + 1,\n\t\t\t\t);\n\t\t\t\tthis._queryName = this._queryName.substring(0, secondUnderscoreIndex);\n\t\t\t\tthis._modelName = null;\n\t\t\t}\n\t\t\tthis._refresh(true);\n\t\t} else {\n\t\t\tthis.delayCall(\"setDataSource\", arguments, 100);\n\t\t}\n\t},\n\n\t/**\n\t * Builds the map with the specified options.\n\t */\n\tbuild: function () {\n\t\tif (this.isDrawn()) {\n\t\t\tconst mapOptions = {\n\t\t\t\tzoom: 1,\n\t\t\t\tcenter: [0, 0],\n\t\t\t\tfullscreenControl: {\n\t\t\t\t\tpseudoFullscreen: false,\n\t\t\t\t},\n\t\t\t\tlayers: eval(SKYVE.Util.mapLayers),\n\t\t\t};\n\n\t\t\tif (this.webmap) {\n\t\t\t\tmapOptions.zoom = this.webmap.getZoom();\n\t\t\t\tmapOptions.center = this.webmap.getCenter();\n\t\t\t}\n\n\t\t\tthis._objects = {};\n\t\t\tconst element = document.getElementById(`${this.ID}_map`);\n\t\t\telement.innerHTML = \"\";\n\t\t\tthis.webmap = L.map(element, mapOptions);\n\n\t\t\tif (this.showRefresh) {\n\t\t\t\tSKYVE.Leaflet.refreshControls(this);\n\t\t\t}\n\n\t\t\tif (this.loading === \"lazy\") {\n\t\t\t\tthis.webmap.on(\"zoomend\", () => {\n\t\t\t\t\tif (!this._refreshing) {\n\t\t\t\t\t\tthis._refresh(false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.webmap.on(\"moveend\", () => {\n\t\t\t\t\tthis._refresh(false);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._refresh(true);\n\n\t\t\tif (this._intervalId) {\n\t\t\t\tclearInterval(this._intervalId);\n\t\t\t\tthis._intervalId = null;\n\t\t\t}\n\t\t\tif (this.refreshTime > 0 && this._refreshRequired) {\n\t\t\t\tthis._intervalId = setInterval(\n\t\t\t\t\tthis.rerender.bind(this),\n\t\t\t\t\tthis.refreshTime * 1000,\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.delayCall(\"build\", null, 100);\n\t\t\treturn;\n\t\t}\n\t},\n\n\t/**\n\t * Rerenders the map.\n\t */\n\trerender: function () {\n\t\tthis._refresh(false);\n\t},\n\n\t/**\n\t * Resumes the map from a paused state.\n\t */\n\tresume: function () {\n\t\tthis._zoomed = false;\n\t},\n\n\t/**\n\t * Refreshes the map data.\n\t * @param {boolean} fit - whether to fit the map to the bounds.\n\t */\n\t_refresh: function (fit) {\n\t\tif (\n\t\t\tthis._zoomed || // Operator is zoomed in\n\t\t\tthis._refreshing || // Already triggered a refresh\n\t\t\t!this.isDrawn() || // Widget is not drawn\n\t\t\t!this.isVisible() // Widget is not visible (from condition in UI or UI not displayed atm)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet url = `${SKYVE.Util.CONTEXT_URL}map?`;\n\t\tif (this._view) {\n\t\t\tif (this._modelName) {\n\t\t\t\tconst instance = this._view.gather(false);\n\t\t\t\turl += `_c=${instance._c}&_m=${this._modelName}`;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else if (this._queryName) {\n\t\t\turl += `_mod=${this._moduleName}&_q=${this._queryName}&_geo=${this._geometryBinding}`;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._refreshing = true;\n\n\t\tlet extents = \"\";\n\t\tif (this.loading === \"lazy\" && this.webmap) {\n\t\t\tconst bounds = this.webmap.wrapLatLngBounds(this.webmap.getBounds());\n\t\t\tif (bounds) {\n\t\t\t\tconst ne = bounds.getNorthEast();\n\t\t\t\tconst sw = bounds.getSouthWest();\n\t\t\t\textents = `&_ne=POINT(${ne.lng} ${ne.lat})&_sw=POINT(${sw.lng} ${sw.lat})`;\n\t\t\t}\n\t\t}\n\n\t\tisc.RPCManager.sendRequest({\n\t\t\tshowPrompt: true,\n\t\t\tevalResult: true,\n\t\t\tactionURL: url + extents,\n\t\t\thttpMethod: \"GET\",\n\t\t\tcallback: (rpcResponse, data, rpcRequest) => {\n\t\t\t\ttry {\n\t\t\t\t\tSKYVE.Leaflet.scatter(this, data, fit, true);\n\t\t\t\t} finally {\n\t\t\t\t\tthis._refreshing = false;\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t},\n\n\t/**\n\t * Handles click events on map layers.\n\t * @param {Object} layer - the layer that was clicked.\n\t * @returns {string} - the HTML string for the popup content.\n\t */\n\tclick: function (layer) {\n\t\tif (layer.zoomData) {\n\t\t\tthis._selectedLayer = layer;\n\t\t\treturn `${layer.zoomData.infoMarkup}<br/><br/><input type=\"button\" value=\"Zoom\" onclick=\"${this.ID}.zoom()\"/>`;\n\t\t}\n\t\treturn \"\";\n\t},\n\n\t/**\n\t * Zooms the map to the selected layer.\n\t */\n\tzoom: function () {\n\t\tthis._zoomed = true; // Indicate that we don't want refreshes\n\n\t\tconst pageRect = this.getPageRect();\n\t\tlet topLeft = null;\n\t\tlet bottomRight = null;\n\n\t\tif (this._selectedLayer.getBounds) {\n\t\t\t// Polylines, polygons\n\t\t\tconst bounds = this._selectedLayer.getBounds();\n\t\t\tconst nw = bounds.getNorthWest();\n\t\t\tconst se = bounds.getSouthEast();\n\t\t\ttopLeft = this.webmap.latLngToContainerPoint(nw);\n\t\t\tbottomRight = this.webmap.latLngToContainerPoint(se);\n\t\t} else {\n\t\t\t// Markers\n\t\t\tconst coordinates = this._selectedLayer.feature.geometry.coordinates;\n\t\t\tconst point = this.webmap.latLngToContainerPoint(\n\t\t\t\tL.latLng(coordinates[1], coordinates[0]),\n\t\t\t);\n\t\t\ttopLeft = L.point(point.x - 10, point.y - 10);\n\t\t\tbottomRight = L.point(point.x + 10, point.y + 10);\n\t\t}\n\n\t\tisc.BizUtil.getEditView(\n\t\t\tthis._selectedLayer.zoomData.mod,\n\t\t\tthis._selectedLayer.zoomData.doc,\n\t\t\t(view) => {\n\t\t\t\tisc.WindowStack.popup(\n\t\t\t\t\t[\n\t\t\t\t\t\tpageRect[0] + Math.max(topLeft.x, 0),\n\t\t\t\t\t\tpageRect[1] + Math.max(topLeft.y, 0),\n\t\t\t\t\t\tMath.min(bottomRight.x - topLeft.x, bottomRight.x, pageRect[2]),\n\t\t\t\t\t\tMath.min(bottomRight.y - topLeft.y, bottomRight.y, pageRect[3]),\n\t\t\t\t\t],\n\t\t\t\t\t\"Edit\",\n\t\t\t\t\ttrue,\n\t\t\t\t\t[view],\n\t\t\t\t);\n\t\t\t\tview.editInstance(this._selectedLayer.zoomData.bizId, null, null);\n\t\t\t\tthis._selectedLayer.closePopup();\n\t\t\t\tthis._selectedLayer = null;\n\t\t\t},\n\t\t);\n\t},\n});\n\n/**\n * Implements the BizMapPicker UI component.\n * Extends HTMLFlow from the SmartClient library.\n */\nisc.ClassFactory.defineClass(\"BizMapPicker\", \"HTMLFlow\");\n\nisc.BizMapPicker.addClassMethods({\n\tv: 0,\n\n\t/**\n\t * Initialises the BizMapPicker instance.\n\t */\n\tinitialise: function () {\n\t\teval(`${isc.BizMapPicker.id}.build()`);\n\t},\n});\n\nisc.BizMapPicker.addMethods({\n\t/**\n\t * Initialises the map picker with the given configuration.\n\t * @param {Object} config - configuration object for the map picker.\n\t */\n\tinit: function (config) {\n\t\tthis.width = \"100%\";\n\t\tthis.height = \"100%\";\n\t\tthis.styleName = \"googleMapDivParent\";\n\t\tthis.ID = `bizMapPicker${isc.BizMapPicker.v++}`;\n\t\tthis.contents = `<div id=\"${this.ID}_map\" style=\"margin:0;padding:0;height:100%\">Loading Map...</div>`;\n\t\tthis.Super(\"init\", arguments);\n\t\tthis._overlays = [];\n\t\tthis.field = config.field;\n\t\tthis.drawingTools = config.drawingTools;\n\n\t\tif (window.L) {\n\t\t\tthis.build();\n\t\t} else {\n\t\t\tisc.BizMapPicker.id = this.ID;\n\t\t\tisc.BizMap.loadLeaflet(isc.BizMapPicker.initialise);\n\t\t}\n\t},\n\n\t/**\n\t * Sets the disabled state of the map picker.\n\t * @param {boolean} disabled - whether the map picker should be disabled.\n\t */\n\tsetDisabled: function (disabled) {\n\t\tSKYVE.Leaflet.setDisabled(this, disabled);\n\t},\n\n\t/**\n\t * Maps the current field value.\n\t */\n\tmapIt: function () {\n\t\tconst value = this.field.getValue();\n\t\tSKYVE.Leaflet.scatterValue(this, value);\n\t},\n\n\t/**\n\t * Sets the field value from the map picker.\n\t * @param {string} wktValue - the WKT value to set.\n\t */\n\tsetFieldValue: function (wktValue) {\n\t\tthis.field.setValueFromPicker(wktValue);\n\t},\n\n\t/**\n\t * Builds the map picker.\n\t */\n\tbuild: function () {\n\t\tif (this.isDrawn()) {\n\t\t\tif (!this.webmap) {\n\t\t\t\tconst mapOptions = {\n\t\t\t\t\tzoom: SKYVE.Util.mapZoom,\n\t\t\t\t\tcenter: SKYVE.Leaflet.centre(),\n\t\t\t\t\teditable: true,\n\t\t\t\t\tfullscreenControl: {\n\t\t\t\t\t\tpseudoFullscreen: false,\n\t\t\t\t\t},\n\t\t\t\t\tlayers: eval(SKYVE.Util.mapLayers),\n\t\t\t\t};\n\t\t\t\tconst element = document.getElementById(`${this.ID}_map`);\n\t\t\t\telement.innerHTML = \"\";\n\t\t\t\tthis.webmap = L.map(element, mapOptions);\n\n\t\t\t\tSKYVE.Leaflet.drawingTools(this);\n\t\t\t\tSKYVE.Leaflet.geoLocator(this);\n\t\t\t\tSKYVE.Leaflet.setDisabled(this, this.field.isDisabled());\n\t\t\t}\n\t\t\tSKYVE.Leaflet.clear(this);\n\t\t\tthis.mapIt();\n\t\t} else {\n\t\t\tthis.delayCall(\"build\", null, 100);\n\t\t\treturn;\n\t\t}\n\t},\n});\n"],
"names":["isc","ClassFactory","defineClass","BizMap","addClassMethods","loadingLeaflet","loadLeaflet","callback","setTimeout","window","L","SKYVE","Util","loadCSS","v","loadJS","initialise","eval","id","addMethods","init","config","_refreshRequired","_zoomed","_refreshing","height","width","styleName","ID","redrawOnResize","Super","arguments","_objects","_intervalId","getInnerHTML","draw","isDrawn","build","setDataSource","dataSourceID","webmap","_view","_modelName","_geometryBinding","_queryName","_moduleName","grids","_grids","getID","underscoreIndex","indexOf","substring","secondUnderscoreIndex","_refresh","delayCall","mapOptions","zoom","center","fullscreenControl","pseudoFullscreen","layers","mapLayers","getZoom","getCenter","element","document","getElementById","innerHTML","map","showRefresh","Leaflet","refreshControls","loading","on","clearInterval","refreshTime","setInterval","rerender","bind","resume","fit","isVisible","url","CONTEXT_URL","instance","gather","_c","extents","bounds","wrapLatLngBounds","getBounds","ne","getNorthEast","sw","getSouthWest","lng","lat","RPCManager","sendRequest","showPrompt","evalResult","actionURL","httpMethod","rpcResponse","data","rpcRequest","scatter","click","layer","zoomData","_selectedLayer","infoMarkup","pageRect","getPageRect","topLeft","bottomRight","nw","getNorthWest","se","getSouthEast","latLngToContainerPoint","coordinates","feature","geometry","point","latLng","x","y","BizUtil","getEditView","mod","doc","view","WindowStack","popup","Math","max","min","editInstance","bizId","closePopup","BizMapPicker","contents","_overlays","field","drawingTools","setDisabled","disabled","mapIt","value","getValue","scatterValue","setFieldValue","wktValue","setValueFromPicker","mapZoom","centre","editable","geoLocator","isDisabled","clear"]
}
